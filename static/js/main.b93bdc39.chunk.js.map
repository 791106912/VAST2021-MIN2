{"version":3,"sources":["data/consumer_data.js","data/buliding_coordinate.js","utils/index.js","components/consumerGraph/index.jsx","components/carTrack/index.jsx","dataCal/index.jsx","secondQ/index.jsx","App.jsx","reportWebVitals.js","index.js"],"names":["timeArr","dayStr","storeClassify","type","data","storeMapType","chain","map","flatten","reduce","obj","d","find","d1","includes","value","timeClassifyData","name","ccLoyMap","carAssign","storeButtonArr","s","e","building_coordinate","desc","range","classify","pushOrPop","arr","mode","newArr","filter","push","add","a","b","parseFloat","Number","toFixed","calHourTime","hour","hourStr","toString","match","length","moment","unix","calcualteTypeColor","id","domain","colorScale","scaleOrdinal","sort","ascending","schemeCategory10","findLocaiton","coor","long","lat","sp","ep","ConsumerGraph","containerRef","useRef","useState","width","height","size","setsize","useMemo","radiusArr","maxSize","Math","min","minR","max","item","useEffect","current","clientWidth","clientHeight","showTrack","setshowTrack","selectMode","setselectMode","mergefun","setMergeFun","anagleScale","scaleLinear","dayScale","extent","timeScale","PI","consumePath","arc","innerRadius","day","outerRadius","startAngle","time","endAngle","originCCdata","setOriginCCdata","activeStore","setActiveStore","activeClassify","setActiveClassify","activeCustom","setActiveCustom","consumeData","location","ccNumData","setccNumData","json","then","res","newConsumeData","timestamp","split","locationType","loyaltynum","newLoy","uniq","nodeData","Object","keys","sortBy","arcData","price","values","linksObj","forEach","key1","d2","key2","source","target","calData","nodes","links","drawForce","radius","force","forceSimulation","forceLink","strength","forceManyBody","forceCollide","node","i","x1","y1","x2","y2","sqrt","pow","distance","x","y","theta","atan","cos","sin","selectAll","each","select","this","attr","thisData","call","drag","on","alpha","restart","fx","fy","event","remove","link","enter","append","exitCCArr","priceOpacity","extents","locationPriceObj","num","locationOpacity","storePath","inner","outer","padAngle","cornerRadius","timePath","middleArcLine","angles","r1","middleAngle","invertDirection","reverse","pathFun","path","pointObj","key","centroid","activeTimeData","replace","trackPath","line","curve","curveCatmullRom","weekDay","className","ref","transform","text","format","textOpactiy","opacity","cx","cy","r","dy","textPathHrefProps","fill","textPathProps","href","startOffset","dominantBaseline","storeType","fillOpacity","JSON","stringify","entries","storeName","gap","stroke","textAnchor","middle","isBottom","onClick","newActiveStore","newType","join","thisConsumeData","total","t","thisAngleScale","thisArcFun","index","findIndex","startValue","slice","endValue","newActiveClassisy","htmlFor","checked","onChange","originColor","bgColor","color","style","backgroundColor","borderColor","timeRange","CarTrack","svgRef","scaleTime","Date","timeScaleObj","scale","stopArr","setstopArr","stopLocation","dataArr","getTime","st","et","count","calCarColor","carTrack","useData","car","track","stopItem","sourceRange","targetRange","console","log","pathWidthScale","heightScale","drawParall","gps","unknowCount","useStopArr","parseInt","calcualteTimeRange","dataItem","maxValue","countBy","maxBy","graphHeight","forIn","val","countObj","countData","orderBy","sum","sumBy","topItem","valuePrv","store","idArr","scaleBand","axisBottom","axisTop","createLine","curveStep","background","lineAttr","carColor","storeKey","circleAttr","onMouseEnter","sourceY","sourceScale","targetScale","bandwidth","targetY","sourStop","sourceX","targetX","pathArr","pathAttr","strokeWidth","strokeOpacity","sx","ex","rectAttr","calcualteStoreColor","gAttr","fontSize","dx","Cal","SecondQ","mapRef","trackRef","setmap","allTrack","setAllTrack","projection","geoEquirectangular","selectCar","setSelectCard","selectDay","setSelectDay","selectHour","setSelectHour","carArr","info","CarID","FirstName","LastName","CurrentEmploymentType","title","CurrentEmploymentTitle","fitSize","window","features","brushRef","brush","selection","invert","parse","thisTime","stopCircleRScale","display","content","tooltip","src","alt","geoPath","geoArr","Timestamp","attr2","strokeDasharray","keyItem","cpname","onMouseOut","textAttr","fontWeight","TextEvent","newSelectCar","SplitTrack","GasData","selectDayCB","brushCB","hourArr","playCB","getTotalLength","transition","ease","easeLinear","duration","realHeight","realWidth","topRef","bottomRef","xScale","topAxis","bottomAxis","brushX","axisPosScale","scalePoint","align","gpsArr","cloneDeep","trackItem","stopDot","step","xItem","delay","carItem","dayitem","dayName","moveTo","lineTo","rx","ry","Content","children","App","to","from","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"0YAEaA,EAAU,CACnB,WACE,UACA,WACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,WACA,UACA,WACA,YAGOC,EAAS,CAClB,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,cAiESC,EAAgB,CACzB,CACIC,KAAM,WACNC,KAAM,CACF,sBACA,mBACA,kBACA,eACA,uBACA,uBACA,sBAGR,CACID,KAAM,aACNC,KAAM,CACF,gBACA,eACA,eACA,kBACA,cACA,gBACA,gBAGR,CACID,KAAM,WACNC,KAAM,CACF,gBACA,sBACA,yBACA,wBACA,kBACA,4BACA,gBACA,6BACA,iCAGR,CACID,KAAM,cACNC,KAAM,CACF,eACA,WAGR,CACID,KAAM,SACNC,KAAM,CACF,yBACA,cACA,cACA,oBACA,4BACA,mBAGR,CACID,KAAM,gBACNC,KAAM,CACF,sBACA,mBACA,mBAKCC,EAAeC,gBAAMJ,GAC7BK,IAAI,QACJC,UACAC,QAAO,SAACC,EAAKC,GAEV,OADAD,EAAIC,GAAKT,EAAcU,MAAK,SAAAC,GAAE,OAAIA,EAAGT,KAAKU,SAASH,MAAIR,KAChDO,IACR,IACFK,QAEQC,EAAmB,CAC5B,CACIZ,KAAM,EAAE,EAAG,GACXa,KAAM,YAEV,CACIb,KAAM,CAAC,EAAG,GACVa,KAAM,sBAEV,CACIb,KAAM,CAAC,EAAG,IACVa,KAAM,WAEV,CACIb,KAAM,CAAC,GAAI,IACXa,KAAM,eAEV,CACIb,KAAM,CAAC,GAAI,IACXa,KAAM,WAEV,CACIb,KAAM,CAAC,GAAI,IACXa,KAAM,eAKDC,EAAW,CACpB,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,OACT,MAAS,O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","file":"static/js/main.b93bdc39.chunk.js","sourcesContent":["import { chain } from \"lodash\"\n\nexport const timeArr = [\n    1388937600\n    , 1389024000\n    , 1389110400\n    , 1389196800\n    , 1389283200\n    , 1389369600\n    , 1389456000\n    , 1389542400\n    , 1389628800\n    , 1389715200\n    , 1389801600\n    , 1389888000\n    , 1389974400\n    , 1390060800\n]\n\nexport const dayStr = [\n    '01/06/2014',\n    '01/07/2014',\n    '01/08/2014',\n    '01/09/2014',\n    '01/10/2014',\n    '01/11/2014',\n    '01/12/2014',\n    '01/13/2014',\n    '01/14/2014',\n    '01/15/2014',\n    '01/16/2014',\n    '01/17/2014',\n    '01/18/2014',\n    '01/19/2014',\n]\n\nexport const storeClassify1 = [\n    {\n        type: 'restaurant',\n        data: [\n            \"Brew've Been Served\",\n            'Hallowed Grounds',\n            'Coffee Cameleon',\n            'Coffee Shack',\n            'Bean There Done That',\n            \"Jack's Magical Beans\",\n            'Brewed Awakenings',\n            'Katerinas Caf',\n            'Gelatogalore',\n            'Ouzeri Elian',\n            'Kalami Kafenion',\n            'Hippokampos',\n            'Abila Zacharo',\n            \"Guy's Gyros\",\n        ],\n    },\n    {\n        type: 'parnter',\n        data: [\n            'Abila Airport',\n            'Nationwide Refinery',\n            'Maximum Iron and Steel',\n            'Carlyle Chemical Inc.',\n            'Abila Scrapyard',\n            \"Octavio's Office Supplies\",\n            'Chostus Hotel',\n            \"Frank's Fuel\",\n            'Kronos Pipe and Irrigation',\n            'Stewart and Sons Fabrication',\n        ],\n    },\n    {\n        type: 'shop',\n        data: [\n            \"Albert's Fine Clothing\",\n            'Kronos Mart',\n            'Daily Dealz',\n            \"Shoppers' Delight\",\n            'Ahaggo Museum',\n        ],\n    },\n    {\n        type: 'entertainment',\n        data: [\n            \"Desafio Golf Course\",\n            'Roberts and Sons',\n        ],\n    },\n    {\n        type: 'other',\n        data: [\n            'U-Pump',\n            'General Grocer',\n            \"Frydos Autosupply n' More\",\n        ]\n    }\n]\n\nexport const storeClassify = [\n    {\n        type: 'FastFood',\n        data: [\n            \"Brew've Been Served\",\n            'Hallowed Grounds',\n            'Coffee Cameleon',\n            'Coffee Shack',\n            'Bean There Done That',\n            \"Jack's Magical Beans\",\n            'Brewed Awakenings',\n        ],\n    },\n    {\n        type: 'Restaurant',\n        data: [\n            'Katerinas Caf',\n            'Gelatogalore',\n            'Ouzeri Elian',\n            'Kalami Kafenion',\n            'Hippokampos',\n            'Abila Zacharo',\n            \"Guy's Gyros\",\n        ],\n    },\n    {\n        type: 'Industry',\n        data: [\n            'Abila Airport',\n            'Nationwide Refinery',\n            'Maximum Iron and Steel',\n            'Carlyle Chemical Inc.',\n            'Abila Scrapyard',\n            \"Octavio's Office Supplies\",\n            'Chostus Hotel',\n            'Kronos Pipe and Irrigation',\n            'Stewart and Sons Fabrication',\n        ],\n    },\n    {\n        type: 'Gas Station',\n        data: [\n            \"Frank's Fuel\",\n            'U-Pump',\n        ],\n    },\n    {\n        type: 'Living',\n        data: [\n            \"Albert's Fine Clothing\",\n            'Kronos Mart',\n            'Daily Dealz',\n            \"Shoppers' Delight\",\n            \"Frydos Autosupply n' More\",\n            'General Grocer',\n        ],\n    },\n    {\n        type: 'Entertainment',\n        data: [\n            \"Desafio Golf Course\",\n            'Roberts and Sons',\n            'Ahaggo Museum',\n        ],\n    },\n]\n\nexport const storeMapType = chain(storeClassify)\n    .map('data')\n    .flatten()\n    .reduce((obj, d) => {\n        obj[d] = storeClassify.find(d1 => d1.data.includes(d)).type\n        return obj\n    }, {})\n    .value()\n\nexport const timeClassifyData = [\n    {\n        data: [-2, 6],\n        name: 'Sleeping',\n    },\n    {\n        data: [6, 9],\n        name: 'On the way to work',\n    },\n    {\n        data: [9, 12],\n        name: 'Working',\n    },\n    {\n        data: [12, 14],\n        name: 'Lunch Break',\n    },\n    {\n        data: [14, 18],\n        name: 'Working',\n    },\n    {\n        data: [18, 22],\n        name: 'After work',\n    }\n]\n\n// 54个Loy, 55 个 cc\nexport const ccLoyMap = {\n    \"L8328\": \"8129\", // true\n    \"L6417\": \"7117\", // true\n    \"L1107\": \"2681\", // true\n    \"L4034\": \"5407\", // true\n    \"L6110\": \"8411\", // true\n    \"L2343\": \"8202\", // true\n    \"L9018\": \"2418\", // true\n    \"L5777\": \"9551\", // true\n    \"L7783\": \"1415\", // true\n    \"L3191\": \"9635\", // true\n    \"L4164\": \"7688\", // true\n    \"L1682\": \"7253\", // true\n    \"L1485\": \"3853\", // true\n    \"L5947\": \"2540\", // true\n    \"L3014\": \"1877\", // true\n    \"L4149\": \"1321\", // true\n    \"L6544\": \"7108\",// true\n    \"L4424\": \"1874\", // true\n    \"L5259\": \"7819\", // true\n    \"L3800\": \"7384\", // true\n    \"L5553\": \"9617\", // true\n    \"L3366\": \"6895\", // true\n    \"L8148\": \"6816\",// true\n    \"L4063\": \"9220\", // true\n    \"L2490\": \"3484\", // true\n    \"L2769\": \"8642\", // true\n    \"L2169\": \"4434\", // true\n    \"L9633\": \"9735\", // true\n    \"L9637\": \"2142\", // true\n    \"L8012\": \"1310\", // true\n    \"L7814\": \"3492\", // true\n    \"L3259\": \"9405\", // true\n    \"L9363\": \"6901\", // true\n    \"L5224\": \"8156\", // true\n    \"L7291\": \"9683\", // true\n    \"L9254\": \"7354\", // true\n    \"L6886\": \"2463\", // true\n    \"L7761\": \"3506\", // true\n    \"L5756\": \"7792\", // true\n    \"L8477\": \"4530\", // true\n    \"L3317\": \"2276\", // true\n    \"L5485\": \"9152\", // true\n    \"L5924\": \"9614\", // true\n    \"L2459\": \"5010\", // true\n    \"L2247\": \"5368\", //true\n    \"L9406\": \"4948\", // true\n    \"L9362\": \"3547\", // true L9362 和 L3295 是一个人的\n    \"L3295\": \"5921\", // true\n    \"L6267\": [\"6691\", \"6899\"], // true L6227在不同的时间段分属于不同的人，这其实不是一个人的,可能存在盗刷\n    \"L6119\": \"7889\", // true\n    \"L2070\": \"8332\", // true\n    \"L8566\": \"4795\", // true\n    \"L3572\": \"1286\", // true // L3572 和 L3288有关系\n    \"L3288\": \"9241\", // true\n}\n\nexport const carAssign = [\n    {\n        \"LastName\": \"Calixto\",\n        \"FirstName\": \"Nils\",\n        \"CarID\": \"1\",\n        \"CurrentEmploymentType\": \"Information Technology\",\n        \"CurrentEmploymentTitle\": \"IT Helpdesk\"\n    },\n    {\n        \"LastName\": \"Azada\",\n        \"FirstName\": \"Lars\",\n        \"CarID\": \"2\", \"CurrentEmploymentType\": \"Engineering\", \"CurrentEmploymentTitle\": \"Engineer\"\n    }, { \"LastName\": \"Balas\", \"FirstName\": \"Felix\", \"CarID\": \"3\", \"CurrentEmploymentType\": \"Engineering\", \"CurrentEmploymentTitle\": \"Engineer\" }, { \"LastName\": \"Barranco\", \"FirstName\": \"Ingrid\", \"CarID\": \"4\", \"CurrentEmploymentType\": \"Executive\", \"CurrentEmploymentTitle\": \"SVP/CFO\" }, { \"LastName\": \"Baza\", \"FirstName\": \"Isak\", \"CarID\": \"5\", \"CurrentEmploymentType\": \"Information Technology\", \"CurrentEmploymentTitle\": \"IT Technician\" }, { \"LastName\": \"Bergen\", \"FirstName\": \"Linnea\", \"CarID\": \"6\", \"CurrentEmploymentType\": \"Information Technology\", \"CurrentEmploymentTitle\": \"IT Group Manager\" }, { \"LastName\": \"Orilla\", \"FirstName\": \"Elsa\", \"CarID\": \"7\", \"CurrentEmploymentType\": \"Engineering\", \"CurrentEmploymentTitle\": \"Drill Technician\" }, { \"LastName\": \"Alcazar\", \"FirstName\": \"Lucas\", \"CarID\": \"8\", \"CurrentEmploymentType\": \"Information Technology\", \"CurrentEmploymentTitle\": \"IT Technician\" }, { \"LastName\": \"Cazar\", \"FirstName\": \"Gustav\", \"CarID\": \"9\", \"CurrentEmploymentType\": \"Engineering\", \"CurrentEmploymentTitle\": \"Drill Technician\" }, { \"LastName\": \"Campo-Corrente\", \"FirstName\": \"Ada\", \"CarID\": \"10\", \"CurrentEmploymentType\": \"Executive\", \"CurrentEmploymentTitle\": \"SVP/CIO\" }, { \"LastName\": \"Calzas\", \"FirstName\": \"Axel\", \"CarID\": \"11\", \"CurrentEmploymentType\": \"Engineering\", \"CurrentEmploymentTitle\": \"Hydraulic Technician\" }, { \"LastName\": \"Cocinaro\", \"FirstName\": \"Hideki\", \"CarID\": \"12\", \"CurrentEmploymentType\": \"Security\", \"CurrentEmploymentTitle\": \"Site Control\" }, { \"LastName\": \"Ferro\", \"FirstName\": \"Inga\", \"CarID\": \"13\", \"CurrentEmploymentType\": \"Security\", \"CurrentEmploymentTitle\": \"Site Control\" }, { \"LastName\": \"Dedos\", \"FirstName\": \"Lidelse\", \"CarID\": \"14\", \"CurrentEmploymentType\": \"Engineering\", \"CurrentEmploymentTitle\": \"Engineering Group Manager\" }, { \"LastName\": \"Bodrogi\", \"FirstName\": \"Loreto\", \"CarID\": \"15\", \"CurrentEmploymentType\": \"Security\", \"CurrentEmploymentTitle\": \"Site Control\" }, { \"LastName\": \"Vann\", \"FirstName\": \"Isia\", \"CarID\": \"16\", \"CurrentEmploymentType\": \"Security\", \"CurrentEmploymentTitle\": \"Perimeter Control\" }, { \"LastName\": \"Flecha\", \"FirstName\": \"Sven\", \"CarID\": \"17\", \"CurrentEmploymentType\": \"Information Technology\", \"CurrentEmploymentTitle\": \"IT Technician\" }, { \"LastName\": \"Frente\", \"FirstName\": \"Birgitta\", \"CarID\": \"18\", \"CurrentEmploymentType\": \"Engineering\", \"CurrentEmploymentTitle\": \"Geologist\" }, { \"LastName\": \"Frente\", \"FirstName\": \"Vira\", \"CarID\": \"19\", \"CurrentEmploymentType\": \"Engineering\", \"CurrentEmploymentTitle\": \"Hydraulic Technician\" }, { \"LastName\": \"Fusil\", \"FirstName\": \"Stenig\", \"CarID\": \"20\", \"CurrentEmploymentType\": \"Security\", \"CurrentEmploymentTitle\": \"Building Control\" }, { \"LastName\": \"Osvaldo\", \"FirstName\": \"Hennie\", \"CarID\": \"21\", \"CurrentEmploymentType\": \"Security\", \"CurrentEmploymentTitle\": \"Perimeter Control\" }, { \"LastName\": \"Nubarron\", \"FirstName\": \"Adra\", \"CarID\": \"22\", \"CurrentEmploymentType\": \"Security\", \"CurrentEmploymentTitle\": \"Badging Office\" }, { \"LastName\": \"Lagos\", \"FirstName\": \"Varja\", \"CarID\": \"23\", \"CurrentEmploymentType\": \"Security\", \"CurrentEmploymentTitle\": \"Badging Office\" }, { \"LastName\": \"Mies\", \"FirstName\": \"Minke\", \"CarID\": \"24\", \"CurrentEmploymentType\": \"Security\", \"CurrentEmploymentTitle\": \"Perimeter Control\" }, { \"LastName\": \"Herrero\", \"FirstName\": \"Kanon\", \"CarID\": \"25\", \"CurrentEmploymentType\": \"Engineering\", \"CurrentEmploymentTitle\": \"Geologist\" }, { \"LastName\": \"Onda\", \"FirstName\": \"Marin\", \"CarID\": \"26\", \"CurrentEmploymentType\": \"Engineering\", \"CurrentEmploymentTitle\": \"Drill Site Manager\" }, { \"LastName\": \"Orilla\", \"FirstName\": \"Kare\", \"CarID\": \"27\", \"CurrentEmploymentType\": \"Engineering\", \"CurrentEmploymentTitle\": \"Drill Technician\" }, { \"LastName\": \"Borrasca\", \"FirstName\": \"Isande\", \"CarID\": \"28\", \"CurrentEmploymentType\": \"Engineering\", \"CurrentEmploymentTitle\": \"Drill Technician\" }, { \"LastName\": \"Ovan\", \"FirstName\": \"Bertrand\", \"CarID\": \"29\", \"CurrentEmploymentType\": \"Facilities\", \"CurrentEmploymentTitle\": \"Facilities Group Manager\" }, { \"LastName\": \"Resumir\", \"FirstName\": \"Felix\", \"CarID\": \"30\", \"CurrentEmploymentType\": \"Security\", \"CurrentEmploymentTitle\": \"Security Group Manager\" }, { \"LastName\": \"Sanjorge Jr.\", \"FirstName\": \"Sten\", \"CarID\": \"31\", \"CurrentEmploymentType\": \"Executive\", \"CurrentEmploymentTitle\": \"President/CEO\" }, { \"LastName\": \"Strum\", \"FirstName\": \"Orhan\", \"CarID\": \"32\", \"CurrentEmploymentType\": \"Executive\", \"CurrentEmploymentTitle\": \"SVP/COO\" }, { \"LastName\": \"Tempestad\", \"FirstName\": \"Brand\", \"CarID\": \"33\", \"CurrentEmploymentType\": \"Engineering\", \"CurrentEmploymentTitle\": \"Drill Technician\" }, { \"LastName\": \"Vann\", \"FirstName\": \"Edvard\", \"CarID\": \"34\", \"CurrentEmploymentType\": \"Security\", \"CurrentEmploymentTitle\": \"Perimeter Control\" }, { \"LastName\": \"Vasco-Pais\", \"FirstName\": \"Willem\", \"CarID\": \"35\", \"CurrentEmploymentType\": \"Executive\", \"CurrentEmploymentTitle\": \"Environmental Safety Advisor\" }, { \"LastName\": \"Hafon\", \"FirstName\": \"Albina\", \"CarID\": \"\", \"CurrentEmploymentType\": \"Facilities\", \"CurrentEmploymentTitle\": \"Truck Driver\" }, { \"LastName\": \"Hawelon\", \"FirstName\": \"Benito\", \"CarID\": \"\", \"CurrentEmploymentType\": \"Facilities\", \"CurrentEmploymentTitle\": \"Truck Driver\" }, { \"LastName\": \"Hawelon\", \"FirstName\": \"Claudio\", \"CarID\": \"\", \"CurrentEmploymentType\": \"Facilities\", \"CurrentEmploymentTitle\": \"Truck Driver\" }, { \"LastName\": \"Mies\", \"FirstName\": \"Henk\", \"CarID\": \"\", \"CurrentEmploymentType\": \"Facilities\", \"CurrentEmploymentTitle\": \"Truck Driver\" }, { \"LastName\": \"Morlun\", \"FirstName\": \"Valeria\", \"CarID\": \"\", \"CurrentEmploymentType\": \"Facilities\", \"CurrentEmploymentTitle\": \"Truck Driver\" }, { \"LastName\": \"Morlun\", \"FirstName\": \"Adan\", \"CarID\": \"\", \"CurrentEmploymentType\": \"Facilities\", \"CurrentEmploymentTitle\": \"Truck Driver\" }, { \"LastName\": \"Morluniau\", \"FirstName\": \"Cecilia\", \"CarID\": \"\", \"CurrentEmploymentType\": \"Facilities\", \"CurrentEmploymentTitle\": \"Truck Driver\" }, { \"LastName\": \"Nant\", \"FirstName\": \"Irene\", \"CarID\": \"\", \"CurrentEmploymentType\": \"Facilities\", \"CurrentEmploymentTitle\": \"Truck Driver\" }, { \"LastName\": \"Scozzese\", \"FirstName\": \"Dylan\", \"CarID\": \"\", \"CurrentEmploymentType\": \"Facilities\", \"CurrentEmploymentTitle\": \"Truck Driver\" }]\n\nexport const storeButtonArr = {\n    \"Brew've Been Served\": [{\n        s: '7:30',\n        e: '8:30',\n        d: 1,\n    }],\n    \"Hallowed Grounds\": [{\n        s: '7:30',\n        e: '8:30',\n        d: 2,\n    }],\n    \"Coffee Cameleon\": [{\n        s: '7:30',\n        e: '8:30',\n        d: 3,\n    }],\n    \"Coffee Shack\": [{\n        s: '11:45',\n        e: '12:15',\n        d: 1,\n    }],\n    \"Bean There Done That\": [{\n        s: '11:45',\n        e: '12:15',\n        d: 2,\n    }],\n    \"Jack's Magical Beans\": [{\n        s: '11:45',\n        e: '12:15',\n        d: 3,\n    }],\n    \"Brewed Awakenings\": [{\n        s: '11:45',\n        e: '12:15',\n        d: 4,\n    }],\n    \n    \"Katerinas Caf\": [{\n        s: '13:00',\n        e: '14:30',\n        d: 1,\n    }, {\n        s: '18:50',\n        e: '21:30',\n        d: 1,\n    }],\n    \"Gelatogalore\": [{\n        s: '13:00',\n        e: '14:20',\n        d: 5,\n    }],\n    \"Ouzeri Elian\": [{\n        s: '13:00',\n        e: '14:20',\n        d: 3,\n    }, {\n        s: '19:00',\n        e: '21:30',\n        d: 3,\n    }],\n    \"Kalami Kafenion\": [{\n        s: '13:10',\n        e: '14:20',\n        d: 4,\n    }, {\n        s: '19:00',\n        e: '20:30',\n        d: 4,\n    }],\n    \"Hippokampos\": [{\n        s: '13:00',\n        e: '14:00',\n        d: 2,\n    }, {\n        s: '19:10',\n        e: '22:30',\n        d: 2,\n    }],\n    \"Abila Zacharo\": [{\n        s: '13:00',\n        e: '14:30',\n        d: 7,\n    }],\n    \"Guy's Gyros\": [{\n        s: '13:30',\n        e: '14:30',\n        d: 6,\n    }, {\n        s: '19:0',\n        e: '21:40',\n        d: 6,\n    }],\n    \"Abila Airport\": [{\n        s: '8:26',\n        e: '9:40',\n        d: 1,\n    }, {\n        s: '12:20',\n        e: '13:10',\n        d: 1,\n    }, {\n        s: '15:20',\n        e: '16:10',\n        d: 1,\n    }],\n    \"Nationwide Refinery\": [{\n        s: '10:00',\n        e: '13:00',\n        d: 5,\n    }],\n    \"Maximum Iron and Steel\": [{\n        s: '10:10',\n        e: '10:50',\n        d: 1,\n    }, {\n        s: '14:50',\n        e: '15:20',\n        d: 1,\n    }],\n    \"Carlyle Chemical Inc.\": [{\n        s: '9:40',\n        e: '10:10',\n        d: 1,\n    },\n    {\n        s: '12:30',\n        e: '13:00',\n        d: 2,\n    },\n    {\n        s: '14:30',\n        e: '14:50',\n        d: 1,\n    },\n    {\n        s: '16:20',\n        e: '17:20',\n        d: 1,\n    }],\n    \"Abila Scrapyard\": [{\n        s: '14:10',\n        e: '14:30',\n        d: 2,\n    }],\n    \"Octavio's Office Supplies\": [{\n        s: '14:30',\n        e: '16:00',\n        d: 3,\n    }],\n    \"Chostus Hotel\": [{\n        s: '12:10',\n        e: '14:00',\n        d: 8,\n    }],\n    \"Frank's Fuel\": [{\n        s: '12:10',\n        e: '12:40',\n        d: 6,\n    }, {\n        s: '18:10',\n        e: '18:50',\n        d: 1,\n    }],\n    \"Kronos Pipe and Irrigation\": [{\n        s: '14:00',\n        e: '14:20',\n        d: 8,\n    }],\n    \"Stewart and Sons Fabrication\": [{\n        s: '10:20',\n        e: '12:20',\n        d: 7,\n    }],\n    \"Albert's Fine Clothing\": [{\n        s: '15:20',\n        e: '16:20',\n        d: 2,\n    }, {\n        s: '19:00',\n        e: '21:20',\n        d: 5,\n    }],\n    \"Kronos Mart\": [{\n        s: '3:10',\n        e: '4:00',\n        d: 1,\n    }, {\n        s: '7:30',\n        e: '8:40',\n        d: 4,\n    }],\n    \"Daily Dealz\": [{\n        s: '5:50',\n        e: '6:20',\n        d: 1,\n    }],\n    \"Shoppers' Delight\": [{\n        s: '15:10',\n        e: '16:10',\n        d: 7,\n    }, {\n        s: '19:20',\n        e: '21:30',\n        d: 7,\n    }],\n    \"Ahaggo Museum\": [{\n        s: '15:00',\n        e: '17:00',\n        d: 8,\n    }],\n    \"Desafio Golf Course\": [{\n        s: '13:00',\n        e: '15:40',\n        d: 9,\n    }],\n    \"Roberts and Sons\": [{\n        s: '19:10',\n        e: '21:30',\n        d: 8,\n    }],\n    \"U-Pump\": [{\n        s: '13:10',\n        e: '13:30',\n        d: 6,\n    }, {\n        s: '17:25',\n        e: '17:55',\n        d: 1,\n    }],\n    \"General Grocer\": [{\n        s: '15:20',\n        e: '16:00',\n        d: 5,\n    }, {\n        s: '20:30',\n        e: '21:40',\n        d: 4,\n    }],\n    \"Frydos Autosupply n' More\": [{\n        s: '15:30',\n        e: '16:20',\n        d: 4,\n    }, {\n        s: '19:00',\n        e: '21:40',\n        d: 9,\n    }],\n}\n\n\n\n// export const storeButtonArr = {\n//     \"Brew've Been Served\": [{\n//         s: '7:20',\n//         e: '7:50',\n//         d: 1,\n//     }],\n//     \"Hallowed Grounds\": [{\n//         s: '7:50',\n//         e: '8:20',\n//         d: 1,\n//     }],\n//     \"Coffee Cameleon\": [{\n//         s: '8:20',\n//         e: '8:50',\n//         d: 1,\n//     }],\n\n//     \"Coffee Shack\": [{\n//         s: '11:45',\n//         e: '12:15',\n//         d: 1,\n//     }],\n//     \"Bean There Done That\": [{\n//         s: '11:45',\n//         e: '12:15',\n//         d: 2,\n//     }],\n//     \"Jack's Magical Beans\": [{\n//         s: '11:45',\n//         e: '12:15',\n//         d: 3,\n//     }],\n//     \"Brewed Awakenings\": [{\n//         s: '11:45',\n//         e: '12:15',\n//         d: 4,\n//     }],\n    \n//     \"Katerinas Caf\": [{\n//         s: '13:00',\n//         e: '13:30',\n//         d: 1,\n//     }, {\n//         s: '19:00',\n//         e: '19:30',\n//         d: 1,\n//     }],\n//     \"Gelatogalore\": [{\n//         s: '13:30',\n//         e: '14:00',\n//         d: 1,\n//     }],\n//     \"Ouzeri Elian\": [{\n//         s: '14:00',\n//         e: '14:30',\n//         d: 1,\n//     }, {\n//         s: '19:30',\n//         e: '20:00',\n//         d: 1,\n//     }],\n//     \"Hippokampos\": [{\n//         s: '14:30',\n//         e: '15:00',\n//         d: 1,\n//     }, {\n//         s: '20:00',\n//         e: '20:30',\n//         d: 1,\n//     }],\n//     \"Kalami Kafenion\": [{\n//         s: '15:00',\n//         e: '15:30',\n//         d: 1,\n//     }, {\n//         s: '20:30',\n//         e: '21:00',\n//         d: 1,\n//     }],\n//     \"Abila Zacharo\": [{\n//         s: '12:30',\n//         e: '13:00',\n//         d: 1,\n//     }],\n//     \"Guy's Gyros\": [{\n//         s: '15:30',\n//         e: '16:00',\n//         d: 1,\n//     }, {\n//         s: '21:00',\n//         e: '21:30',\n//         d: 1,\n//     }],\n\n//     // partner\n//     \"Abila Airport\": [{\n//         s: '8:30',\n//         e: '9:00',\n//         d: 2,\n//     }, {\n//         s: '12:30',\n//         e: '13:00',\n//         d: 2,\n//     }, {\n//         s: '15:30',\n//         e: '16:00',\n//         d: 2,\n//     }],\n//     \"Nationwide Refinery\": [{\n//         s: '10:00',\n//         e: '10:30',\n//         d: 2,\n//     }],\n//     \"Maximum Iron and Steel\": [{\n//         s: '10:30',\n//         e: '11:00',\n//         d: 2,\n//     }, {\n//         s: '14:50',\n//         e: '15:20',\n//         d: 2,\n//     }],\n//     \"Carlyle Chemical Inc.\": [{\n//         s: '9:30',\n//         e: '10:00',\n//         d: 2,\n//     },\n//     {\n//         s: '12:30',\n//         e: '13:00',\n//         d: 2,\n//     },\n//     {\n//         s: '14:30',\n//         e: '14:50',\n//         d: 2,\n//     },\n//     {\n//         s: '16:20',\n//         e: '17:20',\n//         d: 2,\n//     }],\n//     \"Abila Scrapyard\": [{\n//         s: '14:10',\n//         e: '14:30',\n//         d: 2,\n//     }],\n//     \"Octavio's Office Supplies\": [{\n//         s: '14:30',\n//         e: '16:00',\n//         d: 3,\n//     }],\n//     \"Chostus Hotel\": [{\n//         s: '12:10',\n//         e: '14:00',\n//         d: 8,\n//     }],\n//     \"Frank's Fuel\": [{\n//         s: '12:10',\n//         e: '12:40',\n//         d: 6,\n//     }, {\n//         s: '18:10',\n//         e: '18:50',\n//         d: 1,\n//     }],\n//     \"Kronos Pipe and Irrigation\": [{\n//         s: '14:00',\n//         e: '14:20',\n//         d: 8,\n//     }],\n//     \"Stewart and Sons Fabrication\": [{\n//         s: '10:20',\n//         e: '12:20',\n//         d: 7,\n//     }],\n//     \"Albert's Fine Clothing\": [{\n//         s: '15:20',\n//         e: '16:20',\n//         d: 2,\n//     }, {\n//         s: '19:00',\n//         e: '21:20',\n//         d: 5,\n//     }],\n//     \"Kronos Mart\": [{\n//         s: '3:10',\n//         e: '4:00',\n//         d: 1,\n//     }, {\n//         s: '7:30',\n//         e: '8:40',\n//         d: 4,\n//     }],\n//     \"Daily Dealz\": [{\n//         s: '5:50',\n//         e: '6:20',\n//         d: 1,\n//     }],\n//     \"Shoppers' Delight\": [{\n//         s: '15:10',\n//         e: '16:10',\n//         d: 7,\n//     }, {\n//         s: '19:20',\n//         e: '21:30',\n//         d: 7,\n//     }],\n//     \"Ahaggo Museum\": [{\n//         s: '15:00',\n//         e: '17:00',\n//         d: 8,\n//     }],\n//     \"Desafio Golf Course\": [{\n//         s: '13:00',\n//         e: '15:40',\n//         d: 9,\n//     }],\n//     \"Roberts and Sons\": [{\n//         s: '19:10',\n//         e: '21:30',\n//         d: 8,\n//     }],\n//     \"U-Pump\": [{\n//         s: '13:10',\n//         e: '13:30',\n//         d: 6,\n//     }, {\n//         s: '17:25',\n//         e: '17:55',\n//         d: 1,\n//     }],\n//     \"General Grocer\": [{\n//         s: '15:20',\n//         e: '16:00',\n//         d: 5,\n//     }, {\n//         s: '20:30',\n//         e: '21:40',\n//         d: 4,\n//     }],\n//     \"Frydos Autosupply n' More\": [{\n//         s: '15:30',\n//         e: '16:20',\n//         d: 4,\n//     }, {\n//         s: '19:00',\n//         e: '21:40',\n//         d: 9,\n//     }],\n// }","import { storeMapType } from \"../data/consumer_data\";\n\nexport const building_coordinate = [\n    {\n        name: 'Hallowed Grounds',\n        desc: '',\n        type: 'Consumer sites',\n        range: [[24.88388038, 36.06553341], [24.88788038, 36.06253341]],\n    },\n    {\n        name: 'Bean There Done That',\n        desc: '',\n        range: [[24.84912302000002,36.084489514999994],[24.853505705000018,36.07924747999999]],\n        type: 'Consumer sites',\n    },\n    {\n        name: 'Kronos Mart',\n        desc: '',\n        range: [[24.846974645000017,36.06807593],[24.851529200000016,36.064896335]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Ouzeri Elian\",\n        desc: '',\n        range: [[24.870177095000017,36.0544982],[24.87447384500002,36.05002958]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Coffee Cameleon\",\n        desc: '',\n        range: [[24.888910925000015,36.05656064],[24.893121740000016,36.05329511]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Abila Airport\",\n        desc: '',\n        range: [[24.824030000000022,36.054756005],[24.83417033000002,36.04727966]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Abila Scrapyard\",\n        desc: '',\n        range: [[24.84370911500002,36.076067885],[24.849294890000017,36.072630485]],\n        type: 'Consumer sites',\n    },\n    \n    {\n        name: \"Chostus Hotel\",\n        desc: '',\n        range: [[24.890543690000012,36.07220081],[24.898707515000016,36.067474385]],\n        type: 'Consumer sites',\n    },\n    // 周六19号补充的\n    {\n        name: \"Hippokampos\",\n        desc: \"在Albert's Fine Clothing上方，已验证,6\",\n        range: [[24.85565408000002,36.07770065],[24.859950830000017,36.07598195]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Abila Zacharo\",\n        desc: '在Roberts and Sons左边，已验证,6、7',\n        range: [[24.84981050000002,36.064380725],[24.85178700500002,36.061802675]],\n        type: 'Consumer sites',\n    },\n    {\n        name: 'Roberts and Sons',\n        desc: '已验证, 7号',\n        range: [[24.851529200000016,36.06412292],[24.853763510000018,36.061974545]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Albert's Fine Clothing\",\n        desc: '已验证, 7号',\n        range: [[24.85479473000002,36.07598195],[24.857458715000018,36.074349185]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Gelatogalore\",\n        desc: '冰淇淋店，有些偏差，应该在杂货店的下面，已验证',\n        range: [[24.85702904000002,36.059998039999996],[24.858919610000015,36.05913869]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Kalami Kafenion\",\n        desc: \"在Kronos Mart的右边一点，7号得到的，12号验证\",\n        range: [[24.85161513500002,36.067474385],[24.853763510000018,36.065240075]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Frydos Autosupply n' More\",\n        desc: \"根据7号和8号，修车厂应该在 Brew'veBeenServed 和 Katerinas Caf 中间\",\n        range: [[24.900512150000015,36.055443485000005],[24.903605810000016,36.054412264999996]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Katerinas Caf\",\n        desc: \"比原来的小一点\",\n        range: [[24.897590360000017,36.055787224999996],[24.900426215000014,36.05329511]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Guy's Gyros\",\n        desc: \"在Brew'veBeenServed左下角，12和8车验证\",\n        range: [[24.901801175000017,36.05690438],[24.903176135000013,36.05518568]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"General Grocer\",\n        desc: '杂货店, 12号车验证',\n        range: [[24.85565408000002,36.061287065],[24.85728684500002,36.059912105]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Shoppers' Delight\",\n        desc: \"在Ouzeri Elian 的左边 13号车验证\",\n        range: [[24.867341240000016,36.05432633],[24.870005225000018,36.051490475]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Brew've Been Served\",\n        desc: '非常的小， 13号车验证',\n        range: [[24.900598085000013,36.054584135],[24.901887110000015,36.053381045]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Frank's Fuel\",\n        desc: '比图标靠右一点，15号车验证',\n        range: [[24.83872488500002,36.073489835],[24.84224822000002,36.07116959]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Brewed Awakenings\",\n        desc: \"根据16号车得到的，这个地方比较偏，所以店的消费较少\",\n        range: [[24.86287262000002,36.07443512],[24.865364735000018,36.07271642]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Ahaggo Museum\",\n        desc: \"博物馆\",\n        range: [[24.875419130000015,36.077958455],[24.879887750000016,36.073919509999996]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Octavio's Office Supplies\",\n        desc: \"文具店，20号车14号路过的\",\n        range: [[24.85728684500002,36.05896682],[24.85874774000002,36.0579356]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"U-Pump\",\n        desc: \"23号车6号下午\",\n        range: [[24.869059940000017,36.069279019999996],[24.871895795000015,36.066615035]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Desafio Golf Course\",\n        desc: \"31号车\",\n        range: [[24.85763058500002,36.091536184999995],[24.86390384000002,36.088184719999994]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Jack's Magical Beans\",\n        desc: \"缩小一下\",\n        range: [[24.872325470000018,36.069021215],[24.876106610000015,36.066271295]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Maximum Iron and Steel\",\n        desc: '钢铁厂',\n        range: [[24.83674838000002,36.06601349],[24.84319350500002,36.06240422]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Carlyle Chemical Inc.\",\n        desc: '化工厂',\n        range: [[24.879715880000017,36.059654300000005],[24.882981410000017,36.05741999]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Nationwide Refinery\",\n        desc: '炼油厂',\n        range: [[24.884442305000015,36.059482429999996],[24.888996860000013,36.05656064]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Kronos Pipe and Irrigation\",\n        desc: '灌溉设备厂, 101车6号和13号',\n        range: [[24.83167821500002,36.066443164999995],[24.83434220000002,36.064380725]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Stewart and Sons Fabrication\",\n        desc: '玻璃厂？不知道，101车七号',\n        range: [[24.907301015000012,36.05501381],[24.909363455000012,36.05295137]],\n        type: 'Consumer sites',\n    },\n    {\n        name: \"Coffee Shack\",\n        desc: '消费场所，没找到，无所谓，就6417一个卡去，这个数据的时间也是错误的',\n        range: [[24.858575870000017,36.07495073],[24.861841400000017,36.071255525]],\n        type: 'Consumer sites',\n    },\n    // {\n    //     name: \"Daily Dealz\",\n    //     desc: '消费场所 就一次消费，就在汽车1的家旁边，自己看着是否需要画',\n    //     range: [[24.881778320000016,36.067130645],[24.883668890000017,36.06532601]],\n    //     type: 'Consumer sites',\n    // },\n    \n    // ================= 其他建筑物 =============\n    {\n        name: \"carly's coffee\",\n        range: [[24.85754465000002,36.058709015],[24.861153920000017,36.055271614999995]],\n        type: 'Other Building',\n    },\n    {\n        name: \"Cup o'Joe\",\n        range: [[24.877825310000016,36.053552915],[24.880833035000016,36.050717060000004]],\n        type: 'Other Building',\n    },\n    {\n        name: \"Abila Hospital\",\n        range: [[24.876708155000017,36.057677795000004],[24.883840760000016,36.053209175]],\n        type: 'Other Building',\n    },\n    {\n        name: 'GAStect',\n        range: [[24.877309700000016,36.050974865],[24.881950190000016,36.046162505]],\n        type: 'Other Building',\n    },\n    {\n        name: \"kronos capitol\",\n        range: [[24.84456846500002,36.058537145],[24.850841720000016,36.05209202]],\n        type: 'Other Building',\n    },\n    ].map(d => ({\n        ...d,\n        classify: storeMapType[d.name] || 'location',\n    }))","import { ascending } from \"d3-array\"\nimport { scaleOrdinal } from \"d3-scale\"\nimport { schemeCategory10 } from \"d3-scale-chromatic\"\nimport moment from \"moment\"\nimport { building_coordinate } from \"../data/buliding_coordinate\"\nimport { storeClassify, storeMapType } from \"../data/consumer_data\"\n\nexport  function pushOrPop(arr, d, mode='single') {\n    const newArr = [...arr]\n    if (mode !== 'single') {\n        if (newArr.includes(d)) {\n            return newArr.filter(d1 => d1 !== d)\n        }\n        newArr.push(d)\n        return newArr\n    } else {\n        if (newArr.includes(d)) {\n            return []\n        } else {\n            return [d]\n        }\n    }\n}\n\n//增加两个容易溢出的数据\nexport function add(a, b) {\n    return parseFloat((Number(a) + Number(b)).toFixed(10))\n}\n\n// 计算只有时分秒的时间戳\nexport function calHourTime(hour) {\n    let hourStr = hour.toString()\n    const count = hourStr.match(/:/g)\n        ? hourStr.match(/:/g).length\n        : 0\n    switch (count) {\n        case 0:\n            hourStr = `${hourStr}:00:00`\n            break;\n        case 1:\n            hourStr = `${hourStr}:00`\n            break;\n        default:\n            break;\n    }\n    return moment(`2020-01-01 ${hourStr}`).unix()\n}\n\n// 计算商店分类颜色\nexport const calcualteTypeColor = id => {\n    const domain = storeClassify.map(d => d.type)\n    const colorScale = scaleOrdinal(domain.sort(ascending), schemeCategory10)\n    if (domain.includes(id)) {\n        return colorScale(id)\n    }\n    return 'gray'\n}\n\nexport const calcualteStoreColor = store => {\n    if(store.includes('unknow')) return 'red';\n    const type = storeMapType[store] || 'location'\n    return calcualteTypeColor(type)\n}\n\nexport const findLocaiton = (coor) => {\n    const [long, lat] = coor\n    const a = building_coordinate.find(d => {\n        const [sp, ep] = d.range\n        return sp[0] < Number(long)\n            && Number(long) < ep[0]\n            && Number(lat) < sp[1]\n            && Number(lat) > ep[1]\n    })\n    return a ? a.name : false\n} ","import { ascending, extent } from 'd3-array'\nimport { json } from 'd3-fetch'\nimport { path } from 'd3-path'\nimport { event, drag, forceCollide, forceLink, forceManyBody, forceSimulation, scaleLinear, scaleOrdinal, schemeCategory10, select, selectAll, color, csv } from 'd3'\nimport { arc, curveCatmullRom, line } from 'd3-shape'\nimport { chain } from 'lodash'\nimport moment from 'moment'\nimport React, { useEffect, useMemo, useRef, useState } from 'react'\nimport { ccLoyMap, storeButtonArr, storeClassify, storeMapType, timeArr, timeClassifyData } from '../../data/consumer_data'\nimport { add, calHourTime, pushOrPop } from '../../utils'\nimport './index.scss'\n\nfunction calData(res) {\n    const nodeData = Object.keys(ccLoyMap).map(d => {\n        // const data = res.filter(d1 => d1.loyaltynum === d && d1.type === 'justCC')\n        const data = res.filter(d1 => d1.loyaltynum === d)\n        const location = chain(data).map('location').uniq().value()\n        const type = chain(location).map(d => storeMapType[d]).sortBy().uniq().value()\n        return {\n            id: d,\n            data,\n            location,\n            type,\n            arcData: chain(data)\n                .reduce((obj, d1) => {\n                    obj[d1.locationType] = {\n                        value: obj[d1.locationType]\n                        ? add(obj[d1.locationType].value, d1.price)\n                        : Number(d1.price),\n                        type: d1.locationType,\n                    }\n                    return obj\n                }, {})\n                .values()\n                .value()\n        }\n    })\n    const linksObj = {}\n    nodeData.forEach((d1) => {\n        const key1 = d1.type.toString()\n        nodeData.forEach(d2 => {\n            if (d1.id === d2.id) return\n            if (linksObj[`${d1.id}-${d2.id}`] || linksObj[`${d2.id}-${d1.id}`]) return\n            const key2 = d2.type.toString()\n            if(key1 !== key2) return\n            // const sameLoaction = intersection(d1.location, d2.location)\n            // const sameLoaction = d1.data\n            //     .filter(d3 => {\n            //         const a = d2.data.filter(d4 => \n            //             d4.location === d3.location\n            //             && Math.abs(moment(d4.timestamp).diff(moment(d3.timestamp))) < 5 * 60 * 1000)\n            //         return a.length\n            //     })\n            // const sameLoaction = []\n            linksObj[`${d1.id}-${d2.id}`] = {\n                source: d1.id,\n                target: d2.id,\n                value: 1\n            }\n        })\n    })\n    const nodes = nodeData\n    const links = chain(linksObj).values().filter(d => d.value > 0).value()\n    return [nodes, links]\n}\n\nexport default function ConsumerGraph() {\n    const [top, right, bottom, left] = [0,0,0,0]\n    const containerRef = useRef(null)\n    const [size, setsize] = useState({\n        width: 300,\n        height: 300,\n    })\n\n    const width = useMemo(() => size.width, [size])\n    const height = useMemo(() => size.height, [size])\n\n    const radiusArr = useMemo(() => {\n        const maxSize = Math.min(width / 2, height / 2)\n        const minR = Math.max(maxSize / 4, 120)\n        const item =  (maxSize - minR) / 3\n        return [\n            [0, minR], // card\n            [minR, item * 2.5], // timeCircle\n            [item * 4, item * 4 + 1], // timeLabel\n            [item * 2.5 + 10, item * 4 - 10], // store\n        ]\n    }, [width, height])\n\n    useEffect(() => {\n        const { clientWidth, clientHeight } = containerRef.current\n        setsize({\n            width: clientWidth,\n            height: clientHeight,\n        })\n    }, [])\n\n    // 是否展示track \n    const [showTrack, setshowTrack] = useState(true)\n    // 选中模式\n    const [selectMode, setselectMode] = useState('mulitiple')\n    // MergeMethod\n    const [mergefun, setMergeFun] = useState('intersection')\n\n    const anagleScale = scaleLinear()\n        .domain([0, 24])\n        .range([0, 360])\n\n    const dayScale = scaleLinear()\n        .domain(extent(timeArr))\n        .range([radiusArr[1][0], radiusArr[1][1]])\n\n    const timeScale = scaleLinear()\n        .domain([calHourTime('00:00:00'), calHourTime('23:59:59')])\n        .range([0, Math.PI * 2])\n\n    const consumePath = arc()\n        .innerRadius(d => dayScale(d.day))\n        .outerRadius(d => dayScale(d.day) + (radiusArr[1][1] - radiusArr[1][0]) / timeArr.length )\n        .startAngle(d => timeScale(d.time))\n        .endAngle(d => timeScale(d.time + 500))\n\n    // getData\n    const [originCCdata, setOriginCCdata] = useState([])\n\n    // 选中\n    const [activeStore, setActiveStore] = useState([])\n    const [activeClassify, setActiveClassify] = useState([])\n    const [activeCustom, setActiveCustom] = useState([])\n\n    // 展示的数据\n    const consumeData = useMemo(() => {\n        return originCCdata\n        .filter(d => activeStore.length ? activeStore.includes(d.location) : true)\n        .filter(d => activeCustom.length ? activeCustom.includes(d.id) : true)\n    }, [activeStore, originCCdata, activeCustom])\n\n    // 所有的会员卡的ID\n    const [ccNumData, setccNumData] = useState([])\n\n    // 请求数据\n    useEffect(() => {\n        json('./data/merge_cc_and_loy.json').then(res => {\n            const newConsumeData = res.map(d => {\n                const [dayStr, hourStr] = d.timestamp.split(' ')\n                const day = moment(dayStr).unix()\n                const time = calHourTime(hourStr)\n                const locationType = storeClassify.find(d1 => d1.data.includes(d.location)).type\n                // 时间有点不准确\n                return {\n                    ...d,\n                    day,\n                    dayStr,\n                    id: d.loyaltynum,\n                    time,\n                    locationType,\n                    hour: hourStr.split(':')[0],\n                }\n            })\n            const newLoy = chain(newConsumeData).map('id').uniq().value()\n            setccNumData(newLoy)\n            setOriginCCdata(newConsumeData)\n            const [nodes, links] = calData(res)\n            drawForce(nodes, links)\n        })\n    }, [])\n\n    const drawForce = useMemo(() => {\n        return (nodes, links) => {\n            const distance = ([x1, y1], [x2, y2]) => Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));\n            const radius = radiusArr[0][1] - 20\n            const force = forceSimulation(nodes)\n                .force('links', forceLink(links)\n                    .id(d => d.id)\n                    .strength(d => 2)\n                    // .distance(0)\n                )\n                .force('charge', forceManyBody()\n                    .strength(-4)\n                )\n                .force('collide', forceCollide()\n                    .radius(10)\n                    // .iterations(20)\n                )\n                .force('circle', () => {\n                    nodes.forEach((node, i) => {\n                        if (distance([node.x, node.y], [0, 0]) > radius) {\n                            const theta = Math.atan((node.y) / (node.x));\n                            node.x = radius * Math.cos(theta) * (node.x < 0 ? -1 : 1);\n                            node.y = radius * Math.sin(theta) * (node.x < 0 ? -1 : 1);\n                          }\n                    })\n                })\n            \n            selectAll('.custom-item').each(function() {\n                const id = select(this).attr('id')\n                const thisData = nodes.filter(d => d.id === id)\n                select(this).data(thisData)\n            })\n            .call(\n                drag()\n                    .on('start', (d) => {\n                        const alpha = Math.max(force.alpha(), 0.1)\n                        force.alpha(alpha).restart()\n                        d.fx = null\n                        d.fy = null\n                    })\n                    .on('drag', d=> {\n                        d.x = event.x\n                        d.y = event.y\n                    })\n                    .on('end', d=>{\n                        d.fx = event.x\n                        d.fy = event.y\n                    })\n            )\n\n            select('.links')\n                .selectAll('line').remove()\n            const link = select('.links')\n                .selectAll('line')\n                .data(links)\n                .enter()\n                .append('line')\n                .attr(\"stroke-width\", d => 1)\n                .attr(\"stroke\", '#e9e9e9');\n\n            force.on('tick', () => {\n                link\n                    .attr(\"x1\", d => d.source.x)\n                    .attr(\"y1\", d => d.source.y)\n                    .attr(\"x2\", d => d.target.x)\n                    .attr(\"y2\", d => d.target.y);\n\n                selectAll('.custom-item')\n                    .attr('transform', d =>`translate(${d.x}, ${d.y})`)\n            })\n    }\n    }, [])\n\n    // 数据的信用卡\n    const exitCCArr = useMemo(() => {\n        return chain(consumeData)\n            .map('id')\n            .uniq()\n            .value()\n    }, [consumeData])\n\n    // 剩余的价格比例尺\n    const priceOpacity = useMemo(() => {\n        const extents = extent(consumeData, d => Number(d.price))\n        return scaleLinear()\n        .domain(extents)\n        .range([0.2, 1])\n    }, [consumeData])\n\n    const locationPriceObj = useMemo(() => {\n        return consumeData.reduce((obj, d) => {\n            const num = obj[d.location] || 0\n            obj[d.location] = add(num, d.price)\n            return obj\n        }, {})\n    }, [consumeData])\n\n    // 地点消费比例尺\n    const locationOpacity = useMemo(() => {\n        const extents = extent(Object.values(locationPriceObj))\n        return scaleLinear()\n        .domain(extents)\n        .range([0.2, 1])\n    }, [locationPriceObj])\n    \n    // 商店列表\n    const storePath = arc()\n        .innerRadius(d => d.inner)\n        .outerRadius(d => d.outer)\n        .startAngle(d => timeScale(calHourTime(d.s)))\n        .endAngle(d => timeScale(calHourTime(d.e)))\n        .padAngle(.01)\n        .cornerRadius(4)\n\n    const timePath = arc()\n        .innerRadius(d => radiusArr[2][0])\n        .outerRadius(d => radiusArr[2][1])\n        .startAngle(d => {\n            if(d[0]<0) {\n                return timeScale(moment(`2019-12-31 ${22}:00:00`).unix())\n            }\n            return timeScale(calHourTime(d[0]))\n        })\n        .endAngle(d => timeScale(calHourTime(d[1])))\n        .padAngle(.1)\n        .cornerRadius(4)\n\n    const middleArcLine = d => {\n        if (!d.innerRadius || !d.outerRadius) {\n            return ''\n        }\n        const angles = [d.startAngle, d.endAngle].map(\n            d1 => d1 - Math.PI / 2\n        )\n        const r1 = Math.max(0, (d.outerRadius + d.innerRadius) / 2)\n        const middleAngle = (angles[1] + angles[0]) / 2\n        const invertDirection = middleAngle > 0 && middleAngle < Math.PI\n        if (invertDirection) angles.reverse()\n        const pathFun = path()\n        pathFun.arc(0, 0, r1, angles[0], angles[1], invertDirection)\n        return pathFun.toString()\n    }\n\n    const colorScale = scaleOrdinal(storeClassify.map(d => d.type).sort(ascending), schemeCategory10)\n    const pointObj = useMemo(() => {\n        return ccNumData.reduce((obj, d) => {\n            const thisData = chain(consumeData)\n                .filter(d1 => d1.id === d)\n                .filter(d1 => d1.type !== 'cash')\n                .reduce((obj, d1) => {\n                    const key = d1.dayStr\n                    if (!obj[key]) obj[key] = []\n                    obj[key].push(consumePath.centroid(d1))\n                    return obj\n                }, {})\n                .values()\n                .value()\n            obj[d] = thisData\n            return obj\n        }, {})\n    }, [ccNumData, consumeData, consumePath])\n\n    const activeTimeData = useMemo(() => {\n        return chain(consumeData)\n            .map(d => d.dayStr.replace('/2014', ''))\n            .uniq()\n            .value()\n    }, [consumeData])\n\n    const trackPath = line()\n        .x(d => d[0])\n        .y(d => d[1])\n        .curve(curveCatmullRom.alpha(0.5));\n\n    const weekDay = ['01/11', '01/12', '01/18', '01/19']\n    return (\n        <div className='consumerGraph'>\n            <div className=\"left\" ref={containerRef}>\n                <svg height={height} width={width} className='main'>\n                    <g transform={`translate(${left}, ${top})`}>\n                        <g className=\"timebg\">\n                            {timeArr.map((d, i) => {\n                                const text = moment(d * 1000).format('MM/DD')\n                                const textOpactiy = activeTimeData.includes(text) ? 1 : 0\n                                return <g key={d}>\n                                    <text opacity={textOpactiy} transform={`translate(${width / 2}, ${height /2 - dayScale(d)})`}>\n                                        {text} {weekDay.includes(text) ? 'weekend' : ''}\n                                    </text>\n                                    <circle cx={width / 2} cy={height / 2} r={dayScale(d)} /> \n                                </g>\n                            })}\n                        </g>\n                        <g className=\"timeTick\">\n                            {[6, 9, 12, 14, 18, 22].map((d, i) => {\n                                const attr = {\n                                    x1: width / 2,\n                                    y1: height / 2 - radiusArr[2][0],\n                                    x2: width / 2,\n                                    y2: height / 2,\n                                }\n                                return (\n                                    <g key={d} className='timeSplit' transform={`rotate(${anagleScale(d)})`}>\n                                        <line {...attr} />\n                                        <text x={attr.x1} y={attr.y1} dy={0}>{`${d}:00`}</text>\n                                    </g>\n                                )\n                            })}\n                        </g>\n                        <g className=\"time-classify\" transform={`translate(${width/2}, ${height / 2})`}>\n                            {timeClassifyData.map((d, i) => {\n                                const attr = {\n                                    d: timePath(d.data),\n                                }\n                                const textPathHrefProps = {\n                                    fill: 'none',\n                                    id: `time-${i}`,\n                                    d: middleArcLine({\n                                        innerRadius: radiusArr[2][1] + 10,\n                                        outerRadius: radiusArr[2][1]+10,\n                                        startAngle: d.data[0] < 0 ? \n                                            timeScale(moment(`2019-12-31 ${22}:00:00`).unix())\n                                            : timeScale(calHourTime(d.data[0])),\n                                        endAngle: timeScale(calHourTime(d.data[1])),\n                                    }),\n                                }\n                                const textPathProps = {\n                                    href: `#time-${i}`,\n                                    startOffset: '50%',\n                                    dominantBaseline: 'middle',\n                                }\n                                return (\n                                    <g key={d.data[0]}>\n                                        <path {...attr} className='time-button' />\n                                        <g className='time-label' >\n                                            <path {...textPathHrefProps} />\n                                            <text>\n                                                <textPath {...textPathProps}>\n                                                    {d.name}\n                                                </textPath>\n                                            </text>\n                                        </g>\n                                    </g>\n                                )\n                            })}\n                        </g>\n                        <g className='consume-g' transform={`translate(${width/2}, ${height / 2})`}>\n                            {consumeData.filter(d => d.type !== 'cash').map((d, i) => {\n                                const storeType = storeClassify.find(d1 => d1.data.includes(d.location)).type\n                                const attr = {\n                                    className: 'consume-item',\n                                    d: consumePath(d),\n                                    fill: colorScale(storeType),\n                                    fillOpacity: priceOpacity(d.price),\n                                }\n                                return (\n                                    <path key={JSON.stringify(d)} {...attr} />\n                                )\n                            })}\n                        </g>\n                        <g className='detail-store' transform={`translate(${width/2}, ${height / 2})`}>\n                        {\n                                Object.entries(storeButtonArr).map((d, i) => {\n                                    const [storeName, data] = d\n                                    const type = storeMapType[storeName]\n                                    return (\n                                        <g key={storeName}>\n                                            {\n                                                data.map(d1 => {\n                                                    const key = `${storeName}-${d1.s}`\n                                                    const startAngle = timeScale(calHourTime(d1.s))\n                                                    const endAngle = timeScale(calHourTime(d1.e))\n                                                    const gap = (radiusArr[3][1] - radiusArr[3][0]) / 9\n                                                    const inner = radiusArr[3][0] + gap * (d1.d - 1)\n                                                    const outer = inner + gap\n                                                    const attr = {\n                                                        d: storePath({\n                                                            inner,\n                                                            outer,\n                                                            s: d1.s,\n                                                            e: d1.e,\n                                                        }),\n                                                        fill: colorScale(type),\n                                                        stroke: colorScale(type),\n                                                        fillOpacity: locationOpacity(locationPriceObj[storeName]),\n                                                    }\n                                                    const textPathHrefProps = {\n                                                        fill: 'none',\n                                                        id: `text-${key}`,\n                                                        d: middleArcLine({\n                                                            innerRadius: (inner + outer) / 2,\n                                                            outerRadius: (inner + outer) / 2,\n                                                            startAngle,\n                                                            endAngle,\n                                                        }),\n                                                    }\n                                                    const textPathProps = {\n                                                        href: `#text-${key}`,\n                                                        startOffset: '50%',\n                                                        dominantBaseline: 'middle',\n                                                        textAnchor: 'middle',\n                                                    }\n                                                    let className = activeStore.includes(storeName) ? 'active' : ''\n                                                    if (activeStore.length > 0 && !activeStore.includes(storeName)) {\n                                                        className = 'disabled'\n                                                    }\n                                                    const opacity = consumeData.map(d => d.location).includes(storeName) ? 1 : 0.1\n                                                    const middle = (startAngle + endAngle) / 2\n                                                    const isBottom = middle > Math.PI / 2 && middle < Math.PI / 2 * 3\n                                                    const textData = isBottom ? storeName.split(' ').reverse() : storeName.split(' ')\n                                                    const dy = isBottom ? -10 : 10\n                                                    return (\n                                                        <g key={key} opacity={opacity} className={className} onClick={() => {\n                                                            const newActiveStore = pushOrPop(activeStore, storeName)\n                                                            const newType = chain(newActiveStore)\n                                                                .map(d2 => storeMapType[d2])\n                                                                .uniq()\n                                                                .value()\n                                                            setActiveStore(newActiveStore)\n                                                            setActiveClassify(newType)\n                                                        }}>\n                                                            <path {...attr} className='store-button' />\n                                                            <g className='store-label'>\n                                                                <path {...textPathHrefProps} />\n                                                                <text>\n                                                                <textPath {...textPathProps}>\n                                                                    {storeName.split(' ').map(d => d[0]).join().replace(/,/g, '')}\n                                                                </textPath>\n                                                                </text>\n                                                            </g>\n                                                        </g>\n                                                    )\n                                                })\n                                            }\n                                        </g>\n                                    )\n                                })\n                            }\n                        </g>\n                        <g className='customer' transform={`translate(${width/2}, ${height / 2})`}>\n                            <circle className='bg' cx={0} cy={0} r={radiusArr[1][0]}/>\n                            <g className='links' />\n                            <g>\n                                {\n                                    ccNumData.map((d, i) => {\n                                        const opacity = exitCCArr.includes(d) ? 1 : 0.1\n                                        const thisConsumeData = originCCdata.filter(d1 => d1.id === d)\n                                        // const priceA = thisConsumeData.filter(d1 => d1.type === 'cash')\n                                        //     .reduce((num, d1) => {\n                                        //         return add(num, d1.price)\n                                        //     }, 0)\n                                        // const priceB = thisConsumeData.filter(d1 => d1.type === 'justCC')\n                                        //     .reduce((num, d1) => {\n                                        //         return add(num, d1.price)\n                                        //     }, 0)\n                                        // console.log(priceA === priceB)\n                                        // console.log(thisConsumeData.filter(d1 => d1.type === 'justCC'))\n                                        const arcData = chain(thisConsumeData)\n                                            .reduce((obj, d1) => {\n                                                obj[d1.locationType] = {\n                                                    value: obj[d1.locationType]\n                                                    ? add(obj[d1.locationType].value, d1.price)\n                                                    : Number(d1.price),\n                                                    type: d1.locationType,\n                                                }\n                                                return obj\n                                            }, {})\n                                            .values()\n                                            // .flatten()\n                                            .value()\n                                        const total = thisConsumeData.reduce((t, d1) => add(t, d1.price), 0)\n                                        const thisAngleScale = scaleLinear()\n                                            .domain([0, total])\n                                            .range([0, 2 * Math.PI])\n                                        const thisArcFun = arc()\n                                            .innerRadius(0)\n                                            .outerRadius(5)\n                                            .startAngle(d1 => {\n                                                const index = arcData.findIndex(d2 => d2.type === d1.type)\n                                                const startValue = chain(arcData)\n                                                    .slice(0, index)\n                                                    .map('value')\n                                                    .reduce((t, d2) => add(t, d2), 0)\n                                                    .value()\n                                                return thisAngleScale(startValue)\n                                            })\n                                            .endAngle(d1 => {\n                                                const index = arcData.findIndex(d2 => d2.type === d1.type)\n                                                const endValue = chain(arcData)\n                                                    .slice(0, index)\n                                                    .map('value')\n                                                    .reduce((t, d2) => add(t, d2), 0)\n                                                    .value() + d1.value\n                                                return thisAngleScale(endValue)\n                                            })\n                                        return (\n                                            <g\n                                                opacity={opacity}\n                                                id={d}\n                                                className='custom-item'\n                                                transform={`translate(${i * 10}, ${0})`}\n                                                onClick={() => {\n                                                    const newActiveClassisy = pushOrPop(activeCustom, d, selectMode)\n                                                    setActiveCustom(newActiveClassisy)\n                                                }}\n                                            >\n                                                {\n                                                    arcData.map(d1 => {\n                                                        const attr = {\n                                                            d: thisArcFun(d1),\n                                                            key: `small-${d1.type}`,\n                                                            fill: colorScale(d1.type),\n                                                            stroke: colorScale(d1.type),\n                                                            fillOpacity: .3,\n                                                        }\n                                                        return <path {...attr}/>\n                                                    })\n                                                }\n                                                <text\n                                                    dy={-8}\n                                                >\n                                                    {d}\n                                                </text>\n                                            </g>\n                                        )\n                                    })\n                                }\n                            </g>\n                        </g>\n                        <g className='customerTrack' transform={`translate(${width/2}, ${height / 2})`}>\n                            {\n                                Object.entries(pointObj)\n                                    .map(d => {\n                                        const [name, data] = d\n                                        let opacity = activeCustom.includes(name) ? 1 : 0\n                                        // let opacity = consumeData.map(d1 => d1.id).includes(name) ? 1 : 0\n                                        if (opacity) {\n                                            opacity = showTrack ? 1 : 0\n                                        }\n                                        return (\n                                            <g opacity={opacity} key={name}>\n                                                {data.map(d1 => {\n                                                    return <path d ={trackPath(d1)} key={d1.toString()} />\n                                                })}\n                                            </g>\n                                            \n                                        )\n                                    })\n                            }\n                        </g>\n                    </g>\n                </svg>\n            </div>\n            <div className='right'>\n                <div className='condition'>\n                    <div className=\"item\">\n                        select mode：\n                        {['single', 'mulitiple'].map(d => {\n                            return (\n                                <>\n                                    <label htmlFor={d}>{d}</label>\n                                    <input\n                                        type='radio'\n                                        name='select-mode'\n                                        checked={selectMode === d}\n                                        onChange={() => {\n                                            if (selectMode !== d) {\n                                                setselectMode(d)\n                                            }\n                                        }}\n                                        value={d}\n                                        id={d}\n                                    />\n                                </>\n                            )\n                        })}\n                    </div>\n                    <div className='item'>\n                        show customer track：\n                        <input\n                            type='checkbox'\n                            name='track-mode'\n                            checked={showTrack}\n                            onChange={() => {\n                                setshowTrack(!showTrack)\n                            }}\n                        />\n                    </div>\n                    <div className='item'>\n                        merge method：\n                        {['union', 'intersection'].map(d => {\n                            return (\n                                <>\n                                    <label htmlFor={d}>{d}</label>\n                                    <input\n                                        type='radio'\n                                        name='merge-mode'\n                                        checked={mergefun === d}\n                                        onChange={() => {\n                                            if (mergefun !== d) {\n                                                setMergeFun(d)\n                                            }\n                                        }}\n                                        value={d}\n                                        id={d}\n                                    />\n                                </>\n                            )\n                        })}\n                    </div>\n                    <div className='item'>\n                        <button onClick={() => {\n                            setActiveStore([])\n                            setActiveClassify([])\n                            setActiveCustom([])\n                        }}>Refresh</button>\n                    </div>\n                </div>\n                <div className='legend'>\n                    {storeClassify.map(d => {\n                        const { type } = d\n                        const originColor = colorScale(type)\n                        let bgColor = color(originColor)\n                        bgColor.opacity = .6\n                        bgColor += ''\n                        let className = activeClassify.includes(type) ? 'active' : ''\n                        if (activeClassify.length > 0 && !activeClassify.includes(type)) {\n                            className = 'disabled'\n                        }\n                        return (\n                            <div className={`legend-item ${className}`} onClick={() => {\n                                const newActiveClassisy = pushOrPop(activeClassify, type)\n                                setActiveClassify(newActiveClassisy)\n                                const newActiveStore = chain(storeClassify)\n                                    .filter(d1 => newActiveClassisy.includes(d1.type))\n                                    .map('data')\n                                    .flatten()\n                                    .value()\n                                setActiveStore(newActiveStore)\n                            }}>\n                                <div className='legend-label' style={{\n                                    backgroundColor: bgColor,\n                                    borderColor: originColor,\n                                }} />\n                                <div className='legend-name'>{type}</div>\n                            </div>\n                        )\n                    })}\n                </div>\n            </div>\n        </div>\n    )\n}","import { json } from 'd3-fetch'\nimport { chain, countBy, forIn, sumBy, } from 'lodash'\nimport React, { useEffect, useMemo, useRef, useState } from 'react'\nimport moment from 'moment'\nimport { axisBottom, axisTop, curveStep, extent, line, schemeCategory10, scaleLinear, scaleOrdinal, scaleTime, scaleBand, select } from 'd3'\nimport { building_coordinate } from '../../data/buliding_coordinate'\nimport { calcualteStoreColor, findLocaiton } from '../../utils'\n\n\nfunction findHour(timestamp) {\n    const hour = parseInt(timestamp.split(' ')[1].split(':')[0])\n    return hour\n}\n\nconst timeRange = [\n    {\n        name: 'Sleeping.Morning',\n        key: 'sm',\n        range: [0, 6],\n    },\n    {\n        name: 'Breakfast',\n        key: 'bf',\n        range: [6, 9],\n    },\n    {\n        name: 'Working.AM',\n        key: 'wa',\n        range: [9, 12],\n    },\n    {\n        name: 'Lunch',\n        key: 'l',\n        range: [12, 15],\n    },\n    {\n        name: 'Working.PM',\n        key: 'wp',\n        range: [15, 18],\n    },\n    {\n        name: 'Dinner',\n        key: 'd',\n        range: [18, 20],\n    },\n    {\n        name: 'After Dinner',\n        key: 'ad',\n        range: [20, 22],\n    },\n    {\n        name: 'Sleeping.Night',\n        key: 'sn',\n        range: [22, 24],\n    },\n]\nfunction calcualteTimeRange(hour) {\n    return timeRange.find(d => d.range[0] <= hour && d.range[1] > hour).key\n}\n\nexport default function CarTrack() {\n    const svgRef = useRef(null)\n\n    const [width, height] = [1000,600]\n    const [top, right, bottom, left] = [40, 20, 20, 60]\n    const graphHeight = height - top - bottom\n    const graphWidth = width - left - right\n\n    const timeScale = scaleTime(\n        [new Date('2020-01-01 00:00:00'), new Date('2020-01-01 23:59:59')]\n    , [0, graphWidth])\n\n    const timeScaleObj = useMemo(() => {\n        return timeRange.reduce((obj, d) => {\n            obj[d.key] = {\n                ...d,\n                data: [],\n                scale: scaleOrdinal([0,1], [1,10]),\n            }\n            return obj\n        }, {})\n    }, [])\n\n    const [stopArr, setstopArr] = useState([])\n\n    const stopLocation = useMemo(() => {\n        const useData = chain(stopArr)\n        .map('data')\n        .flatten()\n        .reduce((obj, d) => {\n            const key = `${d.range}-${d.location}`\n            const dataArr = obj[key] ? obj[key].data : []\n            dataArr.push(d)\n            const [st, et] = extent(\n                chain(dataArr)\n                    .map('st')\n                    .map(d1 => new Date(`2020-01-01 ${d1.split(' ')[1]}`).getTime())\n                    .value()\n            ).map(d1 => moment(d1).format('MM/DD/YYYY HH:mm:ss'))\n            obj[key] = {\n                key,\n                data: dataArr,\n                range: d.range,\n                st,\n                et,\n                location: d.location,\n                count: dataArr.length,\n            }\n            return obj\n        }, {})\n        .values()\n        .value()\n        return useData\n    }, [stopArr])\n\n    const calCarColor = useMemo(() => {\n        return scaleOrdinal(stopArr.map(d => d.id), schemeCategory10)\n    }, [stopArr])\n\n    const carTrack = useMemo(() => {\n        const useData = chain(stopArr)\n            .map('data')\n            .flatten()\n            .reduce((obj, d) => {\n                const dataArr = obj[d.id] ? obj[d.id].data : []\n                dataArr.push(d)\n                obj[d.id] = {\n                    id: d.id,\n                    data: dataArr,\n                }\n                return obj\n            }, {})\n            .values()\n            .map(car => {\n                const { data, id } = car\n                const trackArr = chain(data)\n                    .reduce((obj, d) => {\n                        const key = d.day\n                        if(!obj[key])obj[key] = []\n                        obj[key].push(d)\n                        return obj\n                    }, {})\n                    .values()\n                    .reduce((obj, d) => {\n                        d.forEach((stopItem, i) => {\n                            if (i === 0) return\n                            const source = d[i-1].location\n                            const sourceRange = d[i-1].range\n                            const target = stopItem.location\n                            const targetRange = stopItem.range\n                            const key = `${source}-${sourceRange}-${target}-${targetRange}`\n                            obj[key] = {\n                                key,\n                                source,\n                                target,\n                                sourceRange,\n                                targetRange,\n                                count: obj[key] ? obj[key].count + 1 : 1,\n                            }\n                        })\n                        return obj\n                    }, {})\n                    .values()\n                    .value()\n                return {\n                    id,\n                    track: trackArr,\n                }\n            })\n            .value()\n\n        console.log(useData)\n        return useData\n    }, [stopArr])\n\n    const pathWidthScale = useMemo(() => {\n        const domain = extent(chain(carTrack).map('track').flatten().map('count').value())\n        return scaleLinear(domain, [1,5])\n    }, [carTrack])\n    const heightScale = useMemo(() => scaleLinear(), [])\n\n    function drawParall(gps) {\n        // 每辆车 每天的停留事件\n        let unknowCount = 0\n        const useStopArr = chain(gps)\n            .filter(d => ['1','2', '3'].includes(d.id))\n            .map('stopArr')\n            .flatten()\n            // .filter(d => d.st.split(' ')[0] === '01/06/2014')\n            .reduce((obj, d) => {\n                const {id, st, long, lat} = d\n                const [day, time] = st.split(' ')\n                const hour = findHour(st)\n                const key = `${id}-${day}`\n                let location = findLocaiton([long, lat]) \n                if (!location) {\n                    const item = {\n                        name: `unknow_${unknowCount}`,\n                        desc: '',\n                        range: [[Number(long) - 0.001, Number(lat) + 0.001], [Number(long) + 0.001, Number(lat) - 0.001]],\n                        type: 'unknow',\n                    }\n                    building_coordinate.push(item)\n                    location = findLocaiton([long, lat])\n                    unknowCount += 1\n                }\n                const range = calcualteTimeRange(hour)\n\n                const dataItem = {\n                    ...d,\n                    location,\n                    hour,\n                    day,\n                    time,\n                    range,\n                }\n\n                timeScaleObj[range].data.push(dataItem)\n\n                const dataArr = obj[key] ? obj[key].data : []\n                dataArr.push(dataItem)\n                obj[key] = {\n                    data: dataArr,\n                    id: id,\n                    day: day,\n                }\n                return obj\n            }, {})\n            .values()\n            .value()\n\n        const maxValue = chain(useStopArr)\n            .map('data')\n            .flatten()\n            .countBy('range')\n            .values()\n            .maxBy()\n            .value()\n            \n        heightScale.domain([0, maxValue])\n            .range([4, graphHeight/ 2])\n\n        forIn(timeScaleObj, (val, key) => {\n            const countObj = countBy(val.data.map(d => d.location))\n            const countData = chain(countObj)\n                .entries()\n                .map(d => ({\n                    name: d[0],\n                    value: d[1],\n                }))\n                .orderBy('value', 'desc')\n                .value()\n\n            const sum = sumBy(countData, 'value')\n            const domain = []\n            const gap = 20\n            const totalSpace = heightScale(sum) + (countData.length - 1) * gap\n            const topItem = (graphHeight - totalSpace) / 2\n            const range = countData.map((d, i) => {\n                domain.push(d.name)\n                const valuePrv = sumBy(countData.slice(0, i), 'value')\n                return topItem + heightScale(sum) * valuePrv / sum + i * gap\n            })\n            timeScaleObj[key].scale = scaleOrdinal(domain, range)\n            domain.forEach(store => {\n                const value = countObj[store]\n                const idArr = chain(val.data)\n                    .filter(d1 => d1.location === store)\n                    .map('id')\n                    .uniq()\n                    .sortBy()\n                    .value()\n                timeScaleObj[key][`${store}Scale`] = scaleLinear([1, value], [0, heightScale(value)])\n                // console.log(idArr)\n                timeScaleObj[key][`${store}CarIdScale`] = scaleBand(idArr, [0, heightScale(value)])\n            })\n        })\n        \n        setstopArr(useStopArr)\n        select('.timeAxisBottom').call(axisBottom().scale(timeScale))\n        select('.timeAxisTop').call(axisTop().scale(timeScale))\n    }\n\n\n    useEffect(() => {\n        json('./data/gpswithstop.json').then(gps => {\n            console.log(gps)\n            drawParall(gps)\n        })\n    }, [])\n\n    \n    const obj = {}\n\n    const createLine = line()\n        // .curve(curveBasis)\n        .curve(curveStep)\n\n    return (\n        <div>\n            <svg ref={svgRef} height={height} width={width} style={{\n                background: '#e9e9e9'\n            }}>\n                <g className=\"bg\" transform={`translate(${left}, ${top})`}>\n                    <g className='timeAxisTop' transform={`translate(${0}, ${0})`}/>\n                    <g className='timeAxisBottom' transform={`translate(${0}, ${height - top - bottom})`}/>\n                    <g>\n                        {[6, 12, 14, 18, 20, 22].map(d => {\n                            const x = timeScale(new Date(`2020-01-01 ${d}:00:00`))\n                            const lineAttr = {\n                                key: d,\n                                x1: x,\n                                x2: x,\n                                y1: 0,\n                                y2: graphHeight,\n                            }\n                            return (\n                                <line {...lineAttr} />\n                            )\n                        })}\n                    </g>\n                    <g className='stop'>\n                        {\n                            stopArr.map(d => {\n                                const { data, id, day } = d\n                                const carColor = calCarColor(id)\n                                return (\n                                    <g className='dayItem' key={`${id}-${day}`}>\n                                        {\n                                            data.map(d1 => {\n                                                const {st, et, location, range } = d1\n                                                const x1 = timeScale(new Date(`2020-01-01 ${st.split(' ')[1]}`))\n                                                // const x1 = timeScale(new Date(`2020-01-01 ${hour}:00:00`))\n                                                let x2 = timeScale(new Date(`2020-01-01 ${et.split(' ')[1]}`))\n                                                if(x2 < x1) x2 = timeScale(new Date(`2020-01-01 23:59:59`))\n                                                const { scale } = timeScaleObj[range]\n                                                let y = scale(location)\n                                                const storeKey = `${range}-${location}`\n                                                if(!obj[storeKey]) {\n                                                    obj[storeKey] = 1\n                                                } else {\n                                                    obj[storeKey] = obj[storeKey] + 1\n                                                }\n                                                if(timeScaleObj[range][`${location}Scale`]) {\n                                                    y += timeScaleObj[range][`${location}Scale`](obj[storeKey])\n                                                    // y += timeScaleObj[range][`${location}Scale`](d1.id)\n                                                }\n                                                const lineAttr = {\n                                                    key: `${location}-${et}-${st}`,\n                                                    x1: x1,\n                                                    y1: y,\n                                                    x2: x2,\n                                                    y2: y,\n                                                    stroke: carColor,\n                                                    onMouseEnter: () => {\n                                                        console.log(d1)\n                                                    }\n                                                }\n                                                const circleAttr = {\n                                                    key: `${location}-${et}-${st}`,\n                                                    cx: x1,\n                                                    cy: y,\n                                                    stroke: carColor,\n                                                    fill: carColor,\n                                                    fillOpacity: .4,\n                                                    r: 0,\n                                                    onMouseEnter: () => {\n                                                        console.log(d1)\n                                                    }\n                                                }\n                                                return (\n                                                    <circle {...circleAttr} />\n                                                )\n                                            })\n                                        }\n                                    </g>\n                                )\n                            })\n                        }\n                    </g>\n                    <g className=\"car\">\n                        {carTrack.map((d, i) => {\n                                const { id, track } = d\n                                const carColor = calCarColor(id)\n                                return (\n                                    <g className='trackItem' key={`${id}-track`}>\n                                        {\n                                            track.map(d1 => {\n                                                const { source, sourceRange, target, targetRange } = d1\n                                                const { scale: sourceScale } = timeScaleObj[sourceRange]\n                                                let sourceY = sourceScale(source)\n                                                const { scale: targetScale } = timeScaleObj[targetRange]\n                                                if (timeScaleObj[sourceRange][`${source}CarIdScale`]) {\n                                                    sourceY += timeScaleObj[sourceRange][`${source}CarIdScale`](id)\n                                                    sourceY += timeScaleObj[sourceRange][`${source}CarIdScale`].bandwidth() / 2\n                                                }\n                                                let targetY = targetScale(target)\n                                                if (timeScaleObj[targetRange][`${target}CarIdScale`]) {\n                                                    targetY += timeScaleObj[targetRange][`${target}CarIdScale`](id)\n                                                    targetY += timeScaleObj[targetRange][`${target}CarIdScale`].bandwidth() / 2\n                                                }\n\n                                                const sourStop = stopLocation.find(\n                                                    d2=> d2.location === source && d2.range === sourceRange\n                                                )\n                                                let sourceX = timeScale(\n                                                    new Date(`2020-01-01 ${sourStop.et.split(' ')[1]}`)\n                                                )\n                                                let targetX = timeScale(\n                                                    new Date(`2020-01-01 ${stopLocation.find(\n                                                        d2=> d2.location === target && d2.range === targetRange\n                                                    ).st.split(' ')[1]}`)\n                                                )\n\n                                                if(sourStop.st === sourStop.et) {\n                                                    sourceX = sourceX + 10\n                                                }\n\n                                                const pathArr = [\n                                                    [sourceX, sourceY],\n                                                    [targetX, targetY]\n                                                ]\n\n                                                const pathAttr = {\n                                                    fill: 'none',\n                                                    stroke: carColor,\n                                                    strokeWidth: pathWidthScale(d1.count),\n                                                    strokeOpacity: pathWidthScale(d1.count) / 5,\n                                                }\n                                                return (\n                                                    <g key={d1.key} stroke={carColor}>\n                                                        <path d={createLine(pathArr)} {...pathAttr} />\n                                                        <line {...{\n                                                            x1: pathArr[0][0],\n                                                            y1: pathArr[0][1] - 3,\n                                                            x2: pathArr[0][0],\n                                                            y2: pathArr[0][1] + 3,\n                                                            strokeWidth: 2,\n                                                        }} />\n                                                        <path d={\n                                                            line()([\n                                                                [\n                                                                    pathArr[1][0] - 2,\n                                                                    pathArr[1][1] - 2\n                                                                ],\n                                                                [\n                                                                    pathArr[1][0] + 2,\n                                                                    pathArr[1][1]\n                                                                ],\n                                                                [\n                                                                    pathArr[1][0] - 2,\n                                                                    pathArr[1][1] + 2\n                                                                ],\n                                                                [\n                                                                    pathArr[1][0] - 2,\n                                                                    pathArr[1][1] - 2\n                                                                ],\n                                                            ])\n                                                        }\n                                                        fill='#fff'\n                                                        />\n                                                        {/* {pathArr.map(d2 => {\n                                                            const [cx, cy] = d2\n                                                            const circleAttr = {\n                                                                key: `${d1.key}-${cx}`,\n                                                                stroke: carColor,\n                                                                cx,\n                                                                cy,\n                                                                r: 3,\n                                                                fill: '#fff'\n                                                            }\n                                                            return <circle {...circleAttr} />\n                                                        })} */}\n                                                    </g>\n                                                )\n                                            })\n                                        }\n                                    </g>\n                                )\n                            })}\n                    </g>\n                    <g>\n                        {stopLocation.map(d => {\n                            const { st,et, range, location, key, count } = d\n                            const { scale } = timeScaleObj[range]\n                            const sx = timeScale(new Date(`2020-01-01 ${st.split(' ')[1]}`))\n                            let ex = timeScale(new Date(`2020-01-01 ${et.split(' ')[1]}`))\n                            if(ex < sx) ex = timeScale(new Date(`2020-01-01 23:59:59`))\n                            const y = scale(location)\n                            const rectheight = heightScale(count)\n                            const color = calcualteStoreColor(location)\n                            const rectAttr = {\n                                x: 0,\n                                y: 0,\n                                width: ex - sx || 10,\n                                height: rectheight,\n                                fill: color,\n                                // stroke: color,\n                                fillOpacity: .2,\n                            }\n                            const gAttr = {\n                                key,\n                                transform: `translate(${sx}, ${y})`,\n                                fontSize: 9,\n                                onMouseEnter: () => {console.log(d)}\n                            }\n                            return (\n                                <g {...gAttr}>\n                                    <rect {...rectAttr} />\n                                    <text dx={rectAttr.width / 2}\n                                    style={{\n                                        textAnchor: 'middle',\n                                        fontSize: 6,\n                                    }}>{d.location}</text>\n                                </g>\n                            )\n                        })}\n                    </g>\n                </g>\n            </svg>\n        </div>\n    )\n}\n","import { json } from 'd3-fetch'\nimport { chain, countBy, max } from 'lodash'\nimport React, { useEffect, useRef } from 'react'\nimport './index.scss'\nimport moment from 'moment'\nimport { forceCenter, forceLink, forceManyBody, forceSimulation } from 'd3-force'\nimport { select } from 'd3-selection'\nimport CarTrack from '../components/carTrack'\nimport { findLocaiton } from '../utils'\n\n\nexport default function Cal() {\n\n    function calNode() {\n        return json('./data/gpswithstop.json').then(res => {\n            console.log(res)\n            const nodeData = res.map(d => ({\n                id: d.id,\n                data: d.stopArr.map(d1 => ({\n                    ...d1,\n                    location: findLocaiton([d1.long, d1.lat]),\n                })),\n            }))\n            console.log(nodeData)\n            const linksObj = {}\n            nodeData.forEach((d1) => {\n                nodeData.forEach(d2 => {\n                    if (d1.id === d2.id) return\n                    if (linksObj[`${d1.id}-${d2.id}`] || linksObj[`${d2.id}-${d1.id}`]) return\n                    // const sameLoaction = intersection(d1.location, d2.location)\n                    const sameLoaction = d1.data\n                        .filter(d3 => {\n                            if (!d3.location) return false\n                            const st1 = moment(d3.st).unix()\n                            const et1 = moment(d3.et).unix()\n                            const a = d2.data.filter(d4 => {\n                                const st2 = moment(d4.st).unix()\n                                const et2 = moment(d4.et).unix()\n                                // return (st1 < et2 && et1 > st2 ) && d3.location === d4.location\n                                return Math.abs(st1 - st2) < 3600 && d3.location === d4.location\n                            })\n                            return a.length\n                        })\n                    // const sameLoaction = []\n                    linksObj[`${d1.id}-${d2.id}`] = {\n                        source: d1.id,\n                        target: d2.id,\n                        d1: d1.id,\n                        d2: d2.id,\n                        value: sameLoaction.length,\n                        data: countBy(sameLoaction, 'location')\n                    }\n                })\n            })\n            const nodes = nodeData\n            const links = chain(linksObj).values().filter(d => d.value > 10).value()\n\n            console.log(chain(linksObj).values().orderBy('value', 'desc')\n            .map(d => ({\n                sourceId: d.d1,\n                targetId: d.d2,\n                value: d.value,\n                data: d.data,\n            })).value()\n            )\n\n            console.log(linksObj)\n            return [nodes, links]\n        })\n        // carAssign.reduce(d => {\n            \n        // })\n    }\n    const svgRef = useRef(null)\n\n    const [width, height] = [1000,600]\n    const [top, right, bottom, left] = [40, 20, 20, 60]\n \n    useEffect(() => {\n        // calNode()\n        // .then(res => {\n        //     const [nodes, links] = res\n        //     console.log(nodes, links)\n        //     const value = max(links, d => d.value)\n        //     // console.log(value)\n        //     // console.log(links)\n        //     const force = forceSimulation(nodes)\n        //         .force('links', forceLink(links)\n        //             .id(d => d.id)\n        //             // .strength(d => 0.01 * d.value)\n        //             .distance(100)\n        //         )\n        //         .force('charge', forceManyBody())\n        //         .force('center', forceCenter(width / 2, height / 2))\n        //     const svg = select(svgRef.current)\n        //     const link = svg.append('g')\n        //         .selectAll('g')\n        //         .data(links)\n        //         .enter()\n        //         .append('line')\n        //         // .attr(\"stroke-width\", d => d.value)\n        //         .attr(\"stroke-width\", d => 1)\n        //         .attr(\"stroke\", '#e9e9e9');\n            \n        //     const node = svg.append('g')\n        //         .selectAll('g')\n        //         .data(nodes)\n        //         .enter()\n        //         .append('circle')\n        //         .attr('r', 5)\n        //         .attr('fill', 'red')\n            \n        //     force.on('tick', () => {\n        //         link\n        //             .attr(\"x1\", d => d.source.x)\n        //             .attr(\"y1\", d => d.source.y)\n        //             .attr(\"x2\", d => d.target.x)\n        //             .attr(\"y2\", d => d.target.y);\n\n        //         node\n        //             .attr(\"cx\", d => d.x)\n        //             .attr(\"cy\", d => d.y);\n        //     })\n        // })\n    }, [])\n    return (\n        <div>\n            <CarTrack />\n            <svg ref={svgRef}/>\n        </div>\n    )\n}\n","import { json } from 'd3-fetch'\nimport { geoEquirectangular, geoPath } from 'd3-geo'\nimport { scaleLinear, scaleOrdinal, scalePoint, scaleTime } from 'd3-scale'\nimport { line, schemeCategory10, brush, extent, easeLinear, axisTop, axisBottom, brushX, path } from 'd3'\nimport { select, selectAll, event } from 'd3-selection'\nimport { chain } from 'lodash'\nimport React, { useEffect, useMemo, useRef, useState } from 'react'\nimport './index.scss'\nimport moment from 'moment'\nimport { carAssign, dayStr, storeMapType } from '../data/consumer_data'\nimport { building_coordinate } from '../data/buliding_coordinate'\nimport { calcualteTypeColor, calHourTime, findLocaiton } from '../utils'\n\nfunction pushOrPop(arr, d) {\n    const newArr = [...arr]\n    if (newArr.includes(d)) {\n        return newArr.filter(d1 => d1 !== d)\n    }\n    newArr.push(d)\n    return newArr\n}\n\nexport default function SecondQ() {\n    const [ width, height ] = [1000, 600]\n    const mapRef = useRef(null)\n    const trackRef = useRef(null)\n\n    const [map, setmap] = useState([])\n    const [allTrack, setAllTrack] = useState([])\n\n    const projection = useMemo(() => geoEquirectangular(), [])\n    const colorScale = useMemo(() => \n        scaleOrdinal()\n            .domain(allTrack.map(d => d.id))\n            .range(schemeCategory10)\n    ,[allTrack])\n\n\n    const [selectCar, setSelectCard] = useState([])\n    const [selectDay, setSelectDay] = useState(dayStr)\n    const [selectHour, setSelectHour] = useState(['00:00:00', '23:59:59'].map(d => calHourTime(d)))\n\n    const carArr = useMemo(() =>{\n        const res = chain(allTrack)\n            .map('id')\n            .uniq()\n            .map(d => {\n                const info = carAssign.find(d1 => d1.CarID === d)\n                if (info) {\n                    return {\n                        id: d,\n                        name: `${info.FirstName} ${info.LastName}`,\n                        type: info.CurrentEmploymentType,\n                        title: info.CurrentEmploymentTitle,\n                    }\n                }\n                return {\n                    id: d,\n                }\n            })\n            .value()\n        // setSelectCard(res.map(d => d.id))\n        return res\n    } ,[allTrack])\n\n    useEffect(() => {\n        json('./data/map.json').then(res => {\n            projection.fitSize([width, height], res)\n            window.projection = projection\n            setmap(res.features)\n            json('./data/gpswithstop.json').then(res => {\n                // calStopArr(projection)\n                setAllTrack(res)\n            })\n        })\n    }, [])\n\n    const brushRef = useRef(null)\n    useEffect(() => {\n        select(brushRef.current)\n            .call(\n                brush()\n                .extent([[0,0], [width, height]])\n                .on('end', e => {\n                    const {selection} = event\n                    if(!selection) {\n                        return \n                    }\n                    const arr = []\n                    console.log(selection.map(d => projection.invert(d)))\n                    selectAll('.stopDot')\n                        .filter(function () {\n                            return selection[0][0] <= select(this).attr('cx')\n                            && selection[1][0] >= select(this).attr('cx')\n                            && selection[0][1] <= select(this).attr('cy')\n                            && selection[1][1] >= select(this).attr('cy')\n                        })\n                        .each(function (){\n                            arr.push(JSON.parse(select(this).attr('data')))\n                        })\n\n                    console.log(arr)\n                })\n            )\n    }, [])\n\n    const showTrack = useMemo(() => {\n        return allTrack.filter(d => selectCar.includes(d.id))\n    }, [selectCar, allTrack])\n\n    const stopArr = useMemo(() => {\n        return chain(showTrack)\n            .map(d => d.stopArr)\n            .flatten()\n            .filter(d1 => selectDay.includes(d1.st.split(' ')[0]))\n            .filter(d1 => {\n                const hour = d1.st.split(' ')[1]\n                const thisTime = calHourTime(hour)\n                return thisTime >= selectHour[0] && thisTime <= selectHour[1]\n            })\n            .value()\n    }, [selectDay, selectHour, showTrack])\n\n    const stopCircleRScale = useMemo(() => {\n        const domain = showTrack.length ? extent(\n            chain(showTrack).map('stopArr').flatten().value(),\n            d => d.gap\n        ) : [0, 0]\n        return scaleLinear()\n            .domain(domain)\n            .range([5, 5])\n    }, [showTrack])\n\n\n    const [tooltip, setTooltip] = useState({\n        style: {\n            display: 'none',\n        },\n        content: {\n            \n        },\n    })\n\n    function mouseenter(e, content) {\n        setTooltip({\n            style: {\n                display: 'block',\n                left: e.clientX + 10,\n                top: e.clientY + 10,\n            },\n            content,\n        })\n    }\n    \n\n    function play() {\n        selectAll('.trackItem')\n            .each(function(){\n                const path = select(this).select('.path')\n                const length = path.node().getTotalLength()\n                path\n                    .attr(\"stroke-dasharray\", length + \" \" + length)\n                    .attr(\"stroke-dashoffset\", length)\n                    .transition()\n                    .ease(easeLinear)\n                    .attr(\"stroke-dashoffset\", 0)\n                    .duration(10000)\n\n                const arrow = select(this).select('.arrow')\n                arrow\n                    .attr(\"stroke-width\", 10)\n                    .attr(\"stroke-dasharray\", function() {\n                    return [10, length - 10];\n                    })\n                    .attr(\"stroke-dashoffset\", length)\n                    .transition()\n                    .ease(easeLinear)\n                    .attr(\"stroke-dashoffset\", 10 + .5)\n                    .duration(10000)\n                // .on(\"end\", () => setTimeout(repeat, 1000));\n            })\n    }\n\n    return (\n        <div className='second-graph'>\n            <div>\n            <img src='./data/bg.jpeg' className='realMap' alt='map' />\n            </div>\n            \n            <div className='tooltip' style={tooltip.style}>\n                {Object.entries(tooltip.content).map(d => {\n                    const [key, value] = d\n                    return (\n                        <div className='tooltip-item' key={key}>\n                            <span className='tooltips-label'>{key}: </span>\n                            <span className='tooltips-value'>{value}</span>\n                        </div>\n                    )\n                })}\n            </div>\n            <div className='mapcontainer'>\n                <svg height={height} width={width} className='mapSvg'>\n                    <g className=\"bg\">\n                        <g className=\"map\" ref={mapRef}>\n                            {map.map((d, i) => (\n                                <path key={i} className='map-item' d={geoPath(projection)(d)}/>\n                            ))}\n                        </g>\n                        <g ref={brushRef} />\n                        <g className=\"track\" ref={trackRef}>\n                            {showTrack\n                                .map(d => {\n                                    const { id, data } = d\n                                    const geoArr = data\n                                        .filter(d1 => selectDay.includes(d1.Timestamp.split(' ')[0]))\n                                        .filter(d1 => {\n                                            const hour = d1.Timestamp.split(' ')[1]\n                                            const thisTime = calHourTime(hour)\n                                            return thisTime >= selectHour[0] && thisTime <= selectHour[1]\n                                        })\n                                        .map(d1 => projection([d1.long, d1.lat]))\n\n                                    const attr = {\n                                        stroke: colorScale(id),\n                                        d: line()(geoArr),\n                                        className: 'path'\n                                    }\n                                    const attr2 = {\n                                        strokeWidth: 10,\n                                        className: 'arrow',\n                                        d: line()(geoArr),\n                                        strokeDasharray: [10, 100000 - 10],\n                                    }\n                                    return (\n                                        <g className={`trackItem trackItem-${id}`} key={id}>\n                                            <path {...attr} />\n                                            <path {...attr2} />\n                                        </g>\n                                    )\n                                }\n                            )}\n                        </g>\n                        <g className=\"stop\">\n                            {stopArr.map((d,i) => {\n                                const { id, long, lat, gap } = d\n                                const [cx, cy] = projection([long, lat])\n                                const keyItem = `${long}_${lat}_${id}`\n                                const className = `stopitem_${keyItem}`\n                                const attr = {\n                                    cx, cy,\n                                    r: stopCircleRScale(gap),\n                                    key: keyItem,\n                                    fill: colorScale(id),\n                                    stroke: colorScale(id),\n                                    // fill: 'red',\n                                    className: `stopDot ${className}`,\n                                    data: JSON.stringify(d),\n                                }\n                                return (\n                                    <circle {...attr}/>\n                                )\n                            })}\n                        </g>\n                        <g className='store'>\n                            {building_coordinate.map(d => {\n                                const {range, name} = d\n                                const cpname = name.replace(/'|\\.|\\s/g, '')\n                                const [x1, y1] = projection(range[0])\n                                const [x2, y2] = projection(range[1])\n                                const rectAttr = {\n                                    x: x1,\n                                    y: y1,\n                                    height: y2 - y1,\n                                    width: x2 - x1,\n                                    fill: calcualteTypeColor(d.classify),\n                                    stroke: calcualteTypeColor(d.classify),\n                                    fillOpacity: .3,\n                                    onMouseEnter: () => {\n                                        select(`.${cpname}_label`).attr('display', null)\n                                    },\n                                    onMouseOut: () => {\n                                        select(`.${cpname}_label`).attr('display', 'none')\n                                    }\n                                }\n                                const textAttr = {\n                                    x: x1 + (x2 - x1) / 2,\n                                    y: y1 - 10,\n                                    textAnchor: 'middle',\n                                    fontSize: '12px',\n                                    fontWeight: 'bolder',\n                                    display: 'none',\n                                    className: `${cpname}_label`,\n                                    TextEvent: 'none',\n                                }\n\n                                const gAttr = {\n                                    key: `store-${name}`,\n                                }\n                                return (\n                                    <g {...gAttr}>\n                                        <rect {...rectAttr} />\n                                        <text {...textAttr}>{name}</text>\n                                    </g>\n                                )\n                            })}\n                        </g>\n                    </g>\n                </svg>\n                <div className=\"carlist\">\n                    <table>\n                        <thead>\n                            <th>Color</th>\n                            <th>CarID</th>\n                            <th>Staff</th>\n                        </thead>\n                        <tbody>\n                            {\n                                carArr.map(d => (\n                                    <tr\n                                        key={d.id}\n                                        className={`${selectCar.includes(d.id) ? 'active' : 0}`}\n                                        onClick={() => {\n                                            const newSelectCar = pushOrPop(selectCar, d.id)\n                                            setSelectCard(newSelectCar)\n                                        }}\n                                    >\n                                        <td><div className='color-legend' style={{\n                                            background: colorScale(d.id)\n                                        }}/></td>\n                                        <td>{d.id}</td>\n                                        <td>{d.name}</td>\n                                    </tr>\n                                ))\n                            }\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n            <div className='second'>\n                <SplitTrack\n                    GasData={allTrack.filter(d => selectCar.includes(d.id))}\n                    selectDay = {selectDay}\n                    selectDayCB = {d => {setSelectDay(d)}}\n                    brushCB = {hourArr => setSelectHour(hourArr.map(d => calHourTime(d)))}\n                    playCB = {play}\n                />\n                {/* <FirstQ /> */}\n            </div>\n        </div>\n    )\n}\n\n\nfunction SplitTrack({ \n    GasData, selectDay, selectDayCB,\n    brushCB,\n    playCB,\n }) {\n    const [width, height] = [1000, 500]\n    const [top, right, bottom, left] = [20,100,20,20]\n    const realHeight = height - top - bottom\n    const realWidth = width - left - right\n\n    const topRef = useRef(null)\n    const bottomRef = useRef(null)\n    const brushRef = useRef(null)\n\n    const xScale = scaleTime()\n        .domain([new Date('2020-01-01 00:00:00'), new Date('2020-01-01 23:59:59')])\n        .range([0, realWidth])\n        \n    const topAxis = axisTop().scale(xScale)\n    const bottomAxis = axisBottom().scale(xScale)\n\n    useEffect(() => {\n        select(topRef.current).call(topAxis)\n        select(bottomRef.current).call(bottomAxis)\n        select(brushRef.current).call(\n            brushX()\n            .extent([[0,0], [realWidth, realHeight]])\n            .on('end', () => {\n                const { selection } = event\n                if (selection) {\n                    const timeArr = selection.map(d => xScale.invert(d)).map(d => moment(d).format('HH:mm:ss'))\n                    brushCB(timeArr)\n                    console.log(timeArr)\n                } else {\n                    brushCB(['00:00:00', '23:59:59'])\n                }\n            })\n        )\n    }, [])\n\n    const axisPosScale = scalePoint()\n        .domain(dayStr)\n        .range([realHeight / dayStr.length, realHeight])\n        .align(1)\n\n    const gpsArr = useMemo(() => {\n        // console.log(GasData)\n       const result = chain(GasData)\n        .cloneDeep()\n        .forEach(trackItem => {\n            const { data, stopArr } = trackItem\n            trackItem.day = chain(dayStr)\n                .reduce((obj, day) => {\n                    obj[day] = {\n                        track: data.filter(d => d.Timestamp.split(' ')[0] === day),\n                        stopDot: stopArr.filter(d => d.st.split(' ')[0] === day),\n                    }\n                    return obj\n                }, {})\n                .value()\n        })\n        .value()\n        // console.log(result[0].day['01/09/2014'])\n        return result\n    }, [GasData])\n\n    const gap = axisPosScale.step()\n\n    const xItem = useMemo(() => {\n        return scalePoint()\n            .domain(GasData.map(d => d.id))\n            .range([0, gap])\n            .align(0)\n    }, [GasData])\n\n    return (\n        <div className='explain'>\n            <div className='toolbox'>\n                <button onClick={() => {\n                    playCB()\n                    select('.scaleplate')\n                        .attr(\"x1\", 0)\n                        .attr(\"x2\", 0)\n                        .transition()\n                        .ease(easeLinear)\n                        .attr(\"x1\", realWidth)\n                        .attr(\"x2\", realWidth)\n                        .duration(10000)\n                    select('.scaleplate')\n                        .transition()\n                        .attr(\"x1\", 0)\n                        .attr(\"x2\", 0)\n                        .delay(10000)\n\n                }}>\n                    play\n                </button>\n                <input type='checkbox' id='checkall' onChange={e => {\n                    const val = e.target.checked\n                    if (val) {\n                        selectDayCB(dayStr)\n                    } else {\n                        selectDayCB([])\n                    }\n\n                }}/>\n                <label htmlFor=\"checkall\">全选</label>\n            </div>\n            <svg width={width} height={height} className='timeScale'>\n                <g className=\"bg\" transform={`translate(${left}, ${top})`}>\n                    {/* 坐标 */}\n                    <g ref={topRef} />\n                    <g ref={bottomRef} transform={`translate(0, ${realHeight})`}  />\n                    {/* time split */}\n                    <line className='scaleplate' x1={0} y1={0} x2={0} y2={realHeight} />\n                    {/* brush */}\n                    <g className=\"brush\" ref={brushRef} />\n                    {/* day */}\n                    {dayStr.map(d => {\n                        const className = selectDay.includes(d) ? '' : 'disabled'\n                        return (\n                            <g transform={`translate(${0}, ${axisPosScale(d)})`} className={`dayItem ${className}`} key={d}>\n                                <line  x1={0} y1={0} x2={realWidth} y2={0}/>\n                                <text onClick={() => {\n                                    const newDay = pushOrPop(selectDay, d)\n                                    selectDayCB(d)\n                                }} transform={`translate(${realWidth + 10}, ${-gap / 2})`}>{d}</text>\n                            </g>\n                        )\n                    })}\n                    {/* gps */}\n                    {\n                        gpsArr.map((carItem, index) => {\n                            const { day, id } = carItem\n                            return Object.entries(day)\n                                .map(dayitem => {\n                                    const [dayName, data] = dayitem\n                                    const { stopDot } = data\n                                    const pathFun = path()\n                                    \n                                    stopDot.forEach((d, i) => {\n                                        const x1 = xScale(new Date(`2020-01-01 ${d.st.split(' ')[1]}`))\n                                        const x2 = xScale(new Date(`2020-01-01 ${d.et.split(' ')[1]}`))\n                                        if (i === 0) pathFun.moveTo(x1, 0)\n                                        pathFun.lineTo(x1, 0)\n                                        pathFun.lineTo(x1, -10)\n                                        if (d.et.split(' ')[0] === dayName) {\n                                            pathFun.lineTo(x2, -10)\n                                            pathFun.lineTo(x2, -0)\n                                        }\n                                    })\n                                    console.log(xItem(id))\n                                    const y2 = gap / (gpsArr.length + 1) * (index + 1)\n                                    return (\n                                        <g transform={`translate(${0}, ${axisPosScale(dayName) - gap + y2})`} key={`${dayName}-${id}`}>\n                                                {\n                                                    stopDot.map(stopItem => {\n                                                        const location = findLocaiton([stopItem.long, stopItem.lat])\n                                                        const sx = xScale(new Date(`2020-01-01 ${stopItem.st.split(' ')[1]}`))\n                                                        let ex = xScale(new Date(`2020-01-01 ${stopItem.et.split(' ')[1]}`))\n                                                        if(ex < sx) ex = xScale(new Date(`2020-01-01 23:59:59`))\n                                                        \n                                                        const locationType = location ? storeMapType[location] : 'location'\n\n                                                        const rectAttr = {\n                                                            x1: 0,\n                                                            y1: 0,\n                                                            x2: ex-sx,\n                                                            y2: 0,\n                                                            // width: ex-sx,\n                                                            strokeWidth: 2,\n                                                            fill: calcualteTypeColor(locationType),\n                                                            stroke: calcualteTypeColor(locationType),\n                                                            className: 'stopItem',\n                                                            fillOpacity: .2,\n                                                            rx: 5,\n                                                            ry: 5,\n                                                        }\n                                                        const textAttr = {\n                                                            fontSize: 6,\n                                                            x: (ex-sx)/2,\n                                                            y: -6,\n                                                            textAnchor: 'middle',\n                                                            className: 'stopItemLabel'\n                                                        }\n                                                        return (\n                                                            <g transform={`translate(${sx}, ${0})`}  key={`${dayName}-${id}-${sx}`}>\n                                                                <text {...textAttr}>{location ? location.split(' ').map(d => d[0]).join('-') : ''}</text>\n                                                                <line {...rectAttr}>\n                                                                    <title>\n                                                                        {\n                                                                            `时间: ${stopItem.st.split(' ')[1]}--${stopItem.et.split(' ')[1]}\\n地点: ${location}\\n汽车: ${id}\\n消费: ...`\n                                                                        }\n                                                                    </title>\n                                                                </line>\n                                                            </g>\n                                                        )\n                                                    })\n                                                }\n                                        </g>\n                                    )\n                                })\n                        })\n                    }\n                </g>\n            </svg>\n        </div>\n    )\n}","import { HashRouter as Router, Link, Redirect, Route, Switch } from 'react-router-dom';\nimport './App.css';\nimport ConsumerGraph from './components/consumerGraph';\nimport Cal from './dataCal';\nimport SecondQ from './secondQ';\n\nfunction Content({children}) {\n  return <div>\n    {children}\n  </div>\n}\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Router>\n        {/* <ConsusePage /> */}\n        <div className='nav'>\n            <Link to=\"/first\">first Q</Link>\n            <Link to=\"/map\">map</Link>\n            <Link to=\"/cal\">cal</Link>\n        </div>\n        <Content>\n          <Switch>\n            <Route path=\"/first\">\n              <ConsumerGraph />\n            </Route>\n            <Route path=\"/map\">\n              <SecondQ />\n            </Route>\n            <Route path=\"/cal\">\n              <Cal />\n            </Route>\n            <Redirect from='/' to='/first' />\n          </Switch>\n        </Content>\n      </Router>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}