(this["webpackJsonpvast-2020"]=this["webpackJsonpvast-2020"]||[]).push([[0],{181:function(e,t,n){},182:function(e,t,n){},183:function(e,t,n){},185:function(e,t,n){},186:function(e,t,n){},191:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),c=n(121),i=n.n(c),s=(n(181),n(42)),o=n(9),l=(n(182),n(6)),u=n(8),m=n(5),d=n(193),j=n(74),p=n(4),b=n(116),f=n(119),O=n(117),y=n(7),h=n(13),g=n.n(h),v=[1388937600,1389024e3,1389110400,1389196800,1389283200,1389369600,1389456e3,1389542400,1389628800,1389715200,1389801600,1389888e3,1389974400,1390060800],x=["01/06/2014","01/07/2014","01/08/2014","01/09/2014","01/10/2014","01/11/2014","01/12/2014","01/13/2014","01/14/2014","01/15/2014","01/16/2014","01/17/2014","01/18/2014","01/19/2014"],C=[{type:"FastFood",data:["Brew've Been Served","Hallowed Grounds","Coffee Cameleon","Coffee Shack","Bean There Done That","Jack's Magical Beans","Brewed Awakenings"]},{type:"Restaurant",data:["Katerinas Caf","Gelatogalore","Ouzeri Elian","Kalami Kafenion","Hippokampos","Abila Zacharo","Guy's Gyros"]},{type:"Industry",data:["Abila Airport","Nationwide Refinery","Maximum Iron and Steel","Carlyle Chemical Inc.","Abila Scrapyard","Octavio's Office Supplies","Chostus Hotel","Kronos Pipe and Irrigation","Stewart and Sons Fabrication"]},{type:"Gas Station",data:["Frank's Fuel","U-Pump"]},{type:"Living",data:["Albert's Fine Clothing","Kronos Mart","Daily Dealz","Shoppers' Delight","Frydos Autosupply n' More","General Grocer"]},{type:"Entertainment",data:["Desafio Golf Course","Roberts and Sons","Ahaggo Museum"]}],N=Object(y.chain)(C).map("data").flatten().reduce((function(e,t){return e[t]=C.find((function(e){return e.data.includes(t)})).type,e}),{}).value(),T=[{data:[-2,6],name:"Sleeping"},{data:[6,9],name:"On the way to work"},{data:[9,12],name:"Working"},{data:[12,14],name:"Lunch Break"},{data:[14,18],name:"Working"},{data:[18,22],name:"After work"}],E={L8328:"8129",L6417:"7117",L1107:"2681",L4034:"5407",L6110:"8411",L2343:"8202",L9018:"2418",L5777:"9551",L7783:"1415",L3191:"9635",L4164:"7688",L1682:"7253",L1485:"3853",L5947:"2540",L3014:"1877",L4149:"1321",L6544:"7108",L4424:"1874",L5259:"7819",L3800:"7384",L5553:"9617",L3366:"6895",L8148:"6816",L4063:"9220",L2490:"3484",L2769:"8642",L2169:"4434",L9633:"9735",L9637:"2142",L8012:"1310",L7814:"3492",L3259:"9405",L9363:"6901",L5224:"8156",L7291:"9683",L9254:"7354",L6886:"2463",L7761:"3506",L5756:"7792",L8477:"4530",L3317:"2276",L5485:"9152",L5924:"9614",L2459:"5010",L2247:"5368",L9406:"4948",L9362:"3547",L3295:"5921",L6267:["6691","6899"],L6119:"7889",L2070:"8332",L8566:"4795",L3572:"1286",L3288:"9241"},k=[{LastName:"Calixto",FirstName:"Nils",CarID:"1",CurrentEmploymentType:"Information Technology",CurrentEmploymentTitle:"IT Helpdesk"},{LastName:"Azada",FirstName:"Lars",CarID:"2",CurrentEmploymentType:"Engineering",CurrentEmploymentTitle:"Engineer"},{LastName:"Balas",FirstName:"Felix",CarID:"3",CurrentEmploymentType:"Engineering",CurrentEmploymentTitle:"Engineer"},{LastName:"Barranco",FirstName:"Ingrid",CarID:"4",CurrentEmploymentType:"Executive",CurrentEmploymentTitle:"SVP/CFO"},{LastName:"Baza",FirstName:"Isak",CarID:"5",CurrentEmploymentType:"Information Technology",CurrentEmploymentTitle:"IT Technician"},{LastName:"Bergen",FirstName:"Linnea",CarID:"6",CurrentEmploymentType:"Information Technology",CurrentEmploymentTitle:"IT Group Manager"},{LastName:"Orilla",FirstName:"Elsa",CarID:"7",CurrentEmploymentType:"Engineering",CurrentEmploymentTitle:"Drill Technician"},{LastName:"Alcazar",FirstName:"Lucas",CarID:"8",CurrentEmploymentType:"Information Technology",CurrentEmploymentTitle:"IT Technician"},{LastName:"Cazar",FirstName:"Gustav",CarID:"9",CurrentEmploymentType:"Engineering",CurrentEmploymentTitle:"Drill Technician"},{LastName:"Campo-Corrente",FirstName:"Ada",CarID:"10",CurrentEmploymentType:"Executive",CurrentEmploymentTitle:"SVP/CIO"},{LastName:"Calzas",FirstName:"Axel",CarID:"11",CurrentEmploymentType:"Engineering",CurrentEmploymentTitle:"Hydraulic Technician"},{LastName:"Cocinaro",FirstName:"Hideki",CarID:"12",CurrentEmploymentType:"Security",CurrentEmploymentTitle:"Site Control"},{LastName:"Ferro",FirstName:"Inga",CarID:"13",CurrentEmploymentType:"Security",CurrentEmploymentTitle:"Site Control"},{LastName:"Dedos",FirstName:"Lidelse",CarID:"14",CurrentEmploymentType:"Engineering",CurrentEmploymentTitle:"Engineering Group Manager"},{LastName:"Bodrogi",FirstName:"Loreto",CarID:"15",CurrentEmploymentType:"Security",CurrentEmploymentTitle:"Site Control"},{LastName:"Vann",FirstName:"Isia",CarID:"16",CurrentEmploymentType:"Security",CurrentEmploymentTitle:"Perimeter Control"},{LastName:"Flecha",FirstName:"Sven",CarID:"17",CurrentEmploymentType:"Information Technology",CurrentEmploymentTitle:"IT Technician"},{LastName:"Frente",FirstName:"Birgitta",CarID:"18",CurrentEmploymentType:"Engineering",CurrentEmploymentTitle:"Geologist"},{LastName:"Frente",FirstName:"Vira",CarID:"19",CurrentEmploymentType:"Engineering",CurrentEmploymentTitle:"Hydraulic Technician"},{LastName:"Fusil",FirstName:"Stenig",CarID:"20",CurrentEmploymentType:"Security",CurrentEmploymentTitle:"Building Control"},{LastName:"Osvaldo",FirstName:"Hennie",CarID:"21",CurrentEmploymentType:"Security",CurrentEmploymentTitle:"Perimeter Control"},{LastName:"Nubarron",FirstName:"Adra",CarID:"22",CurrentEmploymentType:"Security",CurrentEmploymentTitle:"Badging Office"},{LastName:"Lagos",FirstName:"Varja",CarID:"23",CurrentEmploymentType:"Security",CurrentEmploymentTitle:"Badging Office"},{LastName:"Mies",FirstName:"Minke",CarID:"24",CurrentEmploymentType:"Security",CurrentEmploymentTitle:"Perimeter Control"},{LastName:"Herrero",FirstName:"Kanon",CarID:"25",CurrentEmploymentType:"Engineering",CurrentEmploymentTitle:"Geologist"},{LastName:"Onda",FirstName:"Marin",CarID:"26",CurrentEmploymentType:"Engineering",CurrentEmploymentTitle:"Drill Site Manager"},{LastName:"Orilla",FirstName:"Kare",CarID:"27",CurrentEmploymentType:"Engineering",CurrentEmploymentTitle:"Drill Technician"},{LastName:"Borrasca",FirstName:"Isande",CarID:"28",CurrentEmploymentType:"Engineering",CurrentEmploymentTitle:"Drill Technician"},{LastName:"Ovan",FirstName:"Bertrand",CarID:"29",CurrentEmploymentType:"Facilities",CurrentEmploymentTitle:"Facilities Group Manager"},{LastName:"Resumir",FirstName:"Felix",CarID:"30",CurrentEmploymentType:"Security",CurrentEmploymentTitle:"Security Group Manager"},{LastName:"Sanjorge Jr.",FirstName:"Sten",CarID:"31",CurrentEmploymentType:"Executive",CurrentEmploymentTitle:"President/CEO"},{LastName:"Strum",FirstName:"Orhan",CarID:"32",CurrentEmploymentType:"Executive",CurrentEmploymentTitle:"SVP/COO"},{LastName:"Tempestad",FirstName:"Brand",CarID:"33",CurrentEmploymentType:"Engineering",CurrentEmploymentTitle:"Drill Technician"},{LastName:"Vann",FirstName:"Edvard",CarID:"34",CurrentEmploymentType:"Security",CurrentEmploymentTitle:"Perimeter Control"},{LastName:"Vasco-Pais",FirstName:"Willem",CarID:"35",CurrentEmploymentType:"Executive",CurrentEmploymentTitle:"Environmental Safety Advisor"},{LastName:"Hafon",FirstName:"Albina",CarID:"",CurrentEmploymentType:"Facilities",CurrentEmploymentTitle:"Truck Driver"},{LastName:"Hawelon",FirstName:"Benito",CarID:"",CurrentEmploymentType:"Facilities",CurrentEmploymentTitle:"Truck Driver"},{LastName:"Hawelon",FirstName:"Claudio",CarID:"",CurrentEmploymentType:"Facilities",CurrentEmploymentTitle:"Truck Driver"},{LastName:"Mies",FirstName:"Henk",CarID:"",CurrentEmploymentType:"Facilities",CurrentEmploymentTitle:"Truck Driver"},{LastName:"Morlun",FirstName:"Valeria",CarID:"",CurrentEmploymentType:"Facilities",CurrentEmploymentTitle:"Truck Driver"},{LastName:"Morlun",FirstName:"Adan",CarID:"",CurrentEmploymentType:"Facilities",CurrentEmploymentTitle:"Truck Driver"},{LastName:"Morluniau",FirstName:"Cecilia",CarID:"",CurrentEmploymentType:"Facilities",CurrentEmploymentTitle:"Truck Driver"},{LastName:"Nant",FirstName:"Irene",CarID:"",CurrentEmploymentType:"Facilities",CurrentEmploymentTitle:"Truck Driver"},{LastName:"Scozzese",FirstName:"Dylan",CarID:"",CurrentEmploymentType:"Facilities",CurrentEmploymentTitle:"Truck Driver"}],D={"Brew've Been Served":[{s:"7:30",e:"8:30",d:1}],"Hallowed Grounds":[{s:"7:30",e:"8:30",d:2}],"Coffee Cameleon":[{s:"7:30",e:"8:30",d:3}],"Coffee Shack":[{s:"11:45",e:"12:15",d:1}],"Bean There Done That":[{s:"11:45",e:"12:15",d:2}],"Jack's Magical Beans":[{s:"11:45",e:"12:15",d:3}],"Brewed Awakenings":[{s:"11:45",e:"12:15",d:4}],"Katerinas Caf":[{s:"13:00",e:"14:30",d:1},{s:"18:50",e:"21:30",d:1}],Gelatogalore:[{s:"13:00",e:"14:20",d:5}],"Ouzeri Elian":[{s:"13:00",e:"14:20",d:3},{s:"19:00",e:"21:30",d:3}],"Kalami Kafenion":[{s:"13:10",e:"14:20",d:4},{s:"19:00",e:"20:30",d:4}],Hippokampos:[{s:"13:00",e:"14:00",d:2},{s:"19:10",e:"22:30",d:2}],"Abila Zacharo":[{s:"13:00",e:"14:30",d:7}],"Guy's Gyros":[{s:"13:30",e:"14:30",d:6},{s:"19:0",e:"21:40",d:6}],"Abila Airport":[{s:"8:26",e:"9:40",d:1},{s:"12:20",e:"13:10",d:1},{s:"15:20",e:"16:10",d:1}],"Nationwide Refinery":[{s:"10:00",e:"13:00",d:5}],"Maximum Iron and Steel":[{s:"10:10",e:"10:50",d:1},{s:"14:50",e:"15:20",d:1}],"Carlyle Chemical Inc.":[{s:"9:40",e:"10:10",d:1},{s:"12:30",e:"13:00",d:2},{s:"14:30",e:"14:50",d:1},{s:"16:20",e:"17:20",d:1}],"Abila Scrapyard":[{s:"14:10",e:"14:30",d:2}],"Octavio's Office Supplies":[{s:"14:30",e:"16:00",d:3}],"Chostus Hotel":[{s:"12:10",e:"14:00",d:8}],"Frank's Fuel":[{s:"12:10",e:"12:40",d:6},{s:"18:10",e:"18:50",d:1}],"Kronos Pipe and Irrigation":[{s:"14:00",e:"14:20",d:8}],"Stewart and Sons Fabrication":[{s:"10:20",e:"12:20",d:7}],"Albert's Fine Clothing":[{s:"15:20",e:"16:20",d:2},{s:"19:00",e:"21:20",d:5}],"Kronos Mart":[{s:"3:10",e:"4:00",d:1},{s:"7:30",e:"8:40",d:4}],"Daily Dealz":[{s:"5:50",e:"6:20",d:1}],"Shoppers' Delight":[{s:"15:10",e:"16:10",d:7},{s:"19:20",e:"21:30",d:7}],"Ahaggo Museum":[{s:"15:00",e:"17:00",d:8}],"Desafio Golf Course":[{s:"13:00",e:"15:40",d:9}],"Roberts and Sons":[{s:"19:10",e:"21:30",d:8}],"U-Pump":[{s:"13:10",e:"13:30",d:6},{s:"17:25",e:"17:55",d:1}],"General Grocer":[{s:"15:20",e:"16:00",d:5},{s:"20:30",e:"21:40",d:4}],"Frydos Autosupply n' More":[{s:"15:30",e:"16:20",d:4},{s:"19:00",e:"21:40",d:9}]},L=n(63),S=n(19),I=n(120),F=[{name:"Hallowed Grounds",desc:"",type:"Consumer sites",range:[[24.88388038,36.06553341],[24.88788038,36.06253341]]},{name:"Bean There Done That",desc:"",range:[[24.84912302000002,36.084489514999994],[24.853505705000018,36.07924747999999]],type:"Consumer sites"},{name:"Kronos Mart",desc:"",range:[[24.846974645000017,36.06807593],[24.851529200000016,36.064896335]],type:"Consumer sites"},{name:"Ouzeri Elian",desc:"",range:[[24.870177095000017,36.0544982],[24.87447384500002,36.05002958]],type:"Consumer sites"},{name:"Coffee Cameleon",desc:"",range:[[24.888910925000015,36.05656064],[24.893121740000016,36.05329511]],type:"Consumer sites"},{name:"Abila Airport",desc:"",range:[[24.824030000000022,36.054756005],[24.83417033000002,36.04727966]],type:"Consumer sites"},{name:"Abila Scrapyard",desc:"",range:[[24.84370911500002,36.076067885],[24.849294890000017,36.072630485]],type:"Consumer sites"},{name:"Chostus Hotel",desc:"",range:[[24.890543690000012,36.07220081],[24.898707515000016,36.067474385]],type:"Consumer sites"},{name:"Hippokampos",desc:"\u5728Albert's Fine Clothing\u4e0a\u65b9\uff0c\u5df2\u9a8c\u8bc1,6",range:[[24.85565408000002,36.07770065],[24.859950830000017,36.07598195]],type:"Consumer sites"},{name:"Abila Zacharo",desc:"\u5728Roberts and Sons\u5de6\u8fb9\uff0c\u5df2\u9a8c\u8bc1,6\u30017",range:[[24.84981050000002,36.064380725],[24.85178700500002,36.061802675]],type:"Consumer sites"},{name:"Roberts and Sons",desc:"\u5df2\u9a8c\u8bc1, 7\u53f7",range:[[24.851529200000016,36.06412292],[24.853763510000018,36.061974545]],type:"Consumer sites"},{name:"Albert's Fine Clothing",desc:"\u5df2\u9a8c\u8bc1, 7\u53f7",range:[[24.85479473000002,36.07598195],[24.857458715000018,36.074349185]],type:"Consumer sites"},{name:"Gelatogalore",desc:"\u51b0\u6dc7\u6dcb\u5e97\uff0c\u6709\u4e9b\u504f\u5dee\uff0c\u5e94\u8be5\u5728\u6742\u8d27\u5e97\u7684\u4e0b\u9762\uff0c\u5df2\u9a8c\u8bc1",range:[[24.85702904000002,36.059998039999996],[24.858919610000015,36.05913869]],type:"Consumer sites"},{name:"Kalami Kafenion",desc:"\u5728Kronos Mart\u7684\u53f3\u8fb9\u4e00\u70b9\uff0c7\u53f7\u5f97\u5230\u7684\uff0c12\u53f7\u9a8c\u8bc1",range:[[24.85161513500002,36.067474385],[24.853763510000018,36.065240075]],type:"Consumer sites"},{name:"Frydos Autosupply n' More",desc:"\u6839\u636e7\u53f7\u548c8\u53f7\uff0c\u4fee\u8f66\u5382\u5e94\u8be5\u5728 Brew'veBeenServed \u548c Katerinas Caf \u4e2d\u95f4",range:[[24.900512150000015,36.055443485000005],[24.903605810000016,36.054412264999996]],type:"Consumer sites"},{name:"Katerinas Caf",desc:"\u6bd4\u539f\u6765\u7684\u5c0f\u4e00\u70b9",range:[[24.897590360000017,36.055787224999996],[24.900426215000014,36.05329511]],type:"Consumer sites"},{name:"Guy's Gyros",desc:"\u5728Brew'veBeenServed\u5de6\u4e0b\u89d2\uff0c12\u548c8\u8f66\u9a8c\u8bc1",range:[[24.901801175000017,36.05690438],[24.903176135000013,36.05518568]],type:"Consumer sites"},{name:"General Grocer",desc:"\u6742\u8d27\u5e97, 12\u53f7\u8f66\u9a8c\u8bc1",range:[[24.85565408000002,36.061287065],[24.85728684500002,36.059912105]],type:"Consumer sites"},{name:"Shoppers' Delight",desc:"\u5728Ouzeri Elian \u7684\u5de6\u8fb9 13\u53f7\u8f66\u9a8c\u8bc1",range:[[24.867341240000016,36.05432633],[24.870005225000018,36.051490475]],type:"Consumer sites"},{name:"Brew've Been Served",desc:"\u975e\u5e38\u7684\u5c0f\uff0c 13\u53f7\u8f66\u9a8c\u8bc1",range:[[24.900598085000013,36.054584135],[24.901887110000015,36.053381045]],type:"Consumer sites"},{name:"Frank's Fuel",desc:"\u6bd4\u56fe\u6807\u9760\u53f3\u4e00\u70b9\uff0c15\u53f7\u8f66\u9a8c\u8bc1",range:[[24.83872488500002,36.073489835],[24.84224822000002,36.07116959]],type:"Consumer sites"},{name:"Brewed Awakenings",desc:"\u6839\u636e16\u53f7\u8f66\u5f97\u5230\u7684\uff0c\u8fd9\u4e2a\u5730\u65b9\u6bd4\u8f83\u504f\uff0c\u6240\u4ee5\u5e97\u7684\u6d88\u8d39\u8f83\u5c11",range:[[24.86287262000002,36.07443512],[24.865364735000018,36.07271642]],type:"Consumer sites"},{name:"Ahaggo Museum",desc:"\u535a\u7269\u9986",range:[[24.875419130000015,36.077958455],[24.879887750000016,36.073919509999996]],type:"Consumer sites"},{name:"Octavio's Office Supplies",desc:"\u6587\u5177\u5e97\uff0c20\u53f7\u8f6614\u53f7\u8def\u8fc7\u7684",range:[[24.85728684500002,36.05896682],[24.85874774000002,36.0579356]],type:"Consumer sites"},{name:"U-Pump",desc:"23\u53f7\u8f666\u53f7\u4e0b\u5348",range:[[24.869059940000017,36.069279019999996],[24.871895795000015,36.066615035]],type:"Consumer sites"},{name:"Desafio Golf Course",desc:"31\u53f7\u8f66",range:[[24.85763058500002,36.091536184999995],[24.86390384000002,36.088184719999994]],type:"Consumer sites"},{name:"Jack's Magical Beans",desc:"\u7f29\u5c0f\u4e00\u4e0b",range:[[24.872325470000018,36.069021215],[24.876106610000015,36.066271295]],type:"Consumer sites"},{name:"Maximum Iron and Steel",desc:"\u94a2\u94c1\u5382",range:[[24.83674838000002,36.06601349],[24.84319350500002,36.06240422]],type:"Consumer sites"},{name:"Carlyle Chemical Inc.",desc:"\u5316\u5de5\u5382",range:[[24.879715880000017,36.059654300000005],[24.882981410000017,36.05741999]],type:"Consumer sites"},{name:"Nationwide Refinery",desc:"\u70bc\u6cb9\u5382",range:[[24.884442305000015,36.059482429999996],[24.888996860000013,36.05656064]],type:"Consumer sites"},{name:"Kronos Pipe and Irrigation",desc:"\u704c\u6e89\u8bbe\u5907\u5382, 101\u8f666\u53f7\u548c13\u53f7",range:[[24.83167821500002,36.066443164999995],[24.83434220000002,36.064380725]],type:"Consumer sites"},{name:"Stewart and Sons Fabrication",desc:"\u73bb\u7483\u5382\uff1f\u4e0d\u77e5\u9053\uff0c101\u8f66\u4e03\u53f7",range:[[24.907301015000012,36.05501381],[24.909363455000012,36.05295137]],type:"Consumer sites"},{name:"Coffee Shack",desc:"\u6d88\u8d39\u573a\u6240\uff0c\u6ca1\u627e\u5230\uff0c\u65e0\u6240\u8c13\uff0c\u5c316417\u4e00\u4e2a\u5361\u53bb\uff0c\u8fd9\u4e2a\u6570\u636e\u7684\u65f6\u95f4\u4e5f\u662f\u9519\u8bef\u7684",range:[[24.858575870000017,36.07495073],[24.861841400000017,36.071255525]],type:"Consumer sites"},{name:"carly's coffee",range:[[24.85754465000002,36.058709015],[24.861153920000017,36.055271614999995]],type:"Other Building"},{name:"Cup o'Joe",range:[[24.877825310000016,36.053552915],[24.880833035000016,36.050717060000004]],type:"Other Building"},{name:"Abila Hospital",range:[[24.876708155000017,36.057677795000004],[24.883840760000016,36.053209175]],type:"Other Building"},{name:"GAStect",range:[[24.877309700000016,36.050974865],[24.881950190000016,36.046162505]],type:"Other Building"},{name:"kronos capitol",range:[[24.84456846500002,36.058537145],[24.850841720000016,36.05209202]],type:"Other Building"}].map((function(e){return Object(l.a)(Object(l.a)({},e),{},{classify:N[e.name]||"location"})}));function M(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"single",a=Object(L.a)(e);return"single"!==n?a.includes(t)?a.filter((function(e){return e!==t})):(a.push(t),a):a.includes(t)?[]:[t]}function w(e,t){return parseFloat((Number(e)+Number(t)).toFixed(10))}function A(e){var t=e.toString();switch(t.match(/:/g)?t.match(/:/g).length:0){case 0:t="".concat(t,":00:00");break;case 1:t="".concat(t,":00")}return g()("2020-01-01 ".concat(t)).unix()}var B=function(e){var t=C.map((function(e){return e.type})),n=Object(S.c)(t.sort(m.a),I.a);return t.includes(e)?n(e):"gray"},R=function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1],r=F.find((function(e){var t=Object(u.a)(e.range,2),r=t[0],c=t[1];return r[0]<Number(n)&&Number(n)<c[0]&&Number(a)<r[1]&&Number(a)>c[1]}));return!!r&&r.name},G=(n(183),n(1));function P(){var e=Object(a.useRef)(null),t=Object(a.useState)({width:300,height:300}),n=Object(u.a)(t,2),r=n[0],c=n[1],i=Object(a.useMemo)((function(){return r.width}),[r]),s=Object(a.useMemo)((function(){return r.height}),[r]),o=Object(a.useMemo)((function(){var e=Math.min(i/2,s/2),t=Math.max(e/4,120),n=(e-t)/3;return[[0,t],[t,2.5*n],[4*n,4*n+1],[2.5*n+10,4*n-10]]}),[i,s]);Object(a.useEffect)((function(){var t=e.current,n=t.clientWidth,a=t.clientHeight;c({width:n,height:a})}),[]);var h=Object(a.useState)(!0),x=Object(u.a)(h,2),k=x[0],L=x[1],S=Object(a.useState)("mulitiple"),I=Object(u.a)(S,2),F=I[0],B=I[1],R=Object(a.useState)("intersection"),P=Object(u.a)(R,2),H=P[0],K=P[1],z=Object(p.r)().domain([0,24]).range([0,360]),W=Object(p.r)().domain(Object(m.d)(v)).range([o[1][0],o[1][1]]),q=Object(p.r)().domain([A("00:00:00"),A("23:59:59")]).range([0,2*Math.PI]),J=Object(b.a)().innerRadius((function(e){return W(e.day)})).outerRadius((function(e){return W(e.day)+(o[1][1]-o[1][0])/v.length})).startAngle((function(e){return q(e.time)})).endAngle((function(e){return q(e.time+500)})),_=Object(a.useState)([]),V=Object(u.a)(_,2),Y=V[0],U=V[1],Z=Object(a.useState)([]),Q=Object(u.a)(Z,2),X=Q[0],$=Q[1],ee=Object(a.useState)([]),te=Object(u.a)(ee,2),ne=te[0],ae=te[1],re=Object(a.useState)([]),ce=Object(u.a)(re,2),ie=ce[0],se=ce[1],oe=Object(a.useMemo)((function(){return Y.filter((function(e){return!X.length||X.includes(e.location)})).filter((function(e){return!ie.length||ie.includes(e.id)}))}),[X,Y,ie]),le=Object(a.useState)([]),ue=Object(u.a)(le,2),me=ue[0],de=ue[1];Object(a.useEffect)((function(){Object(d.a)("./data/merge_cc_and_loy.json").then((function(e){var t=e.map((function(e){var t=e.timestamp.split(" "),n=Object(u.a)(t,2),a=n[0],r=n[1],c=g()(a).unix(),i=A(r),s=C.find((function(t){return t.data.includes(e.location)})).type;return Object(l.a)(Object(l.a)({},e),{},{day:c,dayStr:a,id:e.loyaltynum,time:i,locationType:s,hour:r.split(":")[0]})})),n=Object(y.chain)(t).map("id").uniq().value();de(n),U(t);var a=function(e){var t=Object.keys(E).map((function(t){var n=e.filter((function(e){return e.loyaltynum===t})),a=Object(y.chain)(n).map("location").uniq().value(),r=Object(y.chain)(a).map((function(e){return N[e]})).sortBy().uniq().value();return{id:t,data:n,location:a,type:r,arcData:Object(y.chain)(n).reduce((function(e,t){return e[t.locationType]={value:e[t.locationType]?w(e[t.locationType].value,t.price):Number(t.price),type:t.locationType},e}),{}).values().value()}})),n={};return t.forEach((function(e){var a=e.type.toString();t.forEach((function(t){if(e.id!==t.id&&!n["".concat(e.id,"-").concat(t.id)]&&!n["".concat(t.id,"-").concat(e.id)]){var r=t.type.toString();a===r&&(n["".concat(e.id,"-").concat(t.id)]={source:e.id,target:t.id,value:1})}}))})),[t,Object(y.chain)(n).values().filter((function(e){return e.value>0})).value()]}(e),r=Object(u.a)(a,2),c=r[0],i=r[1];je(c,i)}))}),[]);var je=Object(a.useMemo)((function(){return function(e,t){var n=o[0][1]-20,a=Object(p.n)(e).force("links",Object(p.l)(t).id((function(e){return e.id})).strength((function(e){return 2}))).force("charge",Object(p.m)().strength(-4)).force("collide",Object(p.k)().radius(10)).force("circle",(function(){e.forEach((function(e,t){if(function(e,t){var n=Object(u.a)(e,2),a=n[0],r=n[1],c=Object(u.a)(t,2),i=c[0],s=c[1];return Math.sqrt(Math.pow(a-i,2)+Math.pow(r-s,2))}([e.x,e.y],[0,0])>n){var a=Math.atan(e.y/e.x);e.x=n*Math.cos(a)*(e.x<0?-1:1),e.y=n*Math.sin(a)*(e.x<0?-1:1)}}))}));Object(p.w)(".custom-item").each((function(){var t=Object(p.v)(this).attr("id"),n=e.filter((function(e){return e.id===t}));Object(p.v)(this).data(n)})).call(Object(p.g)().on("start",(function(e){var t=Math.max(a.alpha(),.1);a.alpha(t).restart(),e.fx=null,e.fy=null})).on("drag",(function(e){e.x=p.i.x,e.y=p.i.y})).on("end",(function(e){e.fx=p.i.x,e.fy=p.i.y}))),Object(p.v)(".links").selectAll("line").remove();var r=Object(p.v)(".links").selectAll("line").data(t).enter().append("line").attr("stroke-width",(function(e){return 1})).attr("stroke","#e9e9e9");a.on("tick",(function(){r.attr("x1",(function(e){return e.source.x})).attr("y1",(function(e){return e.source.y})).attr("x2",(function(e){return e.target.x})).attr("y2",(function(e){return e.target.y})),Object(p.w)(".custom-item").attr("transform",(function(e){return"translate(".concat(e.x,", ").concat(e.y,")")}))}))}}),[]),pe=Object(a.useMemo)((function(){return Object(y.chain)(oe).map("id").uniq().value()}),[oe]),be=Object(a.useMemo)((function(){var e=Object(m.d)(oe,(function(e){return Number(e.price)}));return Object(p.r)().domain(e).range([.2,1])}),[oe]),fe=Object(a.useMemo)((function(){return oe.reduce((function(e,t){var n=e[t.location]||0;return e[t.location]=w(n,t.price),e}),{})}),[oe]),Oe=Object(a.useMemo)((function(){var e=Object(m.d)(Object.values(fe));return Object(p.r)().domain(e).range([.2,1])}),[fe]),ye=Object(b.a)().innerRadius((function(e){return e.inner})).outerRadius((function(e){return e.outer})).startAngle((function(e){return q(A(e.s))})).endAngle((function(e){return q(A(e.e))})).padAngle(.01).cornerRadius(4),he=Object(b.a)().innerRadius((function(e){return o[2][0]})).outerRadius((function(e){return o[2][1]})).startAngle((function(e){return e[0]<0?q(g()("2019-12-31 ".concat(22,":00:00")).unix()):q(A(e[0]))})).endAngle((function(e){return q(A(e[1]))})).padAngle(.1).cornerRadius(4),ge=function(e){if(!e.innerRadius||!e.outerRadius)return"";var t=[e.startAngle,e.endAngle].map((function(e){return e-Math.PI/2})),n=Math.max(0,(e.outerRadius+e.innerRadius)/2),a=(t[1]+t[0])/2,r=a>0&&a<Math.PI;r&&t.reverse();var c=Object(j.a)();return c.arc(0,0,n,t[0],t[1],r),c.toString()},ve=Object(p.s)(C.map((function(e){return e.type})).sort(m.a),p.u),xe=Object(a.useMemo)((function(){return me.reduce((function(e,t){var n=Object(y.chain)(oe).filter((function(e){return e.id===t})).filter((function(e){return"cash"!==e.type})).reduce((function(e,t){var n=t.dayStr;return e[n]||(e[n]=[]),e[n].push(J.centroid(t)),e}),{}).values().value();return e[t]=n,e}),{})}),[me,oe,J]),Ce=Object(a.useMemo)((function(){return Object(y.chain)(oe).map((function(e){return e.dayStr.replace("/2014","")})).uniq().value()}),[oe]),Ne=Object(f.a)().x((function(e){return e[0]})).y((function(e){return e[1]})).curve(O.a.alpha(.5)),Te=["01/11","01/12","01/18","01/19"];return Object(G.jsxs)("div",{className:"consumerGraph",children:[Object(G.jsx)("div",{className:"left",ref:e,children:Object(G.jsx)("svg",{height:s,width:i,className:"main",children:Object(G.jsxs)("g",{transform:"translate(".concat(0,", ").concat(0,")"),children:[Object(G.jsx)("g",{className:"timebg",children:v.map((function(e,t){var n=g()(1e3*e).format("MM/DD"),a=Ce.includes(n)?1:0;return Object(G.jsxs)("g",{children:[Object(G.jsxs)("text",{opacity:a,transform:"translate(".concat(i/2,", ").concat(s/2-W(e),")"),children:[n," ",Te.includes(n)?"weekend":""]}),Object(G.jsx)("circle",{cx:i/2,cy:s/2,r:W(e)})]},e)}))}),Object(G.jsx)("g",{className:"timeTick",children:[6,9,12,14,18,22].map((function(e,t){var n={x1:i/2,y1:s/2-o[2][0],x2:i/2,y2:s/2};return Object(G.jsxs)("g",{className:"timeSplit",transform:"rotate(".concat(z(e),")"),children:[Object(G.jsx)("line",Object(l.a)({},n)),Object(G.jsx)("text",{x:n.x1,y:n.y1,dy:0,children:"".concat(e,":00")})]},e)}))}),Object(G.jsx)("g",{className:"time-classify",transform:"translate(".concat(i/2,", ").concat(s/2,")"),children:T.map((function(e,t){var n={d:he(e.data)},a={fill:"none",id:"time-".concat(t),d:ge({innerRadius:o[2][1]+10,outerRadius:o[2][1]+10,startAngle:e.data[0]<0?q(g()("2019-12-31 ".concat(22,":00:00")).unix()):q(A(e.data[0])),endAngle:q(A(e.data[1]))})},r={href:"#time-".concat(t),startOffset:"50%",dominantBaseline:"middle"};return Object(G.jsxs)("g",{children:[Object(G.jsx)("path",Object(l.a)(Object(l.a)({},n),{},{className:"time-button"})),Object(G.jsxs)("g",{className:"time-label",children:[Object(G.jsx)("path",Object(l.a)({},a)),Object(G.jsx)("text",{children:Object(G.jsx)("textPath",Object(l.a)(Object(l.a)({},r),{},{children:e.name}))})]})]},e.data[0])}))}),Object(G.jsx)("g",{className:"consume-g",transform:"translate(".concat(i/2,", ").concat(s/2,")"),children:oe.filter((function(e){return"cash"!==e.type})).map((function(e,t){var n=C.find((function(t){return t.data.includes(e.location)})).type,a={className:"consume-item",d:J(e),fill:ve(n),fillOpacity:be(e.price)};return Object(G.jsx)("path",Object(l.a)({},a),JSON.stringify(e))}))}),Object(G.jsx)("g",{className:"detail-store",transform:"translate(".concat(i/2,", ").concat(s/2,")"),children:Object.entries(D).map((function(e,t){var n=Object(u.a)(e,2),a=n[0],r=n[1],c=N[a];return Object(G.jsx)("g",{children:r.map((function(e){var t="".concat(a,"-").concat(e.s),n=q(A(e.s)),r=q(A(e.e)),i=(o[3][1]-o[3][0])/9,s=o[3][0]+i*(e.d-1),u=s+i,m={d:ye({inner:s,outer:u,s:e.s,e:e.e}),fill:ve(c),stroke:ve(c),fillOpacity:Oe(fe[a])},d={fill:"none",id:"text-".concat(t),d:ge({innerRadius:(s+u)/2,outerRadius:(s+u)/2,startAngle:n,endAngle:r})},j={href:"#text-".concat(t),startOffset:"50%",dominantBaseline:"middle",textAnchor:"middle"},p=X.includes(a)?"active":"";X.length>0&&!X.includes(a)&&(p="disabled");var b=oe.map((function(e){return e.location})).includes(a)?1:.1,f=(n+r)/2,O=f>Math.PI/2&&f<Math.PI/2*3;O?a.split(" ").reverse():a.split(" ");return Object(G.jsxs)("g",{opacity:b,className:p,onClick:function(){var e=M(X,a),t=Object(y.chain)(e).map((function(e){return N[e]})).uniq().value();$(e),ae(t)},children:[Object(G.jsx)("path",Object(l.a)(Object(l.a)({},m),{},{className:"store-button"})),Object(G.jsxs)("g",{className:"store-label",children:[Object(G.jsx)("path",Object(l.a)({},d)),Object(G.jsx)("text",{children:Object(G.jsx)("textPath",Object(l.a)(Object(l.a)({},j),{},{children:a.split(" ").map((function(e){return e[0]})).join().replace(/,/g,"")}))})]})]},t)}))},a)}))}),Object(G.jsxs)("g",{className:"customer",transform:"translate(".concat(i/2,", ").concat(s/2,")"),children:[Object(G.jsx)("circle",{className:"bg",cx:0,cy:0,r:o[1][0]}),Object(G.jsx)("g",{className:"links"}),Object(G.jsx)("g",{children:me.map((function(e,t){var n=pe.includes(e)?1:.1,a=Y.filter((function(t){return t.id===e})),r=Object(y.chain)(a).reduce((function(e,t){return e[t.locationType]={value:e[t.locationType]?w(e[t.locationType].value,t.price):Number(t.price),type:t.locationType},e}),{}).values().value(),c=a.reduce((function(e,t){return w(e,t.price)}),0),i=Object(p.r)().domain([0,c]).range([0,2*Math.PI]),s=Object(b.a)().innerRadius(0).outerRadius(5).startAngle((function(e){var t=r.findIndex((function(t){return t.type===e.type})),n=Object(y.chain)(r).slice(0,t).map("value").reduce((function(e,t){return w(e,t)}),0).value();return i(n)})).endAngle((function(e){var t=r.findIndex((function(t){return t.type===e.type})),n=Object(y.chain)(r).slice(0,t).map("value").reduce((function(e,t){return w(e,t)}),0).value()+e.value;return i(n)}));return Object(G.jsxs)("g",{opacity:n,id:e,className:"custom-item",transform:"translate(".concat(10*t,", ",0,")"),onClick:function(){var t=M(ie,e,F);se(t)},children:[r.map((function(e){var t={d:s(e),key:"small-".concat(e.type),fill:ve(e.type),stroke:ve(e.type),fillOpacity:.3};return Object(G.jsx)("path",Object(l.a)({},t))})),Object(G.jsx)("text",{dy:-8,children:e})]})}))})]}),Object(G.jsx)("g",{className:"customerTrack",transform:"translate(".concat(i/2,", ").concat(s/2,")"),children:Object.entries(xe).map((function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1],r=ie.includes(n)?1:0;return r&&(r=k?1:0),Object(G.jsx)("g",{opacity:r,children:a.map((function(e){return Object(G.jsx)("path",{d:Ne(e)},e.toString())}))},n)}))})]})})}),Object(G.jsxs)("div",{className:"right",children:[Object(G.jsxs)("div",{className:"condition",children:[Object(G.jsxs)("div",{className:"item",children:["select mode\uff1a",["single","mulitiple"].map((function(e){return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsx)("label",{htmlFor:e,children:e}),Object(G.jsx)("input",{type:"radio",name:"select-mode",checked:F===e,onChange:function(){F!==e&&B(e)},value:e,id:e})]})}))]}),Object(G.jsxs)("div",{className:"item",children:["show customer track\uff1a",Object(G.jsx)("input",{type:"checkbox",name:"track-mode",checked:k,onChange:function(){L(!k)}})]}),Object(G.jsxs)("div",{className:"item",children:["merge method\uff1a",["union","intersection"].map((function(e){return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsx)("label",{htmlFor:e,children:e}),Object(G.jsx)("input",{type:"radio",name:"merge-mode",checked:H===e,onChange:function(){H!==e&&K(e)},value:e,id:e})]})}))]}),Object(G.jsx)("div",{className:"item",children:Object(G.jsx)("button",{onClick:function(){$([]),ae([]),se([])},children:"Refresh"})})]}),Object(G.jsx)("div",{className:"legend",children:C.map((function(e){var t=e.type,n=ve(t),a=Object(p.e)(n);a.opacity=.6,a+="";var r=ne.includes(t)?"active":"";return ne.length>0&&!ne.includes(t)&&(r="disabled"),Object(G.jsxs)("div",{className:"legend-item ".concat(r),onClick:function(){var e=M(ne,t);ae(e);var n=Object(y.chain)(C).filter((function(t){return e.includes(t.type)})).map("data").flatten().value();$(n)},children:[Object(G.jsx)("div",{className:"legend-label",style:{backgroundColor:a,borderColor:n}}),Object(G.jsx)("div",{className:"legend-name",children:t})]})}))})]})]})}n(185),n(72);var H=[{name:"Sleeping.Morning",key:"sm",range:[0,6]},{name:"Breakfast",key:"bf",range:[6,9]},{name:"Working.AM",key:"wa",range:[9,12]},{name:"Lunch",key:"l",range:[12,15]},{name:"Working.PM",key:"wp",range:[15,18]},{name:"Dinner",key:"d",range:[18,20]},{name:"After Dinner",key:"ad",range:[20,22]},{name:"Sleeping.Night",key:"sn",range:[22,24]}];function K(){var e=Object(a.useRef)(null),t=Object(p.t)([new Date("2020-01-01 00:00:00"),new Date("2020-01-01 23:59:59")],[0,920]),n=Object(a.useMemo)((function(){return H.reduce((function(e,t){return e[t.key]=Object(l.a)(Object(l.a)({},t),{},{data:[],scale:Object(p.s)([0,1],[1,10])}),e}),{})}),[]),r=Object(a.useState)([]),c=Object(u.a)(r,2),i=c[0],s=c[1],o=Object(a.useMemo)((function(){return Object(y.chain)(i).map("data").flatten().reduce((function(e,t){var n="".concat(t.range,"-").concat(t.location),a=e[n]?e[n].data:[];a.push(t);var r=Object(p.j)(Object(y.chain)(a).map("st").map((function(e){return new Date("2020-01-01 ".concat(e.split(" ")[1])).getTime()})).value()).map((function(e){return g()(e).format("MM/DD/YYYY HH:mm:ss")})),c=Object(u.a)(r,2),i=c[0],s=c[1];return e[n]={key:n,data:a,range:t.range,st:i,et:s,location:t.location,count:a.length},e}),{}).values().value()}),[i]),m=Object(a.useMemo)((function(){return Object(p.s)(i.map((function(e){return e.id})),p.u)}),[i]),j=Object(a.useMemo)((function(){var e=Object(y.chain)(i).map("data").flatten().reduce((function(e,t){var n=e[t.id]?e[t.id].data:[];return n.push(t),e[t.id]={id:t.id,data:n},e}),{}).values().map((function(e){var t=e.data;return{id:e.id,track:Object(y.chain)(t).reduce((function(e,t){var n=t.day;return e[n]||(e[n]=[]),e[n].push(t),e}),{}).values().reduce((function(e,t){return t.forEach((function(n,a){if(0!==a){var r=t[a-1].location,c=t[a-1].range,i=n.location,s=n.range,o="".concat(r,"-").concat(c,"-").concat(i,"-").concat(s);e[o]={key:o,source:r,target:i,sourceRange:c,targetRange:s,count:e[o]?e[o].count+1:1}}})),e}),{}).values().value()}})).value();return console.log(e),e}),[i]),b=Object(a.useMemo)((function(){var e=Object(p.j)(Object(y.chain)(j).map("track").flatten().map("count").value());return Object(p.r)(e,[1,5])}),[j]),f=Object(a.useMemo)((function(){return Object(p.r)()}),[]);function O(e){var a=0,r=Object(y.chain)(e).filter((function(e){return["1","2","3"].includes(e.id)})).map("stopArr").flatten().reduce((function(e,t){var r=t.id,c=t.st,i=t.long,s=t.lat,o=c.split(" "),m=Object(u.a)(o,2),d=m[0],j=m[1],p=parseInt(c.split(" ")[1].split(":")[0]),b="".concat(r,"-").concat(d),f=R([i,s]);if(!f){var O={name:"unknow_".concat(a),desc:"",range:[[Number(i)-.001,Number(s)+.001],[Number(i)+.001,Number(s)-.001]],type:"unknow"};F.push(O),f=R([i,s]),a+=1}var y=function(e){return H.find((function(t){return t.range[0]<=e&&t.range[1]>e})).key}(p),h=Object(l.a)(Object(l.a)({},t),{},{location:f,hour:p,day:d,time:j,range:y});n[y].data.push(h);var g=e[b]?e[b].data:[];return g.push(h),e[b]={data:g,id:r,day:d},e}),{}).values().value(),c=Object(y.chain)(r).map("data").flatten().countBy("range").values().maxBy().value();f.domain([0,c]).range([4,270]),Object(y.forIn)(n,(function(e,t){var a=Object(y.countBy)(e.data.map((function(e){return e.location}))),r=Object(y.chain)(a).entries().map((function(e){return{name:e[0],value:e[1]}})).orderBy("value","desc").value(),c=Object(y.sumBy)(r,"value"),i=[],s=(540-(f(c)+20*(r.length-1)))/2,o=r.map((function(e,t){i.push(e.name);var n=Object(y.sumBy)(r.slice(0,t),"value");return s+f(c)*n/c+20*t}));n[t].scale=Object(p.s)(i,o),i.forEach((function(r){var c=a[r],i=Object(y.chain)(e.data).filter((function(e){return e.location===r})).map("id").uniq().sortBy().value();n[t]["".concat(r,"Scale")]=Object(p.r)([1,c],[0,f(c)]),n[t]["".concat(r,"CarIdScale")]=Object(p.q)(i,[0,f(c)])}))})),s(r),Object(p.v)(".timeAxisBottom").call(Object(p.a)().scale(t)),Object(p.v)(".timeAxisTop").call(Object(p.b)().scale(t))}Object(a.useEffect)((function(){Object(d.a)("./data/gpswithstop.json").then((function(e){console.log(e),O(e)}))}),[]);var h={},v=Object(p.o)().curve(p.f);return Object(G.jsx)("div",{children:Object(G.jsx)("svg",{ref:e,height:600,width:1e3,style:{background:"#e9e9e9"},children:Object(G.jsxs)("g",{className:"bg",transform:"translate(".concat(60,", ").concat(40,")"),children:[Object(G.jsx)("g",{className:"timeAxisTop",transform:"translate(".concat(0,", ",0,")")}),Object(G.jsx)("g",{className:"timeAxisBottom",transform:"translate(".concat(0,", ",540,")")}),Object(G.jsx)("g",{children:[6,12,14,18,20,22].map((function(e){var n=t(new Date("2020-01-01 ".concat(e,":00:00"))),a={key:e,x1:n,x2:n,y1:0,y2:540};return Object(G.jsx)("line",Object(l.a)({},a))}))}),Object(G.jsx)("g",{className:"stop",children:i.map((function(e){var a=e.data,r=e.id,c=e.day,i=m(r);return Object(G.jsx)("g",{className:"dayItem",children:a.map((function(e){var a=e.st,r=e.et,c=e.location,s=e.range,o=t(new Date("2020-01-01 ".concat(a.split(" ")[1]))),u=t(new Date("2020-01-01 ".concat(r.split(" ")[1])));u<o&&(u=t(new Date("2020-01-01 23:59:59")));var m=(0,n[s].scale)(c),d="".concat(s,"-").concat(c);h[d]?h[d]=h[d]+1:h[d]=1,n[s]["".concat(c,"Scale")]&&(m+=n[s]["".concat(c,"Scale")](h[d]));"".concat(c,"-").concat(r,"-").concat(a);var j={key:"".concat(c,"-").concat(r,"-").concat(a),cx:o,cy:m,stroke:i,fill:i,fillOpacity:.4,r:0,onMouseEnter:function(){console.log(e)}};return Object(G.jsx)("circle",Object(l.a)({},j))}))},"".concat(r,"-").concat(c))}))}),Object(G.jsx)("g",{className:"car",children:j.map((function(e,a){var r=e.id,c=e.track,i=m(r);return Object(G.jsx)("g",{className:"trackItem",children:c.map((function(e){var a=e.source,c=e.sourceRange,s=e.target,u=e.targetRange,m=(0,n[c].scale)(a),d=n[u].scale;n[c]["".concat(a,"CarIdScale")]&&(m+=n[c]["".concat(a,"CarIdScale")](r),m+=n[c]["".concat(a,"CarIdScale")].bandwidth()/2);var j=d(s);n[u]["".concat(s,"CarIdScale")]&&(j+=n[u]["".concat(s,"CarIdScale")](r),j+=n[u]["".concat(s,"CarIdScale")].bandwidth()/2);var f=o.find((function(e){return e.location===a&&e.range===c})),O=t(new Date("2020-01-01 ".concat(f.et.split(" ")[1]))),y=t(new Date("2020-01-01 ".concat(o.find((function(e){return e.location===s&&e.range===u})).st.split(" ")[1])));f.st===f.et&&(O+=10);var h=[[O,m],[y,j]],g={fill:"none",stroke:i,strokeWidth:b(e.count),strokeOpacity:b(e.count)/5};return Object(G.jsxs)("g",{stroke:i,children:[Object(G.jsx)("path",Object(l.a)({d:v(h)},g)),Object(G.jsx)("line",{x1:h[0][0],y1:h[0][1]-3,x2:h[0][0],y2:h[0][1]+3,strokeWidth:2}),Object(G.jsx)("path",{d:Object(p.o)()([[h[1][0]-2,h[1][1]-2],[h[1][0]+2,h[1][1]],[h[1][0]-2,h[1][1]+2],[h[1][0]-2,h[1][1]-2]]),fill:"#fff"})]},e.key)}))},"".concat(r,"-track"))}))}),Object(G.jsx)("g",{children:o.map((function(e){var a=e.st,r=e.et,c=e.range,i=e.location,s=e.key,o=e.count,u=n[c].scale,m=t(new Date("2020-01-01 ".concat(a.split(" ")[1]))),d=t(new Date("2020-01-01 ".concat(r.split(" ")[1])));d<m&&(d=t(new Date("2020-01-01 23:59:59")));var j=u(i),p={x:0,y:0,width:d-m||10,height:f(o),fill:function(e){if(e.includes("unknow"))return"red";var t=N[e]||"location";return B(t)}(i),fillOpacity:.2},b={key:s,transform:"translate(".concat(m,", ").concat(j,")"),fontSize:9,onMouseEnter:function(){console.log(e)}};return Object(G.jsxs)("g",Object(l.a)(Object(l.a)({},b),{},{children:[Object(G.jsx)("rect",Object(l.a)({},p)),Object(G.jsx)("text",{dx:p.width/2,style:{textAnchor:"middle",fontSize:6},children:e.location})]}))}))})]})})})}function z(){var e=Object(a.useRef)(null);return Object(a.useEffect)((function(){}),[]),Object(G.jsxs)("div",{children:[Object(G.jsx)(K,{}),Object(G.jsx)("svg",{ref:e})]})}var W=n(194),q=n(195),J=n(111),_=n(25),V=n(113);n(186);function Y(e,t){var n=Object(L.a)(e);return n.includes(t)?n.filter((function(e){return e!==t})):(n.push(t),n)}function U(){var e=1e3,t=Object(a.useRef)(null),n=Object(a.useRef)(null),r=Object(a.useState)([]),c=Object(u.a)(r,2),i=c[0],s=c[1],o=Object(a.useState)([]),m=Object(u.a)(o,2),j=m[0],b=m[1],f=Object(a.useMemo)((function(){return Object(W.a)()}),[]),O=Object(a.useMemo)((function(){return Object(S.c)().domain(j.map((function(e){return e.id}))).range(p.u)}),[j]),h=Object(a.useState)([]),g=Object(u.a)(h,2),v=g[0],C=g[1],N=Object(a.useState)(x),T=Object(u.a)(N,2),E=T[0],D=T[1],L=Object(a.useState)(["00:00:00","23:59:59"].map((function(e){return A(e)}))),I=Object(u.a)(L,2),M=I[0],w=I[1],R=Object(a.useMemo)((function(){return Object(y.chain)(j).map("id").uniq().map((function(e){var t=k.find((function(t){return t.CarID===e}));return t?{id:e,name:"".concat(t.FirstName," ").concat(t.LastName),type:t.CurrentEmploymentType,title:t.CurrentEmploymentTitle}:{id:e}})).value()}),[j]);Object(a.useEffect)((function(){Object(d.a)("./data/map.json").then((function(t){f.fitSize([e,600],t),window.projection=f,s(t.features),Object(d.a)("./data/gpswithstop.json").then((function(e){b(e)}))}))}),[]);var P=Object(a.useRef)(null);Object(a.useEffect)((function(){Object(J.a)(P.current).call(Object(p.c)().extent([[0,0],[e,600]]).on("end",(function(e){var t=_.c.selection;if(t){var n=[];console.log(t.map((function(e){return f.invert(e)}))),Object(V.a)(".stopDot").filter((function(){return t[0][0]<=Object(J.a)(this).attr("cx")&&t[1][0]>=Object(J.a)(this).attr("cx")&&t[0][1]<=Object(J.a)(this).attr("cy")&&t[1][1]>=Object(J.a)(this).attr("cy")})).each((function(){n.push(JSON.parse(Object(J.a)(this).attr("data")))})),console.log(n)}})))}),[]);var H=Object(a.useMemo)((function(){return j.filter((function(e){return v.includes(e.id)}))}),[v,j]),K=Object(a.useMemo)((function(){return Object(y.chain)(H).map((function(e){return e.stopArr})).flatten().filter((function(e){return E.includes(e.st.split(" ")[0])})).filter((function(e){var t=A(e.st.split(" ")[1]);return t>=M[0]&&t<=M[1]})).value()}),[E,M,H]),z=Object(a.useMemo)((function(){var e=H.length?Object(p.j)(Object(y.chain)(H).map("stopArr").flatten().value(),(function(e){return e.gap})):[0,0];return Object(S.b)().domain(e).range([5,5])}),[H]),U=Object(a.useState)({style:{display:"none"},content:{}}),Q=Object(u.a)(U,2),X=Q[0];Q[1];return Object(G.jsxs)("div",{className:"second-graph",children:[Object(G.jsx)("div",{children:Object(G.jsx)("img",{src:"./data/bg.jpeg",className:"realMap",alt:"map"})}),Object(G.jsx)("div",{className:"tooltip",style:X.style,children:Object.entries(X.content).map((function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1];return Object(G.jsxs)("div",{className:"tooltip-item",children:[Object(G.jsxs)("span",{className:"tooltips-label",children:[n,": "]}),Object(G.jsx)("span",{className:"tooltips-value",children:a})]},n)}))}),Object(G.jsxs)("div",{className:"mapcontainer",children:[Object(G.jsx)("svg",{height:600,width:e,className:"mapSvg",children:Object(G.jsxs)("g",{className:"bg",children:[Object(G.jsx)("g",{className:"map",ref:t,children:i.map((function(e,t){return Object(G.jsx)("path",{className:"map-item",d:Object(q.a)(f)(e)},t)}))}),Object(G.jsx)("g",{ref:P}),Object(G.jsx)("g",{className:"track",ref:n,children:H.map((function(e){var t=e.id,n=e.data.filter((function(e){return E.includes(e.Timestamp.split(" ")[0])})).filter((function(e){var t=A(e.Timestamp.split(" ")[1]);return t>=M[0]&&t<=M[1]})).map((function(e){return f([e.long,e.lat])})),a={stroke:O(t),d:Object(p.o)()(n),className:"path"},r={strokeWidth:10,className:"arrow",d:Object(p.o)()(n),strokeDasharray:[10,99990]};return Object(G.jsxs)("g",{className:"trackItem trackItem-".concat(t),children:[Object(G.jsx)("path",Object(l.a)({},a)),Object(G.jsx)("path",Object(l.a)({},r))]},t)}))}),Object(G.jsx)("g",{className:"stop",children:K.map((function(e,t){var n=e.id,a=e.long,r=e.lat,c=e.gap,i=f([a,r]),s=Object(u.a)(i,2),o=s[0],m=s[1],d="".concat(a,"_").concat(r,"_").concat(n),j="stopitem_".concat(d),p={cx:o,cy:m,r:z(c),key:d,fill:O(n),stroke:O(n),className:"stopDot ".concat(j),data:JSON.stringify(e)};return Object(G.jsx)("circle",Object(l.a)({},p))}))}),Object(G.jsx)("g",{className:"store",children:F.map((function(e){var t=e.range,n=e.name,a=n.replace(/'|\.|\s/g,""),r=f(t[0]),c=Object(u.a)(r,2),i=c[0],s=c[1],o=f(t[1]),m=Object(u.a)(o,2),d=m[0],j={x:i,y:s,height:m[1]-s,width:d-i,fill:B(e.classify),stroke:B(e.classify),fillOpacity:.3,onMouseEnter:function(){Object(J.a)(".".concat(a,"_label")).attr("display",null)},onMouseOut:function(){Object(J.a)(".".concat(a,"_label")).attr("display","none")}},p={x:i+(d-i)/2,y:s-10,textAnchor:"middle",fontSize:"12px",fontWeight:"bolder",display:"none",className:"".concat(a,"_label"),TextEvent:"none"},b={key:"store-".concat(n)};return Object(G.jsxs)("g",Object(l.a)(Object(l.a)({},b),{},{children:[Object(G.jsx)("rect",Object(l.a)({},j)),Object(G.jsx)("text",Object(l.a)(Object(l.a)({},p),{},{children:n}))]}))}))})]})}),Object(G.jsx)("div",{className:"carlist",children:Object(G.jsxs)("table",{children:[Object(G.jsxs)("thead",{children:[Object(G.jsx)("th",{children:"Color"}),Object(G.jsx)("th",{children:"CarID"}),Object(G.jsx)("th",{children:"Staff"})]}),Object(G.jsx)("tbody",{children:R.map((function(e){return Object(G.jsxs)("tr",{className:"".concat(v.includes(e.id)?"active":0),onClick:function(){var t=Y(v,e.id);C(t)},children:[Object(G.jsx)("td",{children:Object(G.jsx)("div",{className:"color-legend",style:{background:O(e.id)}})}),Object(G.jsx)("td",{children:e.id}),Object(G.jsx)("td",{children:e.name})]},e.id)}))})]})})]}),Object(G.jsx)("div",{className:"second",children:Object(G.jsx)(Z,{GasData:j.filter((function(e){return v.includes(e.id)})),selectDay:E,selectDayCB:function(e){D(e)},brushCB:function(e){return w(e.map((function(e){return A(e)})))},playCB:function(){Object(V.a)(".trackItem").each((function(){var e=Object(J.a)(this).select(".path"),t=e.node().getTotalLength();e.attr("stroke-dasharray",t+" "+t).attr("stroke-dashoffset",t).transition().ease(p.h).attr("stroke-dashoffset",0).duration(1e4),Object(J.a)(this).select(".arrow").attr("stroke-width",10).attr("stroke-dasharray",(function(){return[10,t-10]})).attr("stroke-dashoffset",t).transition().ease(p.h).attr("stroke-dashoffset",10.5).duration(1e4)}))}})})]})}function Z(e){var t=e.GasData,n=e.selectDay,r=e.selectDayCB,c=e.brushCB,i=e.playCB,s=460,o=880,m=Object(a.useRef)(null),d=Object(a.useRef)(null),j=Object(a.useRef)(null),b=Object(S.e)().domain([new Date("2020-01-01 00:00:00"),new Date("2020-01-01 23:59:59")]).range([0,o]),f=Object(p.b)().scale(b),O=Object(p.a)().scale(b);Object(a.useEffect)((function(){Object(J.a)(m.current).call(f),Object(J.a)(d.current).call(O),Object(J.a)(j.current).call(Object(p.d)().extent([[0,0],[o,s]]).on("end",(function(){var e=_.c.selection;if(e){var t=e.map((function(e){return b.invert(e)})).map((function(e){return g()(e).format("HH:mm:ss")}));c(t),console.log(t)}else c(["00:00:00","23:59:59"])})))}),[]);var h=Object(S.d)().domain(x).range([s/x.length,s]).align(1),v=Object(a.useMemo)((function(){return Object(y.chain)(t).cloneDeep().forEach((function(e){var t=e.data,n=e.stopArr;e.day=Object(y.chain)(x).reduce((function(e,a){return e[a]={track:t.filter((function(e){return e.Timestamp.split(" ")[0]===a})),stopDot:n.filter((function(e){return e.st.split(" ")[0]===a}))},e}),{}).value()})).value()}),[t]),C=h.step(),T=Object(a.useMemo)((function(){return Object(S.d)().domain(t.map((function(e){return e.id}))).range([0,C]).align(0)}),[t]);return Object(G.jsxs)("div",{className:"explain",children:[Object(G.jsxs)("div",{className:"toolbox",children:[Object(G.jsx)("button",{onClick:function(){i(),Object(J.a)(".scaleplate").attr("x1",0).attr("x2",0).transition().ease(p.h).attr("x1",o).attr("x2",o).duration(1e4),Object(J.a)(".scaleplate").transition().attr("x1",0).attr("x2",0).delay(1e4)},children:"play"}),Object(G.jsx)("input",{type:"checkbox",id:"checkall",onChange:function(e){var t=e.target.checked;r(t?x:[])}}),Object(G.jsx)("label",{htmlFor:"checkall",children:"\u5168\u9009"})]}),Object(G.jsx)("svg",{width:1e3,height:500,className:"timeScale",children:Object(G.jsxs)("g",{className:"bg",transform:"translate(".concat(20,", ").concat(20,")"),children:[Object(G.jsx)("g",{ref:m}),Object(G.jsx)("g",{ref:d,transform:"translate(0, ".concat(s,")")}),Object(G.jsx)("line",{className:"scaleplate",x1:0,y1:0,x2:0,y2:s}),Object(G.jsx)("g",{className:"brush",ref:j}),x.map((function(e){var t=n.includes(e)?"":"disabled";return Object(G.jsxs)("g",{transform:"translate(".concat(0,", ",h(e),")"),className:"dayItem ".concat(t),children:[Object(G.jsx)("line",{x1:0,y1:0,x2:o,y2:0}),Object(G.jsx)("text",{onClick:function(){Y(n,e);r(e)},transform:"translate(".concat(890,", ").concat(-C/2,")"),children:e})]},e)})),v.map((function(e,t){var n=e.day,a=e.id;return Object.entries(n).map((function(e){var n=Object(u.a)(e,2),r=n[0],c=n[1].stopDot,i=Object(p.p)();c.forEach((function(e,t){var n=b(new Date("2020-01-01 ".concat(e.st.split(" ")[1]))),a=b(new Date("2020-01-01 ".concat(e.et.split(" ")[1])));0===t&&i.moveTo(n,0),i.lineTo(n,0),i.lineTo(n,-10),e.et.split(" ")[0]===r&&(i.lineTo(a,-10),i.lineTo(a,-0))})),console.log(T(a));var s=C/(v.length+1)*(t+1);return Object(G.jsx)("g",{transform:"translate(".concat(0,", ",h(r)-C+s,")"),children:c.map((function(e){var t=R([e.long,e.lat]),n=b(new Date("2020-01-01 ".concat(e.st.split(" ")[1]))),c=b(new Date("2020-01-01 ".concat(e.et.split(" ")[1])));c<n&&(c=b(new Date("2020-01-01 23:59:59")));var i=t?N[t]:"location",s={x1:0,y1:0,x2:c-n,y2:0,strokeWidth:2,fill:B(i),stroke:B(i),className:"stopItem",fillOpacity:.2,rx:5,ry:5},o={fontSize:6,x:(c-n)/2,y:-6,textAnchor:"middle",className:"stopItemLabel"};return Object(G.jsxs)("g",{transform:"translate(".concat(n,", ",0,")"),children:[Object(G.jsx)("text",Object(l.a)(Object(l.a)({},o),{},{children:t?t.split(" ").map((function(e){return e[0]})).join("-"):""})),Object(G.jsx)("line",Object(l.a)(Object(l.a)({},s),{},{children:Object(G.jsx)("title",{children:"\u65f6\u95f4: ".concat(e.st.split(" ")[1],"--").concat(e.et.split(" ")[1],"\n\u5730\u70b9: ").concat(t,"\n\u6c7d\u8f66: ").concat(a,"\n\u6d88\u8d39: ...")})}))]},"".concat(r,"-").concat(a,"-").concat(n))}))},"".concat(r,"-").concat(a))}))}))]})})]})}function Q(e){var t=e.children;return Object(G.jsx)("div",{children:t})}var X=function(){return Object(G.jsx)("div",{className:"App",children:Object(G.jsxs)(s.a,{children:[Object(G.jsxs)("div",{className:"nav",children:[Object(G.jsx)(s.b,{to:"/first",children:"first Q"}),Object(G.jsx)(s.b,{to:"/map",children:"map"}),Object(G.jsx)(s.b,{to:"/cal",children:"cal"})]}),Object(G.jsx)(Q,{children:Object(G.jsxs)(o.d,{children:[Object(G.jsx)(o.b,{path:"/first",children:Object(G.jsx)(P,{})}),Object(G.jsx)(o.b,{path:"/map",children:Object(G.jsx)(U,{})}),Object(G.jsx)(o.b,{path:"/cal",children:Object(G.jsx)(z,{})}),Object(G.jsx)(o.a,{from:"/",to:"/first"})]})})]})})},$=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,197)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))};i.a.render(Object(G.jsx)(r.a.StrictMode,{children:Object(G.jsx)(X,{})}),document.getElementById("root")),$()}},[[191,1,2]]]);
//# sourceMappingURL=main.b93bdc39.chunk.js.map