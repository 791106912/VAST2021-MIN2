(this["webpackJsonpvast-2020"]=this["webpackJsonpvast-2020"]||[]).push([[0],{125:function(e,t,n){},126:function(e,t,n){},127:function(e,t,n){},129:function(e,t,n){},130:function(e,t,n){},135:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n.n(a),r=n(98),i=n.n(r),s=(n(125),n(50)),u=n(8),o=(n(126),n(10)),l=n(4),d=n(141),j=n(19),b=(n(94),n(5)),f=n(6),O=n.n(f),m=(n(127),n(1));var h=n(9),p=n(101),x=n(136),g=n(7),v=n(137),y=n(143),N=n(144),A=[1388937600,1389024e3,1389110400,1389196800,1389283200,1389369600,1389456e3,1389542400,1389628800,1389715200,1389801600,1389888e3,1389974400,1390060800],M=[{type:"restaurant",data:["Brew've Been Served","Hallowed Grounds","Coffee Cameleon","Coffee Shack","Bean There Done That","Jack's Magical Beans","Brewed Awakenings","Katerinas Caf","Gelatogalore","Ouzeri Elian","Kalami Kafenion","Hippokampos","Abila Zacharo","Guy's Gyros"]},{type:"parter",data:["Abila Airport","Nationwide Refinery","Maximum Iron and Steel","Carlyle Chemical Inc.","Abila Scrapyard","Octavio's Office Supplies","Chostus Hotel","Frank's Fuel","Kronos Pipe and Irrigation","Stewart and Sons Fabrication"]},{type:"shop",data:["Albert's Fine Clothing","Kronos Mart","Daily Dealz","Shoppers' Delight","Ahaggo Museum"]},{type:"entertainment",data:["Desafio Golf Course","Roberts and Sons"]},{type:"other",data:["U-Pump","General Grocer","Frydos Autosupply n' More"]}],k=[{data:[-2,6],name:"Sleeping"},{data:[6,9],name:"On the way to work"},{data:[9,12],name:"Working"},{data:[12,14],name:"Lunch Break"},{data:[14,18],name:"Working"},{data:[18,22],name:"After work"}];n(129);function S(e,t){return parseFloat((Number(e)+Number(t)).toFixed(10))}function R(){var e=800,t=800,n=[[0,120],[120,240],[370,371],[270,300],[320,350]],c=Object(g.b)().domain([0,24]).range([0,360]),r=Object(g.b)().domain(Object(l.d)(A)).range([n[1][0],n[1][1]]),i="2020-01-01",s=Object(a.useState)(!0),u=Object(o.a)(s,2),j=u[0],f=u[1],R=Object(a.useState)("mulitiple"),C=Object(o.a)(R,2),I=C[0],P=C[1];function F(e,t){var n=Object(p.a)(e);return"single"!==I?n.includes(t)?n.filter((function(e){return e!==t})):(n.push(t),n):n.includes(t)?[]:[t]}var B=Object(g.b)().domain(["".concat(i," 00:00:00"),"".concat(i," 23:59:59")].map((function(e){return O()(e).unix()}))).range([0,2*Math.PI]),T=Object(v.a)().innerRadius((function(e){return r(e.day)})).outerRadius((function(e){return r(e.day)+(n[1][1]-n[1][0])/A.length})).startAngle((function(e){return B(e.time)})).endAngle((function(e){return B(e.time+500)})),D=Object(a.useState)([]),q=Object(o.a)(D,2),G=q[0],E=q[1],K=Object(a.useState)([]),J=Object(o.a)(K,2),Y=J[0],z=J[1],H=Object(a.useState)([]),L=Object(o.a)(H,2),W=L[0],_=L[1],Q=Object(a.useState)([]),U=Object(o.a)(Q,2),Z=U[0],V=U[1],X=Object(a.useMemo)((function(){return G.filter((function(e){return!Y.length||Y.includes(e.location)})).filter((function(e){return!Z.length||Z.includes(e.last4ccnum)}))}),[Y,G,Z]),$=Object(a.useState)([]),ee=Object(o.a)($,2),te=ee[0],ne=ee[1],ae=Object(a.useMemo)((function(){return Object(b.chain)(X).map("last4ccnum").uniq().value()}),[X]),ce=Object(a.useMemo)((function(){var e=Object(l.d)(X,(function(e){return Number(e.price)}));return Object(g.b)().domain(e).range([.2,1])}),[X]);Object(a.useEffect)((function(){var e=new Promise((function(e){Object(d.a)("./data/cc_data.csv").then((function(t){console.log(t);var n=t.map((function(e){var t=e.timestamp.split(" "),n=Object(o.a)(t,2),a=n[0],c=n[1],r=O()(a).unix(),s=O()("".concat(i," ").concat(c,":00")).unix(),u=M.find((function(t){return t.data.includes(e.location)})).type;return Object(h.a)(Object(h.a)({},e),{},{day:r,dayStr:a,time:s,locationType:u,hour:c.split(":")[0]})})),a=Object(b.chain)(t).map("last4ccnum").uniq().value();ne(a),E(n),e(t)}))})),t=new Promise((function(e){Object(d.a)("./data/loyalty_data.csv").then((function(t){e(t)}))}));Promise.all([e,t]).then((function(e){}))}),[]);var re=Object(a.useMemo)((function(){return X.reduce((function(e,t){var n=e[t.location]||0,a=parseFloat((n+Number(t.price)).toFixed(10));return e[t.location]=a,e}),{})}),[X]),ie=Object(a.useMemo)((function(){var e=Object(l.d)(Object.values(re));return Object(g.b)().domain(e).range([.2,1])}),[re]),se=Object(b.chain)(M).map("data").flatten().value(),ue=Object(g.b)().domain([0,se.length]).range([0,2*Math.PI]),oe=Object(v.a)().innerRadius((function(e){return n[4][0]})).outerRadius((function(e){return n[4][1]})).startAngle((function(e){var t=e.type,n=M.findIndex((function(e){return e.type===t})),a=Object(b.chain)(M).slice(0,n).map("data").flatten().value().length;return ue(a)})).endAngle((function(e){var t=e.type,n=M.findIndex((function(e){return e.type===t})),a=Object(b.chain)(M).slice(0,n+1).map("data").flatten().value().length;return ue(a)})).padAngle(.01).cornerRadius(4),le=Object(v.a)().innerRadius((function(e){return n[3][0]})).outerRadius((function(e){return n[3][1]})).startAngle((function(e){var t=se.indexOf(e);return ue(t)})).endAngle((function(e){var t=se.indexOf(e);return ue(t+1)})).padAngle(.01).cornerRadius(4),de=Object(v.a)().innerRadius((function(e){return n[2][0]})).outerRadius((function(e){return n[2][1]})).startAngle((function(e){return e[0]<0?B(O()("2019-12-31 ".concat(22,":00:00")).unix()):B(O()("".concat(i," ").concat(e[0],":00:00")).unix())})).endAngle((function(e){return B(O()("".concat(i," ").concat(e[1],":00:00")).unix())})).padAngle(.1).cornerRadius(4),je=function(e){if(!e.innerRadius||!e.outerRadius)return"";var t=[e.startAngle,e.endAngle].map((function(e){return e-Math.PI/2})),n=Math.max(0,(e.outerRadius+e.innerRadius)/2),a=(t[1]+t[0])/2,c=a>0&&a<Math.PI;c&&t.reverse();var r=Object(x.a)();return r.arc(0,0,n,t[0],t[1],c),r.toString()},be=Object(g.c)(M.map((function(e){return e.type})).sort(l.a),g.e),fe=Object(a.useMemo)((function(){return te.reduce((function(e,t){var n=Object(b.chain)(X).filter((function(e){return e.last4ccnum===t})).reduce((function(e,t){var n=t.dayStr;return e[n]||(e[n]=[]),e[n].push(T.centroid(t)),e}),{}).values().value();return e[t]=n,e}),{})}),[te,X,T]),Oe=Object(a.useMemo)((function(){return Object(b.chain)(X).map((function(e){return e.dayStr.replace("/2014","")})).uniq().value()}),[X]),me=Object(y.a)().x((function(e){return e[0]})).y((function(e){return e[1]})).curve(N.a.alpha(.5)),he=["01/11","01/12","01/18","01/19"];return Object(m.jsxs)("div",{className:"graph",children:[Object(m.jsx)("svg",{height:e,width:t,className:"main",children:Object(m.jsxs)("g",{transform:"translate(".concat(10,", ").concat(10,")"),children:[Object(m.jsx)("g",{className:"timebg",children:A.map((function(e,t){var n=O()(1e3*e).format("MM/DD"),a=Oe.includes(n)?1:0;return Object(m.jsxs)("g",{children:[Object(m.jsxs)("text",{opacity:a,transform:"translate(".concat(400,", ").concat(400-r(e),")"),children:[n," ",he.includes(n)?"weekend":""]}),Object(m.jsx)("circle",{cx:400,cy:400,r:r(e)})]},e)}))}),Object(m.jsx)("g",{className:"timeTick",children:[6,9,12,14,18,22].map((function(e,t){var a={x1:400,y1:400-n[2][0],x2:400,y2:400};return Object(m.jsxs)("g",{className:"timeSplit",transform:"rotate(".concat(c(e),")"),children:[Object(m.jsx)("line",Object(h.a)({},a)),Object(m.jsx)("text",{x:a.x1,y:a.y1,dy:0,children:"".concat(e,":00")})]},e)}))}),Object(m.jsx)("g",{className:"time-classify",transform:"translate(".concat(400,", ").concat(400,")"),children:k.map((function(e,t){var a={d:de(e.data)},c={fill:"none",id:"time-".concat(t),d:je({innerRadius:n[2][1]+10,outerRadius:n[2][1]+10,startAngle:e.data[0]<0?B(O()("2019-12-31 ".concat(22,":00:00")).unix()):B(O()("".concat(i," ").concat(e.data[0],":00:00")).unix()),endAngle:B(O()("".concat(i," ").concat(e.data[1],":00:00")).unix())})},r={href:"#time-".concat(t),startOffset:"50%",dominantBaseline:"middle"};return Object(m.jsxs)("g",{children:[Object(m.jsx)("path",Object(h.a)(Object(h.a)({},a),{},{className:"time-button"})),Object(m.jsxs)("g",{className:"time-label",children:[Object(m.jsx)("path",Object(h.a)({},c)),Object(m.jsx)("text",{children:Object(m.jsx)("textPath",Object(h.a)(Object(h.a)({},r),{},{children:e.name}))})]})]},e.data[0])}))}),Object(m.jsx)("g",{className:"consume-g",transform:"translate(".concat(400,", ").concat(400,")"),children:X.map((function(e,t){var n=M.find((function(t){return t.data.includes(e.location)})).type,a={className:"consume-item",d:T(e),fill:be(n),fillOpacity:ce(e.price)};return Object(m.jsx)("path",Object(h.a)({},a),JSON.stringify(e))}))}),Object(m.jsx)("g",{className:"first-classify",transform:"translate(".concat(400,", ").concat(400,")"),children:M.map((function(e,t){var a=e.type,c=e.data,r={d:oe(e),fill:be(a),stroke:be(a)},i=M.findIndex((function(e){return e.type===a})),s=Object(b.chain)(M).slice(0,i).map("data").flatten().value().length,u={fill:"none",id:"text-".concat(a),d:je({innerRadius:n[4][0],outerRadius:n[4][1],startAngle:ue(s),endAngle:ue(s+c.length)})},o={href:"#text-".concat(a),startOffset:"50%",dominantBaseline:"middle"},l=W.includes(a)?"active":"";W.length>0&&!W.includes(a)&&(l="disabled");var d=Object(b.intersection)(X.map((function(e){return e.location})),c).length?1:.1;return Object(m.jsxs)("g",{className:l,opacity:d,onClick:function(){var e=F(W,a);_(e);var t=Object(b.chain)(M).filter((function(t){return e.includes(t.type)})).map("data").flatten().value();z(t)},children:[Object(m.jsx)("path",Object(h.a)(Object(h.a)({},r),{},{className:"classify-button"})),Object(m.jsxs)("g",{className:"classify-label",children:[Object(m.jsx)("path",Object(h.a)({},u)),Object(m.jsx)("text",{children:Object(m.jsx)("textPath",Object(h.a)(Object(h.a)({},o),{},{children:e.type}))})]})]},e.type)}))}),Object(m.jsx)("g",{className:"detail-store",transform:"translate(".concat(400,", ").concat(400,")"),children:M.map((function(e,t){var c=e.type,r=e.data,i=Object(b.chain)(M).slice(0,t).map("data").flatten().value().length;return Object(m.jsx)("g",{children:r.map((function(e,t){var r={d:le(e),fill:be(c),stroke:be(c),fillOpacity:ie(re[e])},s=ue(i+t),u=ue(i+t+1),o={fill:"none",id:"text-".concat(e),d:je({innerRadius:n[3][1],outerRadius:n[3][1],startAngle:s,endAngle:u})},l={href:"#text-".concat(e),startOffset:"50%",dominantBaseline:"middle",textAnchor:"middle"},d=Y.includes(e)?"active":"";Y.length>0&&!Y.includes(e)&&(d="disabled");var j=X.map((function(e){return e.location})).includes(e)?1:.1,b=(s+u)/2,f=b>Math.PI/2&&b<Math.PI/2*3,O=f?e.split(" ").reverse():e.split(" "),p=f?-10:10;return Object(m.jsxs)("g",{opacity:j,className:d,onClick:function(){var t=F(Y,e),n=M.filter((function(e){return e.data.filter((function(e){return t.includes(e)})).length})).map((function(e){return e.type}));z(t),_(n)},children:[Object(m.jsx)("path",Object(h.a)(Object(h.a)({},r),{},{className:"store-button"})),Object(m.jsxs)("g",{className:"store-label",children:[Object(m.jsx)("path",Object(h.a)({},o)),Object(m.jsx)("text",{children:O.map((function(e,t){return Object(a.createElement)("textPath",Object(h.a)(Object(h.a)({},l),{},{key:e}),Object(m.jsx)("tspan",{dy:p,children:e}))}))})]})]},e)}))},"a-".concat(c))}))}),Object(m.jsxs)("g",{className:"customer",transform:"translate(".concat(400,", ").concat(400,")"),children:[Object(m.jsx)("circle",{className:"bg",cx:0,cy:0,r:n[1][0]}),Object(m.jsx)("g",{children:te.map((function(e,t){var a=t*(Math.PI*(3-Math.sqrt(5))),c=Math.sqrt(t)/Math.sqrt(te.length),r=(n[1][0]-10)*(c*Math.cos(a)),i=(n[1][0]-10)*(c*Math.sin(a)),s=ae.includes(e)?1:.1;Z.includes(e);Z.length>0&&Z.includes(e);var u=G.filter((function(t){return t.last4ccnum===e})),o=Object(b.chain)(u).reduce((function(e,t){return e[t.locationType]={value:e[t.locationType]?S(e[t.locationType].value,t.price):Number(t.price),type:t.locationType},e}),{}).values().value(),l=u.reduce((function(e,t){return S(e,t.price)}),0),d=Object(g.b)().domain([0,l]).range([0,2*Math.PI]),j=Object(v.a)().innerRadius(0).outerRadius(5).startAngle((function(e){var t=o.findIndex((function(t){return t.type===e.type})),n=Object(b.chain)(o).slice(0,t).map("value").reduce((function(e,t){return S(e,t)}),0).value();return d(n)})).endAngle((function(e){var t=o.findIndex((function(t){return t.type===e.type})),n=Object(b.chain)(o).slice(0,t).map("value").reduce((function(e,t){return S(e,t)}),0).value()+e.value;return d(n)}));return Object(m.jsxs)("g",{transform:"translate(".concat(r,", ").concat(i,")"),opacity:s,onClick:function(){var t=F(Z,e);V(t)},children:[o.map((function(e){var t={d:j(e),key:"small-".concat(e.type),fill:be(e.type),stroke:be(e.type),fillOpacity:.3};return Object(m.jsx)("path",Object(h.a)({},t))})),Object(m.jsx)("text",{dy:-8,children:e})]})}))})]}),Object(m.jsx)("g",{className:"customerTrack",transform:"translate(".concat(400,", ").concat(400,")"),children:Object.entries(fe).map((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1],c=Z.includes(n)?1:0;return c&&(c=j?1:0),Object(m.jsx)("g",{opacity:c,children:a.map((function(e){return Object(m.jsx)("path",{d:me(e)},e.toString())}))},n)}))})]})}),Object(m.jsxs)("div",{className:"left",children:[Object(m.jsxs)("div",{className:"condition",children:[Object(m.jsxs)("div",{className:"item",children:["select mode\uff1a",["single","mulitiple"].map((function(e){return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("label",{htmlFor:e,children:e}),Object(m.jsx)("input",{type:"radio",name:"select-mode",checked:I===e,onChange:function(){I!==e&&P(e)},value:e,id:e})]})}))]}),Object(m.jsxs)("div",{className:"item",children:["show customer track\uff1a",Object(m.jsx)("input",{type:"checkbox",name:"track-mode",checked:j,onChange:function(){f(!j)}})]}),Object(m.jsx)("div",{className:"item",children:Object(m.jsx)("button",{onClick:function(){z([]),_([]),V([])},children:"Refresh"})})]}),Object(m.jsx)(w,{data:X,colorScale:be})]})]})}function w(e){var t=e.data,n=void 0===t?[]:t,c=e.colorScale,r=460,i=Object(a.useRef)(null),s=Object(a.useRef)(null);return Object(a.useEffect)((function(){var e=Object(b.chain)(n).map("location").uniq().value(),t=Object(b.chain)(n).map("last4ccnum").uniq().value(),a=(Object(b.chain)(n).map("hour").uniq().value(),{last4ccnum:Object(g.d)().domain(t).range([0,r]),dayStr:Object(g.d)().domain(A.map((function(e){return O()(1e3*e).format("MM/DD/YYYY")}))).range([0,r]),hour:Object(g.b)().domain([0,24]).range([0,r]),location:Object(g.d)().domain(e).range([0,r]),price:Object(g.b)().domain([0,Object(l.d)(n,(function(e){return Number(e.price)}))[1]].reverse()).range([0,r])}),u=Object(g.d)().domain(Object.keys(a)).range([0,500]);Object(g.f)(i.current).selectAll("g.axisx").remove(),Object(g.f)(i.current).selectAll("g.axisx").data(Object.keys(a)).enter().append("g").classed("axisx",!0).attr("transform",(function(e){return"translate(".concat(u(e),", ",0,")")})).each((function(e){var t=Object(g.a)().scale(a[e]);Object(g.f)(this).call(t)}));var o=Object(y.a)();Object(g.f)(s.current).selectAll("path").remove(),Object(g.f)(s.current).selectAll("path").data(n).enter().append("path").attr("d",(function(e){return o(Object.keys(a).map((function(t){return[u(t),a[t](e[t])]})))})).attr("stroke",(function(e){var t=e.location,n=M.find((function(e){return e.data.includes(t)})).type;return c(n)}))}),[n]),Object(m.jsx)("svg",{height:500,width:600,className:"parallel",children:Object(m.jsxs)("g",{transform:"translate(".concat(80,", ").concat(20,")"),children:[Object(m.jsx)("g",{ref:s,className:"path"}),Object(m.jsx)("g",{ref:i})]})})}var C=n(138),I=n(139),P=n(140);n(130);function F(){var e=Object(a.useRef)(null),t=(Object(a.useRef)(null),Object(a.useState)([])),n=Object(o.a)(t,2),c=n[0],r=n[1],i=Object(a.useState)([]),s=Object(o.a)(i,2),u=s[0],l=s[1],f=Object(a.useMemo)((function(){return Object(I.a)()}),[]);Object(a.useMemo)((function(){return Object(j.b)().domain(u.map((function(e){return e.id}))).range(g.e)}),[u]);return Object(a.useEffect)((function(){Object(C.a)("./data/map.json").then((function(e){f.fitSize([1100,860],e),r(e.features)})),Object(d.a)("./data/gps.csv").then((function(e){var t=Object(b.chain)(e).reduce((function(e,t){var n=t.id,a=e[n]?e[n].data:[];return a.push(t),e[n]={id:n,data:a},e}),{}).values().value();l(t)}))}),[]),Object(m.jsxs)("div",{className:"second-graph",children:[Object(m.jsx)("img",{src:"./data/bg.jpeg",className:"realMap",alt:"map"}),Object(m.jsx)("svg",{height:800,width:1e3,children:Object(m.jsx)("g",{className:"bg",children:Object(m.jsx)("g",{className:"map",ref:e,children:c.map((function(e,t){return Object(m.jsx)("path",{className:"map-item",d:Object(P.a)(f)(e)},t)}))})})})]})}function B(e){var t=e.children;return Object(m.jsx)("div",{children:t})}var T=function(){return Object(m.jsx)("div",{className:"App",children:Object(m.jsxs)(s.a,{children:[Object(m.jsxs)("div",{className:"nav",children:[Object(m.jsx)(s.b,{to:"/first",children:"first Q"}),Object(m.jsx)(s.b,{to:"/map",children:"map"})]}),Object(m.jsx)(B,{children:Object(m.jsxs)(u.d,{children:[Object(m.jsx)(u.b,{path:"/first",children:Object(m.jsx)(R,{})}),Object(m.jsx)(u.b,{path:"/map",children:Object(m.jsx)(F,{})}),Object(m.jsx)(u.a,{from:"/",to:"/first"})]})})]})})},D=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,146)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),r(e),i(e)}))};i.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(T,{})}),document.getElementById("root")),D()}},[[135,1,2]]]);
//# sourceMappingURL=main.11a81372.chunk.js.map