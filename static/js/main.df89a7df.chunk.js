(this["webpackJsonpvast-2020"]=this["webpackJsonpvast-2020"]||[]).push([[0],{105:function(t,e,n){},106:function(t,e,n){},108:function(t,e,n){},110:function(t,e,n){},111:function(t,e,n){"use strict";n.r(e);var a=n(4),c=n.n(a),r=n(78),i=n.n(r),s=(n(105),n(106),n(9)),o=n(2),u=n(114),l=(n(13),n(75),n(3)),d=n(5),j=n.n(d),b=(n(108),n(0));var f=n(7),O=n(80),m=n(112),h=n(6),p=n(113),x=n(116),g=n(117),v=[1388937600,1389024e3,1389110400,1389196800,1389283200,1389369600,1389456e3,1389542400,1389628800,1389715200,1389801600,1389888e3,1389974400,1390060800],y=[{type:"restaurant",data:["Brew've Been Served","Hallowed Grounds","Coffee Cameleon","Coffee Shack","Bean There Done That","Jack's Magical Beans","Brewed Awakenings","Katerinas Caf","Gelatogalore","Ouzeri Elian","Kalami Kafenion","Hippokampos","Abila Zacharo","Guy's Gyros"]},{type:"parter",data:["Abila Airport","Nationwide Refinery","Maximum Iron and Steel","Carlyle Chemical Inc.","Abila Scrapyard","Octavio's Office Supplies","Chostus Hotel","Frank's Fuel","Kronos Pipe and Irrigation","Stewart and Sons Fabrication"]},{type:"shop",data:["Albert's Fine Clothing","Kronos Mart","Daily Dealz","Shoppers' Delight","Ahaggo Museum"]},{type:"entertainment",data:["Desafio Golf Course","Roberts and Sons"]},{type:"other",data:["U-Pump","General Grocer","Frydos Autosupply n' More"]}],N=[{data:[-2,6],name:"Sleeping"},{data:[6,9],name:"On the way to work"},{data:[9,12],name:"Working"},{data:[12,14],name:"Lunch Break"},{data:[14,18],name:"Working"},{data:[18,22],name:"After work"}];n(110);function A(){var t=800,e=800,n=[[0,100],[100,240],[370,371],[270,300],[320,350]],c=Object(h.b)().domain([0,24]).range([0,360]),r=Object(h.b)().domain(Object(o.d)(v)).range([n[1][0],n[1][1]]),i="2020-01-01",d=Object(a.useState)(!0),A=Object(s.a)(d,2),S=A[0],M=A[1],R=Object(a.useState)("mulitiple"),C=Object(s.a)(R,2),w=C[0],P=C[1];function F(t,e){var n=Object(O.a)(t);return"single"!==w?n.includes(e)?n.filter((function(t){return t!==e})):(n.push(e),n):n.includes(e)?[]:[e]}var I=Object(h.b)().domain(["".concat(i," 00:00:00"),"".concat(i," 23:59:59")].map((function(t){return j()(t).unix()}))).range([0,2*Math.PI]),B=Object(p.a)().innerRadius((function(t){return r(t.day)})).outerRadius((function(t){return r(t.day)+(n[1][1]-n[1][0])/v.length})).startAngle((function(t){return I(t.time)})).endAngle((function(t){return I(t.time+500)})),D=Object(a.useState)([]),q=Object(s.a)(D,2),G=q[0],T=q[1],K=Object(a.useState)([]),E=Object(s.a)(K,2),J=E[0],Y=E[1],H=Object(a.useState)([]),L=Object(s.a)(H,2),z=L[0],W=L[1],_=Object(a.useState)([]),U=Object(s.a)(_,2),Z=U[0],Q=U[1],V=Object(a.useMemo)((function(){return G.filter((function(t){return!J.length||J.includes(t.location)})).filter((function(t){return!Z.length||Z.includes(t.last4ccnum)}))}),[J,G,Z]),X=Object(a.useState)([]),$=Object(s.a)(X,2),tt=$[0],et=$[1],nt=Object(a.useMemo)((function(){var t=Object(o.d)(V,(function(t){return Number(t.price)}));return Object(h.b)().domain(t).range([.2,1])}),[V]);Object(a.useEffect)((function(){var t=new Promise((function(t){Object(u.a)("./data/cc_data.csv").then((function(e){console.log(e);var n=e.map((function(t){var e=t.timestamp.split(" "),n=Object(s.a)(e,2),a=n[0],c=n[1],r=j()(a).unix(),o=j()("".concat(i," ").concat(c,":00")).unix();return Object(f.a)(Object(f.a)({},t),{},{day:r,dayStr:a,time:o,hour:c.split(":")[0]})})),a=Object(l.chain)(e).map("last4ccnum").uniq().value();et(a),T(n),t(e)}))})),e=new Promise((function(t){Object(u.a)("./data/loyalty_data.csv").then((function(e){t(e)}))}));Promise.all([t,e]).then((function(t){}))}),[]);var at=Object(a.useMemo)((function(){return V.reduce((function(t,e){var n=t[e.location]||0,a=parseFloat((n+Number(e.price)).toFixed(10));return t[e.location]=a,t}),{})}),[V]),ct=Object(a.useMemo)((function(){var t=Object(o.d)(Object.values(at));return Object(h.b)().domain(t).range([.2,1])}),[at]),rt=Object(l.chain)(y).map("data").flatten().value(),it=Object(h.b)().domain([0,rt.length]).range([0,2*Math.PI]),st=Object(p.a)().innerRadius((function(t){return n[4][0]})).outerRadius((function(t){return n[4][1]})).startAngle((function(t){var e=t.type,n=y.findIndex((function(t){return t.type===e})),a=Object(l.chain)(y).slice(0,n).map("data").flatten().value().length;return it(a)})).endAngle((function(t){var e=t.type,n=y.findIndex((function(t){return t.type===e})),a=Object(l.chain)(y).slice(0,n+1).map("data").flatten().value().length;return it(a)})).padAngle(.01).cornerRadius(4),ot=Object(p.a)().innerRadius((function(t){return n[3][0]})).outerRadius((function(t){return n[3][1]})).startAngle((function(t){var e=rt.indexOf(t);return it(e)})).endAngle((function(t){var e=rt.indexOf(t);return it(e+1)})).padAngle(.01).cornerRadius(4),ut=Object(p.a)().innerRadius((function(t){return n[2][0]})).outerRadius((function(t){return n[2][1]})).startAngle((function(t){return t[0]<0?I(j()("2019-12-31 ".concat(22,":00:00")).unix()):I(j()("".concat(i," ").concat(t[0],":00:00")).unix())})).endAngle((function(t){return I(j()("".concat(i," ").concat(t[1],":00:00")).unix())})).padAngle(.1).cornerRadius(4),lt=function(t){if(!t.innerRadius||!t.outerRadius)return"";var e=[t.startAngle,t.endAngle].map((function(t){return t-Math.PI/2})),n=Math.max(0,(t.outerRadius+t.innerRadius)/2),a=(e[1]+e[0])/2,c=a>0&&a<Math.PI;c&&e.reverse();var r=Object(m.a)();return r.arc(0,0,n,e[0],e[1],c),r.toString()},dt=Object(h.c)(y.map((function(t){return t.type})).sort(o.a),h.e),jt=Object(a.useMemo)((function(){return tt.reduce((function(t,e){var n=Object(l.chain)(V).filter((function(t){return t.last4ccnum===e})).reduce((function(t,e){var n=e.dayStr;return t[n]||(t[n]=[]),t[n].push(B.centroid(e)),t}),{}).values().value();return t[e]=n,t}),{})}),[tt,V,B]),bt=Object(a.useMemo)((function(){return Object(l.chain)(V).map((function(t){return t.dayStr.replace("/2014","")})).uniq().value()}),[V]),ft=Object(x.a)().x((function(t){return t[0]})).y((function(t){return t[1]})).curve(g.a.alpha(.5)),Ot=["01/11","01/12","01/18","01/19"];return Object(b.jsxs)("div",{className:"graph",children:[Object(b.jsx)("svg",{height:t,width:e,className:"main",children:Object(b.jsxs)("g",{transform:"translate(".concat(10,", ").concat(10,")"),children:[Object(b.jsx)("g",{className:"timebg",children:v.map((function(t,e){var n=j()(1e3*t).format("MM/DD"),a=bt.includes(n)?1:0;return Object(b.jsxs)("g",{children:[Object(b.jsxs)("text",{opacity:a,transform:"translate(".concat(400,", ").concat(400-r(t),")"),children:[n," ",Ot.includes(n)?"weekend":""]}),Object(b.jsx)("circle",{cx:400,cy:400,r:r(t)})]},t)}))}),Object(b.jsx)("g",{className:"timeTick",children:[6,9,12,14,18,22].map((function(t,e){var a={x1:400,y1:400-n[2][0],x2:400,y2:400};return Object(b.jsxs)("g",{className:"timeSplit",transform:"rotate(".concat(c(t),")"),children:[Object(b.jsx)("line",Object(f.a)({},a)),Object(b.jsx)("text",{x:a.x1,y:a.y1,dy:0,children:"".concat(t,":00")})]},t)}))}),Object(b.jsx)("g",{className:"time-classify",transform:"translate(".concat(400,", ").concat(400,")"),children:N.map((function(t,e){var a={d:ut(t.data)},c={fill:"none",id:"time-".concat(e),d:lt({innerRadius:n[2][1]+10,outerRadius:n[2][1]+10,startAngle:t.data[0]<0?I(j()("2019-12-31 ".concat(22,":00:00")).unix()):I(j()("".concat(i," ").concat(t.data[0],":00:00")).unix()),endAngle:I(j()("".concat(i," ").concat(t.data[1],":00:00")).unix())})},r={href:"#time-".concat(e),startOffset:"50%",dominantBaseline:"middle"};return Object(b.jsxs)("g",{children:[Object(b.jsx)("path",Object(f.a)(Object(f.a)({},a),{},{className:"time-button"})),Object(b.jsxs)("g",{className:"time-label",children:[Object(b.jsx)("path",Object(f.a)({},c)),Object(b.jsx)("text",{children:Object(b.jsx)("textPath",Object(f.a)(Object(f.a)({},r),{},{children:t.name}))})]})]},t.data[0])}))}),Object(b.jsx)("g",{className:"consume-g",transform:"translate(".concat(400,", ").concat(400,")"),children:V.map((function(t,e){var n=y.find((function(e){return e.data.includes(t.location)})).type,a={className:"consume-item",d:B(t),fill:dt(n),fillOpacity:nt(t.price)};return Object(b.jsx)("path",Object(f.a)({},a),JSON.stringify(t))}))}),Object(b.jsx)("g",{className:"first-classify",transform:"translate(".concat(400,", ").concat(400,")"),children:y.map((function(t,e){var a=t.type,c=t.data,r={d:st(t),fill:dt(a),stroke:dt(a)},i=y.findIndex((function(t){return t.type===a})),s=Object(l.chain)(y).slice(0,i).map("data").flatten().value().length,o={fill:"none",id:"text-".concat(a),d:lt({innerRadius:n[4][0],outerRadius:n[4][1],startAngle:it(s),endAngle:it(s+c.length)})},u={href:"#text-".concat(a),startOffset:"50%",dominantBaseline:"middle"},d=z.includes(a)?"active":"";z.length>0&&!z.includes(a)&&(d="disabled");var j=Object(l.intersection)(V.map((function(t){return t.location})),c).length?1:.1;return Object(b.jsxs)("g",{className:d,opacity:j,onClick:function(){var t=F(z,a);W(t);var e=Object(l.chain)(y).filter((function(e){return t.includes(e.type)})).map("data").flatten().value();Y(e)},children:[Object(b.jsx)("path",Object(f.a)(Object(f.a)({},r),{},{className:"classify-button"})),Object(b.jsxs)("g",{className:"classify-label",children:[Object(b.jsx)("path",Object(f.a)({},o)),Object(b.jsx)("text",{children:Object(b.jsx)("textPath",Object(f.a)(Object(f.a)({},u),{},{children:t.type}))})]})]},t.type)}))}),Object(b.jsx)("g",{className:"detail-store",transform:"translate(".concat(400,", ").concat(400,")"),children:y.map((function(t,e){var a=t.type,c=t.data,r=Object(l.chain)(y).slice(0,e).map("data").flatten().value().length;return Object(b.jsx)("g",{children:c.map((function(t,e){var c={d:ot(t),fill:dt(a),stroke:dt(a),fillOpacity:ct(at[t])},i={fill:"none",id:"text-".concat(t),d:lt({innerRadius:n[3][0],outerRadius:n[3][1],startAngle:it(r+e),endAngle:it(r+e+1)})},s={href:"#text-".concat(t),startOffset:"50%",dominantBaseline:"middle"},o=J.includes(t)?"active":"";J.length>0&&!J.includes(t)&&(o="disabled");var u=V.map((function(t){return t.location})).includes(t)?1:.1;return Object(b.jsxs)("g",{opacity:u,className:o,onClick:function(){var e=F(J,t),n=y.filter((function(t){return t.data.filter((function(t){return e.includes(t)})).length})).map((function(t){return t.type}));Y(e),W(n)},children:[Object(b.jsx)("path",Object(f.a)(Object(f.a)({},c),{},{className:"store-button"})),Object(b.jsxs)("g",{className:"store-label",children:[Object(b.jsx)("path",Object(f.a)({},i)),Object(b.jsx)("text",{children:Object(b.jsx)("textPath",Object(f.a)(Object(f.a)({},s),{},{children:t.split(" ").map((function(t,e){return Object(b.jsx)("tspan",{y:10*e,children:t},t)}))}))})]})]},t)}))},"a-".concat(a))}))}),Object(b.jsxs)("g",{className:"customer",transform:"translate(".concat(400,", ").concat(400,")"),children:[Object(b.jsx)("circle",{className:"bg",cx:0,cy:0,r:n[1][0]}),Object(b.jsx)("g",{children:tt.map((function(t,e){var a=e*(Math.PI*(3-Math.sqrt(5))),c=Math.sqrt(e)/Math.sqrt(tt.length),r=(n[1][0]-10)*(c*Math.cos(a)),i=(n[1][0]-10)*(c*Math.sin(a)),s=V.map((function(t){return t.last4ccnum})).includes(t)?1:.1,o=Z.includes(t)?"active":"";return Z.length>0&&!Z.includes(t)&&(o="disabled"),Object(b.jsxs)("g",{transform:"translate(".concat(r,", ").concat(i,")"),opacity:s,onClick:function(){var e=F(Z,t);Q(e)},children:[Object(b.jsx)("circle",{r:5,className:"card ".concat(o)},t),Object(b.jsx)("text",{dy:-8,children:t})]})}))})]}),Object(b.jsx)("g",{className:"customerTrack",transform:"translate(".concat(400,", ").concat(400,")"),children:Object.entries(jt).map((function(t){var e=Object(s.a)(t,2),n=e[0],a=e[1],c=Z.includes(n)?1:0;return c&&(c=S?1:0),Object(b.jsx)("g",{opacity:c,children:a.map((function(t){return Object(b.jsx)("path",{d:ft(t)},t.toString())}))},n)}))})]})}),Object(b.jsxs)("div",{className:"left",children:[Object(b.jsxs)("div",{className:"condition",children:[Object(b.jsxs)("div",{className:"item",children:["select mode\uff1a",["single","mulitiple"].map((function(t){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("label",{htmlFor:t,children:t}),Object(b.jsx)("input",{type:"radio",name:"select-mode",checked:w===t,onChange:function(){w!==t&&P(t)},value:t,id:t})]})}))]}),Object(b.jsxs)("div",{className:"item",children:["show customer track\uff1a",Object(b.jsx)("input",{type:"checkbox",name:"track-mode",checked:S,onChange:function(){M(!S)}})]}),Object(b.jsx)("div",{className:"item",children:Object(b.jsx)("button",{onClick:function(){Y([]),W([]),Q([])},children:"Refresh"})})]}),Object(b.jsx)(k,{data:V,colorScale:dt})]})]})}function k(t){var e=t.data,n=void 0===e?[]:e,c=t.colorScale,r=460,i=Object(a.useRef)(null),s=Object(a.useRef)(null);return Object(a.useEffect)((function(){var t=Object(l.chain)(n).map("location").uniq().value(),e=Object(l.chain)(n).map("last4ccnum").uniq().value(),a=(Object(l.chain)(n).map("hour").uniq().value(),{last4ccnum:Object(h.d)().domain(e).range([0,r]),dayStr:Object(h.d)().domain(v.map((function(t){return j()(1e3*t).format("MM/DD/YYYY")}))).range([0,r]),hour:Object(h.b)().domain([0,24]).range([0,r]),location:Object(h.d)().domain(t).range([0,r]),price:Object(h.b)().domain([0,Object(o.d)(n,(function(t){return Number(t.price)}))[1]].reverse()).range([0,r])}),u=Object(h.d)().domain(Object.keys(a)).range([0,500]);Object(h.f)(i.current).selectAll("g.axisx").remove(),Object(h.f)(i.current).selectAll("g.axisx").data(Object.keys(a)).enter().append("g").classed("axisx",!0).attr("transform",(function(t){return"translate(".concat(u(t),", ",0,")")})).each((function(t){var e=Object(h.a)().scale(a[t]);Object(h.f)(this).call(e)}));var d=Object(x.a)();Object(h.f)(s.current).selectAll("path").remove(),Object(h.f)(s.current).selectAll("path").data(n).enter().append("path").attr("d",(function(t){return d(Object.keys(a).map((function(e){return[u(e),a[e](t[e])]})))})).attr("stroke",(function(t){var e=t.location,n=y.find((function(t){return t.data.includes(e)})).type;return c(n)}))}),[n]),Object(b.jsx)("svg",{height:500,width:600,className:"parallel",children:Object(b.jsxs)("g",{transform:"translate(".concat(80,", ").concat(20,")"),children:[Object(b.jsx)("g",{ref:s,className:"path"}),Object(b.jsx)("g",{ref:i})]})})}var S=function(){return Object(b.jsx)("div",{className:"App",children:Object(b.jsx)(A,{})})},M=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,119)).then((function(e){var n=e.getCLS,a=e.getFID,c=e.getFCP,r=e.getLCP,i=e.getTTFB;n(t),a(t),c(t),r(t),i(t)}))};i.a.render(Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsx)(S,{})}),document.getElementById("root")),M()}},[[111,1,2]]]);
//# sourceMappingURL=main.df89a7df.chunk.js.map